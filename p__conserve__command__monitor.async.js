(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{Kwd5:function(e,a,t){"use strict";t.r(a);var l,r=t("pVnL"),n=t.n(r),i=(t("IzEo"),t("bx4M")),o=(t("miYZ"),t("tsqr")),d=(t("P2fV"),t("NJEC")),s=(t("/zsF"),t("PArb")),c=(t("5Dmo"),t("3S7+")),m=(t("BoS7"),t("Sdc0")),u=t("lwsE"),p=t.n(u),h=t("W8MJ"),E=t.n(h),g=t("a1gu"),f=t.n(g),y=t("Nsbk"),b=t.n(y),v=t("7W2i"),V=t.n(v),k=(t("2qtc"),t("kLXV")),M=(t("14J3"),t("BMrR")),C=(t("giR+"),t("fyUT")),w=(t("7Kak"),t("9yH6")),S=(t("jCWc"),t("kPKH")),F=(t("5NDa"),t("5rEg")),D=(t("+L6B"),t("2/Rp")),q=(t("OaEy"),t("2fM7")),N=(t("y8nQ"),t("Vl3Y")),B=t("q1tI"),O=t.n(B),x=t("MuoO"),L=t("CkN6"),A=t("lTPH"),P=t("9zHi"),j=t.n(P),Q=t("ZP6J"),I=t.n(Q),U=t("ns75"),z=t.n(U),T=N.a.Item,J=q.a.Option,R=["通电","断电"],H=[[],[]],K=N.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleAdd,r=e.handleModalVisible,n=e.loading;return O.a.createElement(k.a,{destroyOnClose:!0,title:"添加点位",className:I.a.formModal,visible:a,width:700,onCancel:function(){return r()},footer:[O.a.createElement(D.a,{key:"back",onClick:function(){return r()}},"取消"),O.a.createElement(D.a,{key:"submit",type:"primary",loading:n,onClick:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})}},"确定")]},O.a.createElement("div",{className:I.a.formModalBody},O.a.createElement(M.a,{gutter:40},O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"点位名称"},t.getFieldDecorator("pointName",{rules:[{required:!0,message:"请输入点位名称！"}]})(O.a.createElement(F.a,{placeholder:"请输入"})))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"点位对象"},t.getFieldDecorator("ponitObj",{rules:[{required:!0,message:"请选择点位对象！"}]})(O.a.createElement(q.a,{style:{width:"100%"},placeholder:"请选择点位对象"},H[1].map(function(e,a){return O.a.createElement(J,{value:H[0][a],key:a},e)}))))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"点位地址"},t.getFieldDecorator("addr",{rules:[{required:!0,message:"请输入点位地址！"}]})(O.a.createElement(F.a,{placeholder:"请输入"})))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"继电器账号"},t.getFieldDecorator("relayAccount",{rules:[{required:!0,message:"请输入继电器账号！"}]})(O.a.createElement(F.a,{placeholder:"请输入"})))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"继电器密码"},t.getFieldDecorator("relayPwd",{rules:[{required:!0,message:"请输入继电器密码！"}]})(O.a.createElement(F.a,{placeholder:"请输入"})))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"继电器状态"},t.getFieldDecorator("relayStatus",{rules:[{required:!0,message:"请选择继电器状态！"}]})(O.a.createElement(w.a.Group,null,R.map(function(e,a){return O.a.createElement(w.a,{value:a+1,key:a},e)}))))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"设备序列号"},t.getFieldDecorator("serial",{rules:[{required:!0,message:"请输入设备序列号！"}]})(O.a.createElement(F.a,{placeholder:"请输入"})))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"通道号"},t.getFieldDecorator("channel",{rules:[{required:!0,message:"请输入通道号！"}]})(O.a.createElement(C.a,{style:{width:"100%"},placeholder:"请输入"})))))))}),_=N.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleUpdate,r=e.handleModalVisible,n=e.detail,i=e.loading;return O.a.createElement(k.a,{destroyOnClose:!0,title:"编辑点位",className:I.a.formModal,visible:a,width:700,onCancel:function(){return r()},footer:[O.a.createElement(D.a,{key:"back",onClick:function(){return r()}},"取消"),O.a.createElement(D.a,{key:"submit",type:"primary",loading:i,onClick:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})}},"确定")]},O.a.createElement("div",{className:I.a.formModalBody},O.a.createElement(M.a,{gutter:40},O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"点位名称"},t.getFieldDecorator("pointName",{initialValue:n.pointName,rules:[{required:!0,message:"请输入点位名称！"}]})(O.a.createElement(F.a,{placeholder:"请输入"})))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"点位对象"},t.getFieldDecorator("ponitObj",{initialValue:n.ponitObj,rules:[{required:!0,message:"请选择点位对象！"}]})(O.a.createElement(q.a,{disabled:!0,style:{width:"100%"},placeholder:"请选择点位对象"},H[1].map(function(e,a){return O.a.createElement(J,{value:H[0][a],key:a},e)}))))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"点位地址"},t.getFieldDecorator("addr",{initialValue:n.addr,rules:[{required:!0,message:"请输入点位地址！"}]})(O.a.createElement(F.a,{placeholder:"请输入"})))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"继电器账号"},t.getFieldDecorator("relayAccount",{initialValue:n.relayAccount,rules:[{required:!0,message:"请输入继电器账号！"}]})(O.a.createElement(F.a,{disabled:!0,placeholder:"请输入"})))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"继电器密码"},t.getFieldDecorator("relayPwd",{initialValue:n.relayPwd,rules:[{required:!0,message:"请输入继电器密码！"}]})(O.a.createElement(F.a,{disabled:!0,placeholder:"请输入"})))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"继电器状态"},t.getFieldDecorator("relayStatus",{initialValue:n.relayStatus,rules:[{required:!0,message:"请选择继电器状态！"}]})(O.a.createElement(w.a.Group,{disabled:!0},R.map(function(e,a){return O.a.createElement(w.a,{value:a+1,key:a},e)}))))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"设备序列号"},t.getFieldDecorator("serial",{initialValue:n.serial,rules:[{required:!0,message:"请输入设备序列号！"}]})(O.a.createElement(F.a,{disabled:!0,placeholder:"请输入"})))),O.a.createElement(S.a,{md:12,sm:24},O.a.createElement(T,{label:"通道号"},t.getFieldDecorator("channel",{initialValue:n.channel,rules:[{required:!0,message:"请输入通道号！"}]})(O.a.createElement(C.a,{disabled:!0,style:{width:"100%"},placeholder:"请输入"})))))))}),W=Object(x.connect)(function(e){return{ConserveMonitor:e.ConserveMonitor,loading:e.loading.models.ConserveMonitor}})(l=N.a.create()(l=function(e){function a(e){var t;return p()(this,a),(t=f()(this,b()(a).call(this,e))).state={modalVisible:!1,updateModalVisible:!1,formValues:[],detail:{},defaultQuery:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"点位名称",dataIndex:"pointName"},{title:"点位地址",dataIndex:"addr"},{title:"继电器账号",dataIndex:"relayAccount"},{title:"继电器密码",dataIndex:"relayPwd"},{title:"继电器状态",dataIndex:"relayStatus",render:function(e){return R[e-1]}},{title:"继电器开关",width:110,render:function(e){return O.a.createElement(m.a,{checkedChildren:"开",unCheckedChildren:"关",checked:1===e.relayStatus,onClick:function(){return t.switchClick(e)}})}},{title:"操作",width:90,render:function(e,a){return O.a.createElement(B.Fragment,null,O.a.createElement(c.a,{placement:"left",title:"编辑"},O.a.createElement(D.a,{onClick:function(){return t.editData(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),O.a.createElement(s.a,{type:"vertical"}),O.a.createElement(d.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id_)},okText:"确定",cancelText:"取消"},O.a.createElement(c.a,{placement:"left",title:"删除"},O.a.createElement(D.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.getNewPlanObject=function(){var e=Object(A.o)(),a=[e[1],e[0]],t=a[0],l=a[1];return t.indexOf("路政")>-1&&t.splice(t.indexOf("路政"),1),l.indexOf(-1)>-1&&l.splice(l.indexOf(-1),1),[l,t]},t.getList=function(e){(0,t.props.dispatch)({type:"ConserveMonitor/fetch",payload:e})},t.editData=function(e){t.setState({detail:e},function(){return t.handleUpdateModalVisible(!0)})},t.switchClick=function(e){var a=t.props.dispatch,l=t.state,r=l.pageBean,n=l.formValues,i=l.defaultQuery;a({type:"ConserveMonitor/switchRelay",payload:{id_:e.id_,relayStatus:1===e.relayStatus?2:1},callback:function(){o.a.success("继电器"+(1===e.relayStatus?"关闭":"开启")+"成功"),t.getList({pageBean:r,querys:n.length?n:[i]})}})},t.dataDel=function(e){var a=t.props.dispatch,l=t.state,r=l.defaultQuery,n=l.pageBean;a({type:"ConserveMonitor/remove",payload:e,callback:function(){o.a.success("删除成功"),t.getList({pageBean:n,querys:[r]})}})},t.handleStandardTableChange=function(e){var a=t.state,l=a.formValues,r=a.defaultQuery,n={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:l.length?l:[r]};t.getList(n)},t.handleFormReset=function(){var e=t.props.form,a=t.state,l=a.pageBean,r=a.defaultQuery;e.resetFields(),t.setState({formValues:[]}),t.getList({pageBean:l,querys:[r]})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var l=t.state,r=l.pageBean,n=l.defaultQuery,i=[{property:"pointName",value:a.name,group:"main",operation:"LIKE",relation:"AND"},a.dx?{property:"ponitObj",value:a.dx,group:"main",operation:"EQUAL",relation:"AND"}:n].filter(function(e){return e.value});t.setState({formValues:i}),t.getList({pageBean:r,querys:i})}})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{}})},t.handleAdd=function(e){var a=t.props.dispatch,l=t.state,r=l.defaultQuery,n=l.pageBean,i=l.formValues;a({type:"ConserveMonitor/add",payload:e,callback:function(){o.a.success("添加成功"),t.handleModalVisible(),t.getList({pageBean:n,querys:[r].concat(i)})}})},t.handleUpdate=function(e){var a=t.props.dispatch,l=t.state,r=l.pageBean,n=l.detail,i=l.defaultQuery,d=l.formValues,s=JSON.parse(JSON.stringify(n));for(var c in e)s[c]=e[c];t.setState({detail:s}),a({type:"ConserveMonitor/update",payload:s,callback:function(){o.a.success("编辑成功"),t.handleUpdateModalVisible(),t.getList({pageBean:r,querys:[i].concat(d)})}})},H=t.getNewPlanObject(),t}return V()(a,e),E()(a,[{key:"componentDidMount",value:function(){var e={property:"ponitObj",value:H[0],group:"main",operation:"IN",relation:"AND"};this.getList({pageBean:this.state.pageBean,querys:[e]}),this.setState({defaultQuery:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return O.a.createElement(N.a,{onSubmit:this.handleSearch,layout:"inline"},O.a.createElement(M.a,{gutter:{md:8,lg:16,xl:32}},O.a.createElement(S.a,{md:6,sm:24},O.a.createElement(T,null,e("name")(O.a.createElement(F.a,{addonBefore:"名称",placeholder:"请输入"})))),O.a.createElement(S.a,{md:6,sm:24},O.a.createElement("div",{className:z.a.inputMain},O.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"对象"),O.a.createElement(T,{style:{flex:1}},e("dx")(O.a.createElement(q.a,{placeholder:"请选择",style:{width:"100%"}},H[1].map(function(e,a){return O.a.createElement(J,{key:a,value:H[0][a]},e)})))))),O.a.createElement(S.a,{md:6,sm:24},O.a.createElement("span",{className:j.a.submitButtons},O.a.createElement(D.a,{type:"primary",htmlType:"submit"},"查询"),O.a.createElement(D.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.ConserveMonitor.data,l=a.loading,r=this.state,o=r.modalVisible,d=r.updateModalVisible,s=r.detail,c={loading:l,handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},m={loading:l,detail:s,handleModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate};return O.a.createElement(B.Fragment,null,O.a.createElement(i.a,{bordered:!1},O.a.createElement("div",{className:j.a.tableList},O.a.createElement("div",{className:j.a.tableListForm},this.renderSimpleForm()),O.a.createElement("div",{className:j.a.tableListOperator},O.a.createElement(D.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建")),O.a.createElement(L.a,{rowKey:"id_",size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:l,data:t,columns:this.columns,onChange:this.handleStandardTableChange}))),O.a.createElement(K,n()({},c,{modalVisible:o})),d&&Object.keys(s).length?O.a.createElement(_,n()({modalVisible:d},m)):null)}}]),a}(B.PureComponent))||l)||l;a.default=W}}]);