(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{yYjv:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r=a("bx4M"),i=(a("bbsP"),a("/wGt")),o=(a("cWXX"),a("/ezw")),l=(a("14J3"),a("BMrR")),s=(a("iQDF"),a("+eQT")),d=(a("5NDa"),a("5rEg")),c=(a("jCWc"),a("kPKH")),p=(a("2qtc"),a("kLXV")),m=(a("5Dmo"),a("3S7+")),u=(a("+L6B"),a("2/Rp")),h=(a("+BJd"),a("mr32")),g=a("lwsE"),E=a.n(g),f=a("W8MJ"),v=a.n(f),y=a("a1gu"),w=a.n(y),N=a("Nsbk"),L=a.n(N),b=a("7W2i"),x=a.n(b),D=(a("OaEy"),a("2fM7")),S=(a("y8nQ"),a("Vl3Y")),R=a("q1tI"),I=a.n(R),T=a("MuoO"),k=a("wd/R"),C=a.n(k),M=a("CkN6"),H=a("9zHi"),A=a.n(H),B=a("ns75"),Y=a.n(B),G=a("+n12"),F=a("90cL"),V=S.a.Item,O=D.a.Option,z=Object(T.connect)(function(e){var t=e.system,a=e.TonsList,n=e.user,r=e.loading;return{currentUser:n.currentUser,system:t,TonsList:a,loading:r.models.TonsList}})(n=S.a.create()(n=function(e){function t(){var e,a;E()(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=w()(this,(e=L()(t)).call.apply(e,[this].concat(r)))).state={detailModalVisible:!1,formValues:{},siteList:[],newSiteList:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},a.columns=[{title:"车牌号",dataIndex:"carNo"},{title:"车辆方向",dataIndex:"direction"},{title:"检测时间",dataIndex:"previewTime",width:160,render:function(e){return C()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"速度(km/h)",dataIndex:"speed",width:90},{title:"轴数",dataIndex:"axleNumber"},{title:"总重(t)",dataIndex:"totalLoad",render:function(e){return(e/1e3).toFixed(2)}},{title:"限重(t)",dataIndex:"weightLimited",render:function(e){return I.a.createElement(h.a,{color:"#87d068"},(e/1e3).toFixed(2)," ")}},{title:"超重(t)",dataIndex:"overLoad",render:function(e){return e>0?I.a.createElement(h.a,{color:"#f5222d"},(e/1e3).toFixed(2)):(e/1e3).toFixed(2)}},{title:"超重比(%)",dataIndex:"overLoadRate",width:100,render:function(e){return(100*e).toFixed(2)}},{title:"操作",width:"80px",render:function(e,t){return I.a.createElement(m.a,{placement:"left",title:"详情"},I.a.createElement(u.a,{onClick:function(){return a.showDetailModal(t.id)},type:"primary",shape:"circle",icon:"eye",size:"small"}))}}],a.closeDetailDrawerVisible=function(e){a.setState({detailModalVisible:!!e}),e||a.setState({detail:{}})},a.showDetailModal=function(e){(0,a.props.dispatch)({type:"TonsList/detail",payload:e,callback:function(e){a.setState({detail:e}),a.closeDetailDrawerVisible(!0)}})},a.getList=function(e){(0,a.props.dispatch)({type:"TonsList/fetch",payload:e})},a.getSiteIN=function(){return[{property:"siteCode",value:a.state.newSiteList.map(function(e){return e.code}),group:"main",operation:"IN",relation:"AND"}]},a.renderOption=function(){return a.state.newSiteList.map(function(e){return I.a.createElement(O,{key:e.index,value:e.code},e.name)})},a.handleStandardTableChange=function(e){var t=a.state.formValues,n={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:t.join()?t:a.getSiteIN()};a.getList(n)},a.handleFormReset=function(){var e=a.props.form,t=a.state.pageBean;e.resetFields();var n=Object(G.z)("organId");a.setState({formValues:[],organCode:""});var r=[{property:"organCode",value:n,group:"main",operation:"RIGHT_LIKE",relation:"AND"}];a.getList({pageBean:t,querys:a.getSiteIN().concat(r)})},a.handleSearch=function(e){e.preventDefault();var t=a.props.form,n=a.state,r=n.pageBean,i=n.organCode,o=Object(G.z)("organId");t.validateFields(function(e,t){if(!e){var n=[t.siteCode?{property:"siteCode",value:t.siteCode,group:"main",operation:"IN",relation:"AND"}:a.getSiteIN()[0].value.length?a.getSiteIN()[0]:"",{property:"carNo",value:t.carNo||"",group:"main",operation:"LIKE",relation:"AND"},{property:"axleNumber",value:"other"===t.axleNumber?6:t.axleNumber||"",group:"main",operation:"other"===t.axleNumber?"GREAT":"EQUAL",relation:"AND"},{property:"previewTime",value:t.previewTime?[C()(t.previewTime[0]).format("YYYY-MM-DD HH:mm:ss"),C()(t.previewTime[1]).format("YYYY-MM-DD HH:mm:ss")]:"",group:"main",operation:"BETWEEN",relation:"AND"},{property:"totalLoad",value:t.totalLoadStart&&t.totalLoadEnd?[1e3*t.totalLoadStart,1e3*t.totalLoadEnd]:"",group:"main",operation:"BETWEEN",relation:"AND"},{property:"overLoadRate",value:t.overLoadRateStart&&t.overLoadRateEnd?[t.overLoadRateStart/100,t.overLoadRateEnd/100]:"",group:"main",operation:"BETWEEN",relation:"AND"}].filter(function(e){return""!==e.value});n.unshift({property:"organCode",value:i||o,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),a.setState({formValues:n}),a.getList({pageBean:r,querys:n})}})},a}return x()(t,e),v()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.dispatch,a=[{property:"organCode",value:Object(G.z)("organId").toString(),group:"main",operation:"RIGHT_LIKE",relation:"AND"}];t({type:"system/userSite",payload:{siteType:1},callback:function(t){if(t.length){var n=t.map(function(e,t){var a=Object.keys(e);return{index:t+1,code:a[0],name:e[a[0]],direction:[e[a[1]],e[a[2]]].filter(function(e){return e})}}),r=t.map(function(e){return Object.keys(e)[0]});e.setState({siteList:n,newSiteList:n,formValues:{siteCodes:r}}),e.getList({pageBean:{page:1,pageSize:10},querys:[{property:"siteCode",value:t.map(function(e){return Object.keys(e)[0]}),group:"main",operation:"IN",relation:"AND"}].concat(a)})}else p.a.error({title:"提示",content:"您没有绑定站点！！！"})}})}},{key:"renderAdvancedForm",value:function(){var e=this.props.form.getFieldDecorator;return I.a.createElement(S.a,{onSubmit:this.handleSearch,layout:"inline"},I.a.createElement(l.a,{gutter:16},I.a.createElement(c.a,{md:5,sm:24},I.a.createElement("div",{className:Y.a.inputMain},I.a.createElement("span",{style:{width:"70px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"检测点"),I.a.createElement(V,{style:{flex:1}},e("siteCodes")(I.a.createElement(D.a,{className:Y.a.inputGroupLeftRadius,placeholder:"请选择"},this.renderOption()))))),I.a.createElement(c.a,{md:4,sm:24},I.a.createElement(V,null,e("carNo")(I.a.createElement(d.a,{addonBefore:"车牌号",placeholder:"请输入"})))),I.a.createElement(c.a,{md:4,sm:24},I.a.createElement("div",{className:Y.a.inputMain},I.a.createElement("span",{style:{width:"60px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"轴数"),I.a.createElement(V,{style:{flex:1}},e("axleNumber")(I.a.createElement(D.a,{className:Y.a.inputGroupLeftRadius,placeholder:"请选择"},I.a.createElement(O,{value:""},"全部轴数"),I.a.createElement(O,{value:2},"2"),I.a.createElement(O,{value:3},"3"),I.a.createElement(O,{value:4},"4"),I.a.createElement(O,{value:5},"5"),I.a.createElement(O,{value:6},"6"),I.a.createElement(O,{value:"other"},"其他")))))),I.a.createElement(c.a,{md:6,sm:24},I.a.createElement("div",{className:Y.a.inputMain},I.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"检测时间"),I.a.createElement(V,{style:{flex:1}},e("previewTime")(I.a.createElement(s.a.RangePicker,{className:Y.a.inputGroupLeftRadius,style:{width:"100%"},showTime:{defaultValue:[C()("00:00:00","HH:mm:ss"),C()(new Date,"HH:mm:ss")]},format:"YYYY-MM-DD HH:mm:ss"}))))),I.a.createElement(c.a,{md:5,sm:24},I.a.createElement(d.a.Group,{compact:!0},I.a.createElement(V,{style:{display:"inline-block",width:"50%"}},e("totalLoadStart")(I.a.createElement(d.a,{className:"".concat(Y.a.inputGroupRightRadius," ").concat(Y.a.inputGroupRightborder),addonBefore:"总重(t)",placeholder:"请输入",style:{width:"100%",borderRight:0}}))),I.a.createElement(V,{style:{display:"inline-block",width:"50%"}},e("totalLoadEnd")(I.a.createElement(d.a,{className:Y.a.inputGroupRadiusAddon,addonBefore:"至",placeholder:"请输入",style:{width:"100%"}})))))),I.a.createElement(l.a,{gutter:16},I.a.createElement(c.a,{md:5,sm:24},I.a.createElement(d.a.Group,{compact:!0},I.a.createElement(V,{style:{display:"inline-block",width:"60%"}},e("overLoadRateStart")(I.a.createElement(d.a,{className:"".concat(Y.a.inputGroupRightRadius," ").concat(Y.a.inputGroupRightborder),addonBefore:"超限幅度(%)",placeholder:"请输入",style:{width:"100%",borderRight:0}}))),I.a.createElement(V,{style:{display:"inline-block",width:"40%"}},e("overLoadRateEnd")(I.a.createElement(d.a,{className:Y.a.inputGroupRadiusAddon,addonBefore:"至",placeholder:"请输入",style:{width:"100%"}}))))),I.a.createElement("div",{style:{overflow:"hidden"}},I.a.createElement("div",{style:{paddingRight:8,float:"right",marginBottom:24}},I.a.createElement(u.a,{type:"primary",htmlType:"submit"},"查询"),I.a.createElement(u.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,t=this.props,a=t.TonsList.data,n=t.loading,l=this.state,s=l.detail,d=l.detailModalVisible;return I.a.createElement(r.a,{bordered:!1},I.a.createElement("div",{className:A.a.tableList},I.a.createElement("div",{className:A.a.tableListForm},this.renderAdvancedForm()),I.a.createElement(M.a,{tableAlert:!1,selectedRows:0,rowSelection:null,loading:n,data:a,size:"middle",columns:this.columns,onChange:this.handleStandardTableChange})),I.a.createElement(i.a,{title:s.carNo||"未识别",width:900,destroyOnClose:!0,placement:"right",onClose:function(){return e.closeDetailDrawerVisible()},visible:d},I.a.createElement(o.a,{loading:n,active:!0},I.a.createElement(F.a,{detail:s}))))}}]),t}(R.PureComponent))||n)||n;t.default=z}}]);