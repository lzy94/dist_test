(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{bs9I:function(e,t,a){"use strict";a.r(t);var n,l=a("pVnL"),i=a.n(l),o=(a("IzEo"),a("bx4M")),r=(a("14J3"),a("BMrR")),s=(a("jCWc"),a("kPKH")),c=(a("5NDa"),a("5rEg")),d=a("RIqP"),m=a.n(d),u=(a("miYZ"),a("tsqr")),p=(a("P2fV"),a("NJEC")),f=(a("/zsF"),a("PArb")),h=(a("5Dmo"),a("3S7+")),g=a("lwsE"),y=a.n(g),E=a("W8MJ"),b=a.n(E),v=a("a1gu"),w=a.n(v),L=a("Nsbk"),C=a.n(L),F=a("7W2i"),k=a.n(F),N=(a("2qtc"),a("kLXV")),x=(a("DZo9"),a("8z0m")),S=(a("+L6B"),a("2/Rp")),V=(a("Pwec"),a("CtXQ")),R=(a("y8nQ"),a("Vl3Y")),D=a("q1tI"),q=a.n(D),B=a("MuoO"),I=a("CkN6"),M=a("+n12"),z=a("9zHi"),A=a.n(z),T=a("ZP6J"),O=a.n(T),P=R.a.Item,U={property:"fileType",value:10,operation:"EQUAL",relation:"AND"},j={page:1,pageSize:10,showTotal:!0},J=R.a.create()(function(e){var t=e.modalVisible,a=e.form,n=e.handleAdd,l=e.fileList,i=e.onCancel,o=e.uploadChange,r={name:"files",action:"/result/api/file/v1/fileUpload",accept:".doc,.docx,.pdf,.xlsx,.xls,.ppt,.pptx",data:{type:10,params:null},fileList:l,headers:{Authorization:"Bearer ".concat(Object(M.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},onChange:o,beforeUpload:M.o};return q.a.createElement(N.a,{destroyOnClose:!0,title:"上传文件",visible:t,onOk:function(){a.validateFields(function(e){e||n()})},className:O.a.formModal,onCancel:function(){return i()}},q.a.createElement("div",{className:O.a.formModalBody},q.a.createElement(P,{label:"文件上传"},a.getFieldDecorator("file",{rules:[{required:!0,message:"请选择文件!"}]})(q.a.createElement(x.a,r,q.a.createElement(S.a,null,q.a.createElement(V.a,{type:"upload"})," 选择文件（请上传 ‘pdf’ 、‘excel’ 、‘ppt’ 、‘word’文件）"))))))}),H=Object(B.connect)(function(e){return{File:e.File,loading:e.loading.models.File}})(n=R.a.create()(n=function(e){function t(){var e,a;y()(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=w()(this,(e=C()(t)).call.apply(e,[this].concat(l)))).state={modalVisible:!1,selectedRows:[],formValues:[],fileList:[]},a.columns=[{title:"上传者",dataIndex:"creatorName"},{title:"文件名称",dataIndex:"fileName"},{title:"文件类型",width:80,dataIndex:"extensionName"},{title:"上传时间",width:170,dataIndex:"createTime"},{title:"操作",width:100,render:function(e,t){return q.a.createElement(D.Fragment,null,q.a.createElement(h.a,{placement:"left",title:"下载"},q.a.createElement(S.a,{type:"primary",shape:"circle",icon:"download",size:"small",onClick:function(){return a.downLoadFile(t)}})),q.a.createElement(f.a,{type:"vertical"}),q.a.createElement(p.a,{title:"是否删除数据?",onConfirm:function(){return a.dataDel(t.id)},okText:"确定",cancelText:"取消"},q.a.createElement(h.a,{placement:"left",title:"删除"},q.a.createElement(S.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],a.getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.props.dispatch)({type:"File/fetch",payload:e})},a.downLoadFile=function(e){var t=a.props.dispatch,n=e.id;t({type:"File/downLoad",payload:{fileName:e.fileName,extensionName:e.extensionName,id:n},callback:function(e){404===e&&u.a.error("文件不存在")}})},a.dataDel=function(e){a.delUtil(e)},a.batchDel=function(){var e=a.state.selectedRows;e.length&&N.a.confirm({title:"提示",content:"是否删除数据？",onOk:function(){var t=e.map(function(e){return e.id});a.delUtil(t.join(),function(){a.setState({selectedRows:[]})})}})},a.delUtil=function(e,t){(0,a.props.dispatch)({type:"File/remove",payload:e,callback:function(){u.a.success("删除成功"),a.getList({pageBean:j,querys:[U]}),t&&t()}})},a.handleStandardTableChange=function(e){var t=a.state.formValues,n={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:[U].concat(m()(t))};a.getList(n)},a.handleFormReset=function(){a.props.form.resetFields(),a.setState({formValues:[],selectedRows:[]}),a.getList({pageBean:j,querys:[U]})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.handleModalVisible=function(e){a.setState({modalVisible:!!e})},a.uploadChange=function(e){if("done"===e.file.status)200===e.file.response.code?u.a.success("上传成功"):u.a.error("".concat(e.file.name," - 上传失败"));else if("error"===e.file.status)u.a.error("上传失败");else if("removed"===e.file.status){200===e.file.response.code&&a.dataDel(e.file.response.fileId)}a.setState({fileList:m()(e.fileList)})},a.handleAdd=function(){a.getList({pageBean:j,querys:[U]}),a.handleModalVisible()},a.onCancel=function(){var e=a.state.fileList;if(e.length){var t=e.map(function(e){return e.response.fileId}).join();a.delUtil(t)}a.handleModalVisible()},a.handleSearch=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){var n={fileName:t.name},l=Object.keys(n).map(function(e){return n[e]?{property:e,value:n[e],group:"main",operation:"LIKE",relation:"AND"}:""}),i=l.filter(function(e){return e});a.setState({formValues:i}),a.getList({pageBean:j,querys:[U].concat(m()(l))})}})},a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){this.getList({pageBean:j,querys:[U]})}},{key:"renderForm",value:function(){var e=this.props.form.getFieldDecorator;return q.a.createElement(R.a,{onSubmit:this.handleSearch,layout:"inline"},q.a.createElement(r.a,{gutter:{md:8,lg:16,xl:32}},q.a.createElement(s.a,{md:6,sm:24},q.a.createElement(P,null,e("name")(q.a.createElement(c.a,{addonBefore:"文件名称",placeholder:"请输入"})))),q.a.createElement(s.a,{md:6,sm:24},q.a.createElement("span",{className:A.a.submitButtons},q.a.createElement(S.a,{type:"primary",htmlType:"submit"},"查询"),q.a.createElement(S.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,t=this.props,a=t.File.data,n=t.loading,l=this.state,r=l.selectedRows,s=l.modalVisible,c={fileList:l.fileList,handleAdd:this.handleAdd,uploadChange:this.uploadChange,onCancel:this.onCancel};return q.a.createElement(D.Fragment,null,q.a.createElement(o.a,{bordered:!1},q.a.createElement("div",{className:A.a.tableList},q.a.createElement("div",{className:A.a.tableListForm},this.renderForm()),q.a.createElement("div",{className:A.a.tableListOperator},q.a.createElement(S.a,{icon:"upload",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"上传文件"),r.length>0&&q.a.createElement(S.a,{type:"danger",onClick:this.batchDel},"批量删除")),q.a.createElement(I.a,{tableAlert:!0,size:"middle",selectedRows:r,loading:n,data:a,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),q.a.createElement(J,i()({},c,{modalVisible:s})))}}]),t}(D.PureComponent))||n)||n;t.default=H}}]);