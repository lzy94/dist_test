(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{zGo6:function(e,a,t){"use strict";t.r(a);var n,l=t("pVnL"),r=t.n(l),i=(t("IzEo"),t("bx4M")),o=(t("miYZ"),t("tsqr")),s=(t("P2fV"),t("NJEC")),d=(t("/zsF"),t("PArb")),m=(t("5Dmo"),t("3S7+")),c=(t("+L6B"),t("2/Rp")),u=t("lwsE"),p=t.n(u),g=t("W8MJ"),h=t.n(g),E=t("a1gu"),y=t.n(E),f=t("Nsbk"),b=t.n(f),V=t("7W2i"),C=t.n(V),N=(t("2qtc"),t("kLXV")),v=(t("14J3"),t("BMrR")),w=(t("giR+"),t("fyUT")),D=(t("nRaC"),t("5RzL")),M=(t("jCWc"),t("kPKH")),S=(t("5NDa"),t("5rEg")),F=(t("y8nQ"),t("Vl3Y")),k=(t("OaEy"),t("2fM7")),L=t("q1tI"),P=t.n(L),x=t("MuoO"),B=t("CkN6"),q=t("1TjV"),A=t("9zHi"),O=t.n(A),H=t("ZP6J"),I=t.n(H),z=t("z1x1"),j=t("ns75"),U=t.n(j),R=k.a.Option,T=F.a.Item,J=[{type:1,name:"水位点位"},{type:2,name:"位移点位"}],_=F.a.create()(function(e){var a=e.modalVisible,t=e.form,n=e.handleAdd,l=e.handleModalVisible,r=e.treeList,i=e.parentAddress,o=e.treeSelectChange,s=e.handleMonitorVisible,d=e.minitors,m=e.typeValue,c=e.typeChange;return P.a.createElement(N.a,{destroyOnClose:!0,title:"添加点位",className:I.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||n(a,function(){return t.resetFields()})})},width:700,onCancel:function(){return l()}},P.a.createElement("div",{className:I.a.formModalBody},P.a.createElement(v.a,{gutter:40},P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"点位名称"},t.getFieldDecorator("pointName",{rules:[{required:!0,message:"请选择点位名称！"}]})(P.a.createElement(S.a,{placeholder:"请选择"})))),P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"点位编号"},t.getFieldDecorator("pointCode",{rules:[{required:!0,message:"请输入点位编号！"}]})(P.a.createElement(S.a,{placeholder:"请输入"})))),P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"点位类型"},t.getFieldDecorator("type",{rules:[{required:!0,message:"请选择点位类型！"}]})(P.a.createElement(k.a,{style:{width:"100%"},placeholder:"请选择",onChange:c},J.map(function(e){return P.a.createElement(R,{value:e.type,key:e.type},e.name)}))))),P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"行政区域"},t.getFieldDecorator("organCode",{rules:[{required:!0,message:"请选择行政区域！"}]})(P.a.createElement(D.a,{treeData:r,style:{width:"100%"},placeholder:"请选择",onChange:o})))),1===m&&P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"保障水位(m)"},t.getFieldDecorator("normalHigh",{rules:[{required:!0,message:"请输入保障水位！"}]})(P.a.createElement(w.a,{style:{width:"100%"},placeholder:"请输入"})))),P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:1===m?"预警水位(m)":"预警位移(dm)"},t.getFieldDecorator("warningHigh",{rules:[{required:!0,message:"请输入".concat(1===m?"预警水位":"预警位移")}]})(P.a.createElement(w.a,{style:{width:"100%"},placeholder:"请输入"})))),P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"监控点位"},t.getFieldDecorator("mediaNo",{initialValue:d.minitorPointName,rules:[{message:"请选择监控点位！"}]})(P.a.createElement(S.a,{placeholder:"请选择",readOnly:!0,onClick:function(){return s(!0)}})))),P.a.createElement(M.a,{md:24,sm:24},P.a.createElement(z.a,{parentAddress:i})))))}),K=F.a.create()(function(e){var a=e.modalVisible,t=e.form,n=e.handleUpdate,l=e.handleModalVisible,r=e.treeList,i=e.parentAddress,o=e.treeSelectChange,s=e.detail,d=e.handleMonitorVisible,m=e.lnglat,c=e.minitors,u=e.typeValue,p=e.typeChange;return P.a.createElement(N.a,{destroyOnClose:!0,title:"编辑点位",className:I.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||n(a,function(){return t.resetFields()})})},width:700,onCancel:function(){return l()}},P.a.createElement("div",{className:I.a.formModalBody},P.a.createElement(v.a,{gutter:40},P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"点位名称"},t.getFieldDecorator("pointName",{initialValue:s.pointName,rules:[{required:!0,message:"请选择点位名称！"}]})(P.a.createElement(S.a,{placeholder:"请选择"})))),P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"点位编号"},t.getFieldDecorator("pointCode",{initialValue:s.pointCode,rules:[{required:!0,message:"请输入点位编号！"}]})(P.a.createElement(S.a,{placeholder:"请输入"})))),P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"点位类型"},t.getFieldDecorator("type",{initialValue:s.type,rules:[{required:!0,message:"请选择点位类型！"}]})(P.a.createElement(k.a,{style:{width:"100%"},placeholder:"请选择",onChange:p},J.map(function(e){return P.a.createElement(R,{value:e.type,key:e.type},e.name)}))))),P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"行政区域"},t.getFieldDecorator("organCode",{initialValue:s.organCode,rules:[{required:!0,message:"请选择行政区域！"}]})(P.a.createElement(D.a,{treeData:r,style:{width:"100%"},placeholder:"请选择",onChange:o})))),1===u&&P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"保障水位(m)"},t.getFieldDecorator("normalHigh",{initialValue:s.normalHigh,rules:[{required:!0,message:"请输入保障水位！"}]})(P.a.createElement(w.a,{style:{width:"100%"},placeholder:"请输入"})))),P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:1===u?"预警水位(m)":"预警位移(dm)"},t.getFieldDecorator("warningHigh",{initialValue:s.warningHigh,rules:[{required:!0,message:"请输入".concat(1===u?"预警水位":"预警位移")}]})(P.a.createElement(w.a,{style:{width:"100%"},placeholder:"请输入"})))),P.a.createElement(M.a,{md:12,sm:24},P.a.createElement(T,{label:"监控点位"},t.getFieldDecorator("mediaNo",{initialValue:c.minitorPointName,rules:[{message:"请选择监控点位！"}]})(P.a.createElement(S.a,{placeholder:"请选择",readOnly:!0,onClick:function(){return d(!0)}})))),P.a.createElement(M.a,{md:24,sm:24},P.a.createElement(z.a,{lngLat:{longitude:m[0],latitude:m[1]},address:s.addr,parentAddress:i})))))}),W=Object(x.connect)(function(e){return{system:e.system,ConservePoint:e.ConservePoint,loading:e.loading.models.ConservePoint}})(n=F.a.create()(n=function(e){function a(){var e,t;p()(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=y()(this,(e=b()(a)).call.apply(e,[this].concat(l)))).state={monitorVisible:!1,modalVisible:!1,updateModalVisible:!1,formValues:[],address:"",lnglat:[],organName:"",detail:{},minitors:{},typeValue:1,pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"点位编号",dataIndex:"pointCode"},{title:"点位名称",dataIndex:"pointName"},{title:"点位类型",dataIndex:"type",render:function(e){return J[e-1].name}},{title:"监测地址",dataIndex:"addr"},{title:"保障水位(m)",render:function(e){return 1===e.type?e.normalHigh:"—"}},{title:"预警水位(m)",render:function(e){return 1===e.type?e.warningHigh:"—"}},{title:"预警位移(dm)",render:function(e){return 2===e.type?e.warningHigh:"—"}},{title:"行政区域",dataIndex:"organName"},{title:"操作",width:100,render:function(e,a){return P.a.createElement(L.Fragment,null,P.a.createElement(m.a,{placement:"left",title:"编辑"},P.a.createElement(c.a,{onClick:function(){return t.editData(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),P.a.createElement(d.a,{type:"vertical"}),P.a.createElement(s.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id_)},okText:"确定",cancelText:"取消"},P.a.createElement(m.a,{placement:"left",title:"删除"},P.a.createElement(c.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.getList=function(e){(0,t.props.dispatch)({type:"ConservePoint/fetch",payload:e})},t.dataDel=function(e){(0,t.props.dispatch)({type:"ConservePoint/remove",payload:{id:e},callback:function(){o.a.success("删除成功");var e=t.state.pageBean;t.getList({pageBean:e})}})},t.editData=function(e){var a=e.mediaNo?e.mediaNo.split("_"):[];t.setState({detail:e,typeValue:e.type,minitors:{minitorPointID:a[1],minitorPointName:a[0]},address:e.addr,organName:e.organName,lnglat:e.longitudeandlatitude?e.longitudeandlatitude.split(","):[0,0]},function(){return t.handleUpdateModalVisible(!0)})},t.parentAddress=function(e,a){t.setState({address:e,lnglat:a})},t.selectData=function(e){t.setState({minitors:{minitorPointID:e.id_,minitorPointName:e.pointName}})},t.handleStandardTableChange=function(e){var a=t.state.formValues,n={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:a};t.getList(n)},t.handleFormReset=function(){t.props.form.resetFields(),t.setState({formValues:[]}),t.getList({pageBean:t.state.pageBean})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var n=t.state.pageBean,l={addr:a.address,organCode:a.code,type:a.dwlx},r=Object.keys(l).map(function(e){return l[e]?{property:e,value:l[e],group:"main",operation:"organCode"===e?"EQUAL":"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:r}),t.getList({pageBean:n,querys:r})}})},t.handleMonitorVisible=function(e){t.setState({monitorVisible:!!e})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e}),e||t.setState({minitors:{},typeValue:1})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{},minitors:{},typeValue:1})},t.handleAdd=function(e){var a=t.props.dispatch,n=t.state,l=n.address,r=n.lnglat,i=n.pageBean,s=n.organName,d=n.minitors;l&&r.join()?(e.addr=l,e.longitudeandlatitude=r.join(),e.organName=s,e.mediaNo="".concat(d.minitorPointName||"","_").concat(d.minitorPointID||""),a({type:"ConservePoint/add",payload:e,callback:function(){o.a.success("添加成功"),t.handleModalVisible(),t.getList({pageBean:i})}})):o.a.error("请获取位置")},t.treeSelectChange=function(e,a){t.setState({organName:a[0]})},t.typeChange=function(e){return t.setState({typeValue:e})},t.handleUpdate=function(e){var a=t.props.dispatch,n=t.state,l=n.address,r=n.lnglat,i=n.pageBean,s=n.organName,d=n.detail,m=n.minitors,c=JSON.parse(JSON.stringify(d));if(l&&r.join()){e.addr=l,e.longitudeandlatitude=r.join(),e.organName=s,e.mediaNo="".concat(m.minitorPointName,"_").concat(m.minitorPointID);for(var u=Object.keys(e),p=0;p<u.length;p+=1)c[u[p]]=e[u[p]];t.setState({detail:c}),a({type:"ConservePoint/update",payload:c,callback:function(){o.a.success("编辑成功"),t.handleUpdateModalVisible(),t.getList({pageBean:i})}})}else o.a.error("请获取位置")},t}return C()(a,e),h()(a,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props,a=e.form.getFieldDecorator,t=e.system.treeList;return P.a.createElement(F.a,{onSubmit:this.handleSearch,layout:"inline"},P.a.createElement(v.a,{gutter:{md:8,lg:16,xl:32}},P.a.createElement(M.a,{md:6,sm:24},P.a.createElement(T,null,a("address")(P.a.createElement(S.a,{addonBefore:"地址",placeholder:"请输入"})))),P.a.createElement(M.a,{md:6,sm:24},P.a.createElement("div",{className:U.a.inputMain},P.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"点位类型"),P.a.createElement(T,{style:{flex:1}},a("dwlx")(P.a.createElement(k.a,{style:{width:"100%"},placeholder:"请选择"},J.map(function(e){return P.a.createElement(R,{value:e.type,key:e.type},e.name)})))))),P.a.createElement(M.a,{md:6,sm:24},P.a.createElement("div",{className:U.a.inputMain},P.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"区域"),P.a.createElement(T,{style:{flex:1}},a("code")(P.a.createElement(D.a,{className:U.a.inputGroupLeftRadius,treeData:t,style:{width:"100%"},placeholder:"请选择"}))))),P.a.createElement(M.a,{md:6,sm:24},P.a.createElement("span",{className:O.a.submitButtons},P.a.createElement(c.a,{type:"primary",htmlType:"submit"},"查询"),P.a.createElement(c.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.ConservePoint.data,n=a.system.treeList,l=a.loading,o=this.state,s=o.modalVisible,d=o.monitorVisible,m=o.updateModalVisible,u=o.detail,p=o.address,g=o.lnglat,h=o.minitors,E={treeList:n,typeValue:o.typeValue,typeChange:this.typeChange,parentAddress:this.parentAddress,treeSelectChange:this.treeSelectChange,handleMonitorVisible:this.handleMonitorVisible},y={minitors:h,handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},f={detail:u,address:p,lnglat:g,minitors:h,handleModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate};return P.a.createElement(L.Fragment,null,P.a.createElement(i.a,{bordered:!1},P.a.createElement("div",{className:O.a.tableList},P.a.createElement("div",{className:O.a.tableListForm},this.renderSimpleForm()),P.a.createElement("div",{className:O.a.tableListOperator},P.a.createElement(c.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建")),P.a.createElement(B.a,{rowKey:"id_",size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:l,data:t,columns:this.columns,onChange:this.handleStandardTableChange}))),s?P.a.createElement(_,r()({},E,y,{modalVisible:s})):null,m&&Object.keys(u).length?P.a.createElement(K,r()({},E,f,{modalVisible:m})):null,d?P.a.createElement(q.a,{modalVisible:d,selectData:this.selectData,handleModalVisible:this.handleMonitorVisible}):null)}}]),a}(L.PureComponent))||n)||n;a.default=W}}]);