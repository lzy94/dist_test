(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{"zy/Y":function(e,t,a){"use strict";a.r(t);var n,r=a("pVnL"),l=a.n(r),i=(a("IzEo"),a("bx4M")),o=(a("T2oS"),a("W9HT")),s=(a("14J3"),a("BMrR")),c=(a("5NDa"),a("5rEg")),d=(a("jCWc"),a("kPKH")),m=(a("ozfa"),a("MJZm")),u=a("MVZn"),p=a.n(u),f=(a("5Dmo"),a("3S7+")),h=(a("+L6B"),a("2/Rp")),y=(a("+BJd"),a("mr32")),g=a("lwsE"),E=a.n(g),v=a("W8MJ"),b=a.n(v),S=a("a1gu"),w=a.n(S),x=a("Nsbk"),N=a.n(x),L=a("7W2i"),k=a.n(L),C=(a("2qtc"),a("kLXV")),M=(a("Pwec"),a("CtXQ")),F=(a("y8nQ"),a("Vl3Y")),V=(a("OaEy"),a("2fM7")),I=a("q1tI"),T=a.n(I),B=a("MuoO"),O=a("wd/R"),D=a.n(O),R=a("CkN6"),K=a("mf+E"),H=a("+n12"),Y=a("9zHi"),z=a.n(Y),j=a("ns75"),A=a.n(j),J=a("ZP6J"),P=a.n(J),q=a("PpbR"),W=a("Py4S"),U=a.n(W),Z=function(e){function t(){return E()(this,t),w()(this,N()(t).apply(this,arguments))}return k()(t,e),b()(t,[{key:"render",value:function(){var e=this.props.detail,t={background:"#FFD7D7",color:"#F75A5A"};return T.a.createElement("div",{className:P.a.detailMsg},T.a.createElement(s.a,{gutter:{md:8,lg:24,xl:48}},T.a.createElement(d.a,{md:6,sm:24},T.a.createElement(q.a,{title:"轴数",value:e.axleNumber,suffex:"轴"}),T.a.createElement(q.a,{title:"总重",value:(e.totalLoad/1e3).toFixed(2),suffex:"t"}),T.a.createElement(q.a,{title:"超重",value:(e.overLoad/1e3).toFixed(2),suffex:"t",bodyStyle:t}),T.a.createElement(q.a,{title:"超重比",value:(100*e.overLoadRate).toFixed(2),suffex:"%",bodyStyle:t})),T.a.createElement(d.a,{md:18,sm:24},T.a.createElement("div",{style:{background:"#000",minHeight:"200px"}},T.a.createElement(U.a,{backdrop:"rgba(255,255,255,.3)",style:{width:"100%"},src:H.B+e.imgUrl,alt:"图片"})))))}}]),t}(I.Component),Q=["/overview/source","/overview/source/info"],X=V.a.Option,G=F.a.Item,$=F.a.create()(function(e){var t=e.modalVisible,a=e.handleModalVisible,n=e.detail,r=T.a.createElement("div",{className:P.a.modalHeader},T.a.createElement("div",{className:P.a.title},T.a.createElement("span",{className:P.a.value},n.carNo),T.a.createElement("span",{className:P.a.time},D()(n.previewTime).format("YYYY-M-D HH:mm:ss"))),T.a.createElement("div",{className:P.a.titleRight},T.a.createElement("div",{className:P.a.local},T.a.createElement(M.a,{type:"environment"}),T.a.createElement("a",{title:n.sourceCompanyName},n.sourceCompanyName))));return T.a.createElement(C.a,{destroyOnClose:!0,className:P.a.modalStyle,title:r,visible:t,onCancel:function(){return a()},footer:null,width:750},T.a.createElement("div",{style:{padding:16,background:"#fff"}},T.a.createElement(Z,{detail:n})))}),_=Object(B.connect)(function(e){var t=e.OverviewSource,a=e.loading,n=e.system,r=e.user;return{Source:e.Source,system:n,OverviewSource:t,currentUser:r.currentUser,loading:a.models.OverviewSource,systemLoading:a.models.system}})(n=F.a.create()(n=function(e){function t(){var e,a;E()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=w()(this,(e=N()(t)).call.apply(e,[this].concat(r)))).state={modalVisible:!1,formValues:[],detail:{},treeFormValue:{},selectedKeys:[],expandCheckKeys:[],sourceList:[],pageBean:{page:1,pageSize:10,showTotal:!0}},a.columns=[{title:"车牌号",dataIndex:"carNo"},{title:"源头企业",dataIndex:"sourceCompanyName"},{title:"检测时间",width:170,dataIndex:"previewTime",render:function(e){return D()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"轴数",dataIndex:"axleNumber"},{title:"总重(t)",dataIndex:"totalLoad",render:function(e){return e/1e3}},{title:"限载重(t)",dataIndex:"weightLimited",render:function(e){return e/1e3}},{title:"超重(t)",dataIndex:"overLoad",render:function(e){return e>0?T.a.createElement(y.a,{color:"#f50"},(e/1e3).toFixed(2)):e}},{title:"超重比(%)",dataIndex:"overLoadRate",render:function(e){return(100*e).toFixed(2)}},Object(H.b)(Q[1])?{title:"操作",width:70,render:function(e,t){return T.a.createElement(I.Fragment,null,T.a.createElement(f.a,{placement:"left",title:"详情"},T.a.createElement(h.a,{onClick:function(){return a.showDetailModal(t)},type:"primary",shape:"circle",icon:"eye",size:"small"})))}}:null].filter(function(e){return e}),a.getList=function(e){(0,a.props.dispatch)({type:"OverviewSource/fetch",payload:p()({},e,{sorter:[{direction:"DESC",property:"previewTime"}]})})},a.showDetailModal=function(e){a.setState({detail:e},function(){a.handleModalVisible(!0)})},a.getSourceList=function(e){(0,a.props.dispatch)({type:"Source/listByOrganId",payload:{organId:e},callback:function(e){a.setState({sourceList:e})}})},a.handleStandardTableChange=function(e,t,n){var r=a.state.formValues,l={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:r};a.getList(l)},a.handleFormReset=function(){var e=a.props.form,t=a.state.pageBean;e.resetFields(),a.setState({formValues:[],selectedKeys:[]}),a.getList({pageBean:t})},a.handleSearch=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){var n=a.state.pageBean,r=p()({},t),l=Object.keys(r).map(function(e){return r[e]?{property:e,value:r[e],group:"main",operation:"LIKE",relation:"AND"}:""}).filter(function(e){return e});a.setState({formValues:l}),a.getList({pageBean:n,querys:l})}})},a.handleModalVisible=function(e){a.setState({modalVisible:!!e})},a.onSelect=function(e,t){e[0]&&(a.props.form.resetFields(),a.setState({selectedKeys:e}),a.getSourceList(e.join()))},a.expandCheck=function(e){a.setState({expandCheckKeys:e})},a.renderTreeNodes=function(e){return e.map(function(e){return e.children?T.a.createElement(m.a.TreeNode,{title:e.title,key:e.key,dataRef:e},a.renderTreeNodes(e.children)):T.a.createElement(m.a.TreeNode,e)})},a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){if(Object(H.b)(Q[0])){var e=this.state.pageBean,t=localStorage.getItem("organId");this.getList({pageBean:e}),this.getSourceList(t)}}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.sourceList;return T.a.createElement(F.a,{onSubmit:this.handleSearch,layout:"inline"},T.a.createElement(s.a,{gutter:{md:8,lg:16,xl:32}},T.a.createElement(d.a,{md:5,sm:24},T.a.createElement("div",{className:A.a.inputMain},T.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"源头企业"),T.a.createElement(G,{style:{flex:1}},e("siteCode")(T.a.createElement(V.a,{className:A.a.inputGroupLeftRadius,placeholder:"请选择"},t.map(function(e,t){return T.a.createElement(X,{key:t,value:e.siteCode},e.companyName)})))))),T.a.createElement(d.a,{md:5,sm:24},T.a.createElement(G,null,e("carNo")(T.a.createElement(c.a,{addonBefore:"车牌号",placeholder:"请输入"})))),T.a.createElement(d.a,{md:5,sm:24},T.a.createElement("span",{className:z.a.submitButtons},T.a.createElement(h.a,{type:"primary",htmlType:"submit"},"查询"),T.a.createElement(h.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this.props,t=e.system.treeList,a=e.OverviewSource.data,n=e.loading,r=e.systemLoading,s=this.state,c=s.modalVisible,d=s.detail,u=s.expandCheckKeys,p=s.selectedKeys,f={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible,detail:d};return T.a.createElement(I.Fragment,null,Object(H.b)(Q[0])?null:T.a.createElement(K.a,{to:"/exception/403"}),T.a.createElement("div",{className:z.a.tableMain},T.a.createElement(o.a,{spinning:r},T.a.createElement("div",{className:z.a.treeLeft},T.a.createElement(m.a,{selectedKeys:p,showLine:!0,onSelect:this.onSelect,expandedKeys:u[0]?u:[t[0]?t[0].key:""],onExpand:this.expandCheck},this.renderTreeNodes(t)))),T.a.createElement("div",{className:z.a.rightTable},T.a.createElement(i.a,{bordered:!1,style:{height:"100%"}},T.a.createElement("div",{className:z.a.tableList},T.a.createElement("div",{className:z.a.tableListForm},this.renderSimpleForm()),T.a.createElement(R.a,{size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:n,data:a,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))))),T.a.createElement($,l()({},f,{modalVisible:c})))}}]),t}(I.PureComponent))||n)||n;t.default=_}}]);