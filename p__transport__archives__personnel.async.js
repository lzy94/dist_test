(window.webpackJsonp=window.webpackJsonp||[]).push([[197],{voar:function(e,a,t){"use strict";t.r(a);var l,r,n,i,o,s,c,d=t("pVnL"),m=t.n(d),u=(t("IzEo"),t("bx4M")),p=(t("14J3"),t("BMrR")),h=(t("jCWc"),t("kPKH")),f=(t("5NDa"),t("5rEg")),g=(t("miYZ"),t("tsqr")),E=(t("P2fV"),t("NJEC")),b=(t("/zsF"),t("PArb")),y=(t("5Dmo"),t("3S7+")),v=(t("+L6B"),t("2/Rp")),V=t("lwsE"),k=t.n(V),F=t("W8MJ"),C=t.n(F),S=t("a1gu"),M=t.n(S),D=t("Nsbk"),w=t.n(D),L=t("7W2i"),N=t.n(L),P=(t("OaEy"),t("2fM7")),T=(t("y8nQ"),t("Vl3Y")),x=t("q1tI"),q=t.n(x),A=t("MuoO"),B=t("CkN6"),I=t("+n12"),j=(t("2qtc"),t("kLXV")),O=(t("DZo9"),t("8z0m")),z=(t("Pwec"),t("CtXQ")),R=(t("7Kak"),t("9yH6")),J=t("MVZn"),U=t.n(J),H=t("y01j"),G=t("ZP6J"),K=t.n(G),W=T.a.Item,X=Object(A.connect)(function(e){return{TransportArchivesPersonnel:e.TransportArchivesPersonnel,loading:e.loading.models.TransportArchivesPersonnel}})(l=T.a.create()((n=r=function(e){function a(){var e,t;k()(this,a);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return(t=M()(this,(e=w()(a)).call.apply(e,[this].concat(r)))).state={modalFirmVisible:!1,fileList:[],companyId:""},t.handleFirmModalVisible=function(e){t.setState({modalFirmVisible:!!e})},t.setSelectData=function(e){var a=t.props.form;t.setState({companyId:e.id_}),a.setFieldsValue({companyName:e.companyName,companyTel:e.account})},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",className:"upload-list-inline",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(I.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:I.A,onChange:t.uploadChange}},t.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(g.a.success("上传成功"),t.setState({fileList:e.fileList})):g.a.error(e.file.response.code.msg):"error"===e.file.status?g.a.error("上传失败"):"removed"===e.file.status&&t.setState({fileList:e.fileList})},t.save=function(){var e=t.props,a=e.dispatch,l=e.form,r=e.modalCallback,n=e.handleModalVisible,i=t.state,o=i.fileList,s=i.companyId;l.validateFields(function(e,t){if(!e){if(!o.length)return g.a.error("请选择图片");var l=U()({},t,{companyId:s,img:o.length?o[0].response.filePath:"",status:2});delete l.imgPath,a({type:"TransportArchivesPersonnel/add",payload:l,callback:function(){g.a.success("添加成功"),n(),setTimeout(function(){return r()},300)}})}})},t.cancelClick=function(){var e=t.props.handleModalVisible;t.setState({fileList:[]}),e()},t}return N()(a,e),C()(a,[{key:"render",value:function(){var e=this,a=this.props,t=a.form,l=a.modalVisible,r=a.loading,n=this.state,i=n.modalFirmVisible,o=n.fileList;return q.a.createElement(x.Fragment,null,q.a.createElement(j.a,{destroyOnClose:!0,title:"添加",className:K.a.formModal,visible:l,width:800,onCancel:this.cancelClick,footer:[q.a.createElement(v.a,{key:"back",onClick:this.cancelClick},"取消"),q.a.createElement(v.a,{key:"submit",type:"primary",loading:r,onClick:this.save},"确定")]},q.a.createElement("div",{className:K.a.formModalBody},q.a.createElement(p.a,{gutter:40},q.a.createElement(h.a,{md:12,sm:24},q.a.createElement(W,{label:"姓名"},t.getFieldDecorator("userName",{rules:[{required:!0,message:"请输入姓名！"}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(W,{label:"性别"},t.getFieldDecorator("sex",{initialValue:1,rules:[{required:!0,message:"请选择性别！"}]})(q.a.createElement(R.a.Group,null,q.a.createElement(R.a,{value:1},"男"),q.a.createElement(R.a,{value:2},"女")))),q.a.createElement(W,{label:"联系方式"},t.getFieldDecorator("tel",{rules:[{required:!0,validator:I.h}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(W,{label:"身份证号码"},t.getFieldDecorator("idcard",{rules:[{required:!0,validator:I.d}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(W,{label:"职务"},t.getFieldDecorator("position",{rules:[{required:!0,message:"请输入职务！"}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(W,{label:"照片"},t.getFieldDecorator("imgPath",{rules:[{required:!0,message:"请上传照片！"}]})(q.a.createElement(O.a,m()({},this.uploadConfig(),{defaultFileList:o}),o.length>0?null:q.a.createElement(v.a,null,q.a.createElement(z.a,{type:"upload"})," 请上传照片(.jpg,.jpeg,.png)"))))),q.a.createElement(h.a,{md:12,sm:24},q.a.createElement(W,{label:"人员类别"},t.getFieldDecorator("type",{initialValue:1,rules:[{required:!0,message:"请选择人员类别！"}]})(q.a.createElement(R.a.Group,null,q.a.createElement(R.a,{value:1},"管理员"),q.a.createElement(R.a,{value:2},"驾驶员")))),q.a.createElement(W,{label:"学历（驾驶员可不填）"},t.getFieldDecorator("education",{rules:[{message:"请输入学历！"}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(W,{label:"从业资格证号（管理员可不填）"},t.getFieldDecorator("practitionLicense",{rules:[{message:"请输入从业资格证号！"}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(W,{label:"公司名称"},t.getFieldDecorator("companyName",{rules:[{required:!0,message:"请输入公司名称！"}]})(q.a.createElement(f.a,{readOnly:!0,placeholder:"请输入",onClick:function(){return e.handleFirmModalVisible(!0)}}))),q.a.createElement(W,{label:"公司联系电话"},t.getFieldDecorator("companyTel",{rules:[{required:!0,message:"请输入公司联系电话码！"}]})(q.a.createElement(f.a,{placeholder:"请输入"}))))))),i?q.a.createElement(H.a,{modalVisible:i,setSelectData:this.setSelectData,handleModalVisible:this.handleFirmModalVisible}):null)}}]),a}(x.PureComponent),r.defaultProps={modalVisible:!1,handleModalVisible:function(){}},l=n))||l)||l,Z=T.a.Item,Q=["待审核","审核通过","驳回"],_=Object(A.connect)(function(e){return{TransportArchivesPersonnel:e.TransportArchivesPersonnel,loading:e.loading.models.TransportArchivesPersonnel}})(i=T.a.create()((s=o=function(e){function a(){var e,t;k()(this,a);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return(t=M()(this,(e=w()(a)).call.apply(e,[this].concat(r)))).state={modalFirmVisible:!1,fileList:[],companyId:"",detail:{},isSet:!1},t.handleFirmModalVisible=function(e){t.setState({modalFirmVisible:!!e})},t.setSelectData=function(e){var a=t.props.form;t.setState({companyId:e.id_}),a.setFieldsValue({companyName:e.companyName,companyTel:e.account})},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",className:"upload-list-inline",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(I.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:I.A,onChange:t.uploadChange}},t.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(g.a.success("上传成功"),t.setState({fileList:e.fileList})):g.a.error(e.file.response.code.msg):"error"===e.file.status?g.a.error("上传失败"):"removed"===e.file.status&&t.setState({fileList:e.fileList})},t.save=function(){var e=t.props,a=e.dispatch,l=e.form,r=e.modalCallback,n=e.handleModalVisible,i=t.state,o=i.companyId,s=i.detail,c=i.fileList;l.validateFields(function(e,t){if(!e){var l=U()({},t,{companyId:o});if(!c.length)return g.a.error("请选择图片");if("object"==typeof l.imgPath){var i=l.imgPath.file.response;l.img=i?i.filePath:""}delete l.imgPath;for(var d=JSON.parse(JSON.stringify(s)),m=Object.keys(l),u=0;u<m.length;u+=1)d[m[u]]=l[m[u]];a({type:"TransportArchivesPersonnel/update",payload:d,callback:function(){g.a.success("编辑成功"),n(),setTimeout(function(){return r()},300)}})}})},t.cancelClick=function(){var e=t.props.handleModalVisible;t.setState({fileList:[]}),e()},t}return N()(a,e),C()(a,[{key:"render",value:function(){var e=this,a=this.props,t=a.form,l=a.modalVisible,r=a.loading,n=this.state,i=n.modalFirmVisible,o=n.fileList,s=n.detail;return q.a.createElement(x.Fragment,null,q.a.createElement(j.a,{destroyOnClose:!0,title:"编辑",className:K.a.formModal,visible:l,width:800,onCancel:this.cancelClick,footer:[q.a.createElement(v.a,{key:"back",onClick:this.cancelClick},"取消"),q.a.createElement(v.a,{key:"submit",type:"primary",loading:r,onClick:this.save},"确定")]},q.a.createElement("div",{className:K.a.formModalBody},q.a.createElement(p.a,{gutter:40},q.a.createElement(h.a,{md:12,sm:24},q.a.createElement(Z,{label:"姓名"},t.getFieldDecorator("userName",{initialValue:s.userName,rules:[{required:!0,message:"请输入姓名！"}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(Z,{label:"性别"},t.getFieldDecorator("sex",{initialValue:s.sex,rules:[{required:!0,message:"请选择性别！"}]})(q.a.createElement(R.a.Group,null,q.a.createElement(R.a,{value:1},"男"),q.a.createElement(R.a,{value:2},"女")))),q.a.createElement(Z,{label:"联系方式"},t.getFieldDecorator("tel",{initialValue:s.tel,rules:[{required:!0,validator:I.h}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(Z,{label:"身份证号码"},t.getFieldDecorator("idcard",{initialValue:s.idcard,rules:[{required:!0,validator:I.d}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(Z,{label:"职务"},t.getFieldDecorator("position",{initialValue:s.position,rules:[{required:!0,message:"请输入职务！"}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(Z,{label:"照片"},t.getFieldDecorator("imgPath",{initialValue:s.img,rules:[{required:!0,message:"请上传照片！"}]})(q.a.createElement(O.a,m()({},this.uploadConfig(),{defaultFileList:o}),o.length>0?null:q.a.createElement(v.a,null,q.a.createElement(z.a,{type:"upload"})," 请上传照片（.jpg,.jpeg,.png）"))))),q.a.createElement(h.a,{md:12,sm:24},q.a.createElement(Z,{label:"人员类别"},t.getFieldDecorator("type",{initialValue:s.type,rules:[{required:!0,message:"请选择人员类别！"}]})(q.a.createElement(R.a.Group,null,q.a.createElement(R.a,{value:1},"管理员"),q.a.createElement(R.a,{value:2},"驾驶员")))),q.a.createElement(Z,{label:"学历（驾驶员可不填）"},t.getFieldDecorator("education",{initialValue:s.education,rules:[{message:"请输入学历！"}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(Z,{label:"从业资格证号（管理员可不填）"},t.getFieldDecorator("practitionLicense",{initialValue:s.practitionLicense,rules:[{message:"请输入从业资格证号！"}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(Z,{label:"公司名称"},t.getFieldDecorator("companyName",{initialValue:s.companyName,rules:[{required:!0,message:"请输入公司名称！"}]})(q.a.createElement(f.a,{readOnly:!0,placeholder:"请输入",onClick:function(){return e.handleFirmModalVisible(!0)}}))),q.a.createElement(Z,{label:"公司联系电话"},t.getFieldDecorator("companyTel",{initialValue:s.companyTel,rules:[{required:!0,message:"请输入公司联系电话码！"}]})(q.a.createElement(f.a,{placeholder:"请输入"}))),q.a.createElement(Z,{label:"状态"},t.getFieldDecorator("status",{initialValue:s.status,rules:[{required:!0,message:"请选择状态！"}]})(q.a.createElement(R.a.Group,null,Q.map(function(e,a){return q.a.createElement(R.a,{value:a+1,key:a},e)})))))))),i?q.a.createElement(H.a,{modalVisible:i,setSelectData:this.setSelectData,handleModalVisible:this.handleFirmModalVisible}):null)}}],[{key:"getDerivedStateFromProps",value:function(e,a){var t=e.detail,l=a.isSet;if(!l){var r=t.companyId,n=t.img;return{isSet:!l,detail:t,companyId:r,fileList:n?[{uid:"-1",name:"当前图片",status:"done",url:/http/.test(n)?n:I.B+n}]:[]}}return null}}]),a}(x.PureComponent),o.defaultProps={detail:{},modalVisible:!1,handleModalVisible:function(){}},i=s))||i)||i,Y=t("ytuB"),$=t("ns75"),ee=t.n($),ae=t("9zHi"),te=t.n(ae),le=t("15hv"),re=t.n(le),ne=T.a.Item,ie=P.a.Option,oe=["待审核","审核通过","驳回"],se=Object(A.connect)(function(e){return{TransportArchivesPersonnel:e.TransportArchivesPersonnel,loading:e.loading.models.TransportArchivesPersonnel}})(c=T.a.create()(c=function(e){function a(){var e,t;k()(this,a);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return(t=M()(this,(e=w()(a)).call.apply(e,[this].concat(r)))).state={exportVisible:!1,modalVisible:!1,updateModalVisible:!1,selectedRows:[],formValues:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"照片",dataIndex:"img",width:110,render:function(e){var a=/http/.test(e)?e:I.B+e;return q.a.createElement("img",{style:{width:90},src:a,alt:"照片",onError:function(e){e.target.onerror=null,e.target.src=re.a}})}},{title:"姓名",dataIndex:"userName"},{title:"联系方式",dataIndex:"tel",width:120},{title:"身份证",dataIndex:"idcard",width:180},{title:"性别",dataIndex:"sex",width:60,render:function(e){return 1===e?"男":"女"}},{title:"所属公司",dataIndex:"companyName"},{title:"公司联系电话",dataIndex:"companyTel",width:130},{title:"状态",dataIndex:"status",width:90,render:function(e){return oe[e-1]}},{title:"操作",width:100,render:function(e,a){return q.a.createElement(x.Fragment,null,q.a.createElement(y.a,{placement:"left",title:"编辑"},q.a.createElement(v.a,{onClick:function(){return t.showDetailModal(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),q.a.createElement(b.a,{type:"vertical"}),q.a.createElement(E.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},q.a.createElement(y.a,{placement:"left",title:"删除"},q.a.createElement(v.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.getList=function(e){(0,t.props.dispatch)({type:"TransportArchivesPersonnel/fetch",payload:e})},t.showDetailModal=function(e){return t.setState({detail:e},function(){return t.handleUpdateModalVisible(!0)})},t.dataDel=function(e){(0,t.props.dispatch)({type:"TransportArchivesPersonnel/remove",payload:e,callback:function(){var e=t.state.pageBean;g.a.success("删除成功"),t.getList({pageBean:e})}})},t.handleStandardTableChange=function(e){var a=t.state.formValues,l={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:a};t.getList(l)},t.handleFormReset=function(){var e=t.props.form,a=t.state.pageBean;e.resetFields(),t.setState({formValues:[],selectedRows:[]}),t.getList({pageBean:a})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.handleSearch=function(e){e.preventDefault();var a=t.props.form,l=t.state.pageBean;a.validateFields(function(e,a){if(!e){var r={userName:a.name,companyName:a.comName,tel:a.contact,idcard:a.card,status:a.state},n=Object.keys(r).map(function(e){return r[e]?{property:e,value:r[e],group:"main",operation:"status"===e?"EQUAL":"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:n}),t.getList({pageBean:l,querys:n})}})},t.handleExportVisible=function(e){t.setState({exportVisible:!!e})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{}})},t.modalCallback=function(){var e=t.state.pageBean;t.getList({pageBean:e})},t}return N()(a,e),C()(a,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return q.a.createElement(T.a,{onSubmit:this.handleSearch,layout:"inline"},q.a.createElement(p.a,{gutter:16},q.a.createElement(h.a,{md:4,sm:24},q.a.createElement(ne,null,e("name")(q.a.createElement(f.a,{addonBefore:"姓名",placeholder:"请输入"})))),q.a.createElement(h.a,{md:4,sm:24},q.a.createElement(ne,null,e("contact")(q.a.createElement(f.a,{addonBefore:"联系方式",placeholder:"请输入"})))),q.a.createElement(h.a,{md:4,sm:24},q.a.createElement(ne,null,e("card")(q.a.createElement(f.a,{addonBefore:"身份证",placeholder:"请输入"})))),q.a.createElement(h.a,{md:4,sm:24},q.a.createElement(ne,null,e("comName")(q.a.createElement(f.a,{addonBefore:"公司名称",placeholder:"请输入"})))),q.a.createElement(h.a,{md:4,sm:24},q.a.createElement("div",{className:ee.a.inputMain},q.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"状态"),q.a.createElement(ne,{style:{flex:1,flexShrink:0}},e("state")(q.a.createElement(P.a,{placeholder:"请选择",style:{width:"100%"},dropdownMatchSelectWidth:!1},oe.map(function(e,a){return q.a.createElement(ie,{value:a+1,key:a},e)})))))),q.a.createElement(h.a,{md:4,sm:24},q.a.createElement("span",{className:te.a.submitButtons},q.a.createElement(v.a,{type:"primary",htmlType:"submit"},"查询"),q.a.createElement(v.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.TransportArchivesPersonnel.data,l=a.loading,r=this.state,n=r.selectedRows,i=r.modalVisible,o=r.exportVisible,s=r.updateModalVisible,c=r.detail,d={modalCallback:this.modalCallback,handleModalVisible:this.handleModalVisible},p={detail:c,modalCallback:this.modalCallback,handleModalVisible:this.handleUpdateModalVisible};return q.a.createElement(x.Fragment,null,q.a.createElement(u.a,{bordered:!1},q.a.createElement("div",{className:te.a.tableList},q.a.createElement("div",{className:te.a.tableListForm},this.renderSimpleForm()),q.a.createElement("div",{className:te.a.tableListOperator},q.a.createElement(v.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"),q.a.createElement(v.a,{className:ee.a.import,icon:"export",onClick:function(){return e.handleExportVisible(!0)}},"导入"),n.length>0&&q.a.createElement(v.a,null,"批量操作")),q.a.createElement(B.a,{rowKey:"id_",size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:l,data:t,columns:this.columns,onChange:this.handleStandardTableChange}))),q.a.createElement(X,m()({},d,{modalVisible:i})),s&&Object.keys(c).length?q.a.createElement(_,m()({},p,{modalVisible:s})):null,o&&q.a.createElement(Y.a,{modalVisible:o,path:"/transport/api/tsAdmin/companyPerson/importCompanyPerson",modalCallback:this.modalCallback,handleModalVisible:this.handleExportVisible}))}}]),a}(x.PureComponent))||c)||c;a.default=se}}]);