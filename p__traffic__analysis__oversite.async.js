(window.webpackJsonp=window.webpackJsonp||[]).push([[116],{TQhm:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r=a("bx4M"),i=(a("/zsF"),a("PArb")),c=(a("+L6B"),a("2/Rp")),l=(a("14J3"),a("BMrR")),s=(a("nRaC"),a("5RzL")),o=(a("jCWc"),a("kPKH")),u=(a("iQDF"),a("+eQT")),d=(a("miYZ"),a("tsqr")),m=a("MVZn"),p=a.n(m),x=a("o0o1"),f=a.n(x),h=a("yXPU"),v=a.n(h),E=a("lwsE"),b=a.n(E),y=a("W8MJ"),g=a.n(y),k=a("a1gu"),w=a.n(k),T=a("Nsbk"),I=a.n(T),N=a("7W2i"),j=a.n(N),O=(a("OaEy"),a("2fM7")),S=(a("y8nQ"),a("Vl3Y")),M=a("q1tI"),_=a.n(M),D=a("MuoO"),Y=a("wd/R"),H=a.n(Y),L=a("ruv0"),C=(a("T2oS"),a("W9HT")),F=a("J4zp"),z=a.n(F),R=a("zT9C"),A=a.n(R),P=a("m0dn"),W=a("+n12"),G={color:["#7CB5EC","#42414A","#94EF84","#F7A25A","#8486EF"],title:{text:"",subtext:"",left:"center"},tooltip:{trigger:"axis"},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{}}},legend:{top:"bottom",data:[]},grid:{left:"3%",right:"4%",bottom:30,containLabel:!0},xAxis:{type:"category",axisLabel:{rotate:45},data:[]},yAxis:{type:"value",name:"数量(辆)"},series:[]},K=function(e){var t=e.params,a=Object(M.useState)({}),n=z()(a,2),i=n[0],c=n[1],l=Object(M.useState)({}),s=z()(l,2),o=s[0],u=s[1],d=Object(M.useState)({}),m=z()(d,2),p=m[0],x=m[1],h=Object(M.useState)(!1),E=z()(h,2),b=E[0],y=E[1],g=function(e){var a=A()(G),n=e.map(function(e){return e.siteName});a.title.text="车流量分析统计",a.xAxis.data=n,a.legend.data=["车流量"];var r=[{name:"车流量",type:t.chartType,barMaxWidth:20,data:e.map(function(e){return e.total})}];a.series=r,c(a)},k=function(e){var a=A()(G),n=["超限超载","超速"];a.legend.data=n,a.title.text="违章车辆统计";var r=e.map(function(e){return e.siteName});a.xAxis.data=r;var i=["overLoadTotal","overSpeedTotal"].map(function(a,r){return{name:n[r],type:t.chartType,barMaxWidth:20,data:e.map(function(e){return e[a]})}});a.series=i,u(a)},w=function(e){var a=A()(G),n=["二轴","三轴","四轴","五轴","六轴","其他"];a.legend.data=n,a.title.text="车辆轴数统计";var r=e.map(function(e){return e.siteName});a.xAxis.data=r;var i=["2轴","3轴","4轴","5轴","6轴","其他"].map(function(a,r){return{name:n[r],type:t.chartType,barMaxWidth:20,data:e.map(function(e){return e.axle[a]})}});a.series=i,x(a)},T=(I=v()(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.prev=1,e.next=4,Object(L.a)(t);case 4:a=e.sent,200===Object(W.u)(a)&&(n=a.data,g(n),k(n),w(n)),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:y(!1);case 12:case"end":return e.stop()}},e,null,[[1,9]])})),function(e){return I.apply(this,arguments)});var I;return Object(M.useEffect)(function(){T(t)},[t]),_.a.createElement(r.a,{bordered:!1},_.a.createElement(r.a.Grid,{style:{width:"100%"}},_.a.createElement(C.a,{spinning:b},_.a.createElement("div",{style:{height:500}},_.a.createElement(P.a,{option:i})))),_.a.createElement(r.a.Grid,{style:{width:"50%"}},_.a.createElement(C.a,{spinning:b},_.a.createElement("div",{style:{height:500}},_.a.createElement(P.a,{option:o})))),_.a.createElement(r.a.Grid,{style:{width:"50%"}},_.a.createElement(C.a,{spinning:b},_.a.createElement("div",{style:{height:500}},_.a.createElement(P.a,{option:p})))))},J=a("RIqP"),B=a.n(J),Q=a("CkN6"),V=a("9zHi"),q=a.n(V),Z=function(e){var t=e.params,a=Object(M.useState)(!1),n=z()(a,2),r=n[0],i=n[1],c=Object(M.useState)({list:[],pagination:{}}),l=z()(c,2),s=l[0],o=l[1],u=Object(M.useMemo)(function(){return[{title:"检测站点",dataIndex:"siteName"},{title:"车流量合计",dataIndex:"total"},{title:"违章情况",children:[{title:"超限超载",dataIndex:"overLoadTotal"},{title:"超速",dataIndex:"overSpeedTotal"}]},{title:"车辆类型",children:[{title:"私家车",dataIndex:"trucks_1"},{title:"客货车",dataIndex:"trucks_2"},{title:"其他",dataIndex:"trucks_3"}]},{title:"车轴",children:[{title:"二轴",dataIndex:"axle_2"},{title:"三轴",dataIndex:"axle_3"},{title:"四轴",dataIndex:"axle_4"},{title:"五轴",dataIndex:"axle_5"},{title:"六轴",dataIndex:"axle_6"},{title:"其他",dataIndex:"axle_1"}]}]},[]),d=function(e){return e.map(function(e){return p()({},e,{trucks_1:e.trucks["私家车"],trucks_2:e.trucks["客货车"],trucks_3:e.trucks["其他"],axle_1:e.axle["其他"],axle_2:e.axle["2轴"],axle_3:e.axle["3轴"],axle_4:e.axle["4轴"],axle_5:e.axle["5轴"],axle_6:e.axle["6轴"]})})},m=function(e){var t={id:-1,siteName:"合计"};return["total","overLoadTotal","overSpeedTotal","trucks_1","trucks_2","trucks_3","axle_2","axle_3","axle_4","axle_5","axle_6","axle_1"].forEach(function(a){var n=0;e.forEach(function(e){n+=parseInt(e[a],10)}),t[a]=n}),t},x=(h=v()(f.a.mark(function e(t){var a,n,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.prev=1,e.next=4,Object(L.a)(t);case 4:a=e.sent,200===Object(W.u)(a)&&(n=d(a.data),r=m(n),o({list:[r].concat(B()(n)),pagination:{pageSize:24}})),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:i(!1);case 12:case"end":return e.stop()}},e,null,[[1,9]])})),function(e){return h.apply(this,arguments)});var h;return Object(M.useEffect)(function(){x(t)},[t]),_.a.createElement("div",{className:q.a.tableList},_.a.createElement(Q.a,{tableAlert:!1,selectedRows:0,loading:r,rowSelection:null,data:s,size:"middle",columns:u}))},U={pageNo:1,pageSize:10},X=function(e){var t=e.params,a=Object(M.useState)({list:[],pagination:{}}),n=z()(a,2),r=n[0],i=n[1],c=Object(M.useState)(!1),l=z()(c,2),s=l[0],o=l[1],u=Object(M.useMemo)(function(){return[{title:"站点名称",dataIndex:"siteName"},{title:"监测时间",dataIndex:"previewTime",width:160,render:function(e){return H()(e).format("YYYY/MM/DD HH:mm:ss")}},{title:"车道号",dataIndex:"laneNo"},{title:"车牌号",dataIndex:"carNo"},{title:"轴数",dataIndex:"axleNumber"},{title:"车属地",render:function(e,t){return t.province+t.city}},{title:"车重(t)",dataIndex:"totalLoad",render:function(e){return(e/1e3).toFixed(2)}},{title:"超重(t)",dataIndex:"overLoad",render:function(e){return(e/1e3).toFixed(2)}},{title:"超限比(%)",dataIndex:"overLoadRate",render:function(e){return(100*e).toFixed(1)}},{title:"速度(km/h)",dataIndex:"speed",render:function(e){return e||0}},{title:"超速(km/h)",dataIndex:"overSpeed",render:function(e){return e||0}},{title:"超速比(%)",dataIndex:"overSpeedRate",render:function(e){return(100*e).toFixed(2)}},{title:"车长(m)",dataIndex:"length",render:function(e){return e?e/1e3:0}},{title:"车辆种类",dataIndex:"truckCode"}]},[]),d=(m=v()(f.a.mark(function e(t){var a,n,r,c,l,s;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,e.next=4,Object(L.c)(t);case 4:a=e.sent,200===Object(W.u)(a)&&(n=a.data,r=n.total,c=n.pageSize,l=n.currentPageNo,s=n.dynamicDatas,i({list:s,pagination:{total:r,pageSize:c,current:l}})),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:o(!1);case 12:case"end":return e.stop()}},e,null,[[1,9]])})),function(e){return m.apply(this,arguments)});var m;return Object(M.useEffect)(function(){d(p()({},t,U))},[t]),_.a.createElement("div",{className:q.a.tableList},_.a.createElement(Q.a,{tableAlert:!1,selectedRows:0,rowSelection:null,data:r,loading:s,size:"middle",columns:u,onChange:function(e){var a=p()({pageNo:e.current,pageSize:e.pageSize},t);d(a)}}))},$=a("ns75"),ee=a.n($),te=[{key:"chart",tab:"统计图表"},{key:"reportForm",tab:"统计报表"},{key:"DataDetails",tab:"数据明细"}],ae=S.a.Item,ne=O.a.Option,re=function e(t){return t.map(function(t){return{title:t.id?t.city:t.province,value:t.code,key:t.code,children:t.childes?e(t.childes):[]}})},ie=Object(D.connect)(function(e){return{system:e.system}})(n=S.a.create()(n=function(e){function t(){var e,a;b()(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=w()(this,(e=I()(t)).call.apply(e,[this].concat(r)))).state={activeTabKey:"chart",carTree:[],siteList:[],params:{startTime:"".concat(H()().format("YYYY-MM-DD"),"T00:00:00"),endTime:H()().format("YYYY-MM-DDTHH:mm:ss"),chartType:"line"}},a.getCarCities=v()(f.a.mark(function e(){var t;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(L.e)();case 3:t=e.sent,200===Object(W.u)(t)&&a.setState({carTree:re(t.data)}),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}},e,null,[[0,8]])})),a.contentList=function(){var e=a.state.params;return{chart:_.a.createElement(K,{params:e}),reportForm:_.a.createElement(Z,{params:e}),DataDetails:_.a.createElement(X,{params:e})}},a.handleSearch=function(){a.props.form.validateFields(function(e,t){if(!e){var n=t.time?{startTime:H()(t.time[0]).format("YYYY-MM-DDTHH:mm:ss"),endTime:H()(t.time[1]).format("YYYY-MM-DDTHH:mm:ss")}:{},r=p()({},t,n);delete r.time,a.setState({params:r})}})},a.reportFormExport=v()(f.a.mark(function e(){var t,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.params,e.prev=1,e.next=4,Object(L.f)(t,2);case 4:n=e.sent,"application/json"!==Object(W.u)(n).type?Object(W.o)(n,"统计总体情况分析-站点-统计报表.xlsx"):d.a.error("下载失败"),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}},e,null,[[1,9]])})),a.dataDetailsExport=v()(f.a.mark(function e(){var t,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.params,e.prev=1,e.next=4,Object(L.d)(t);case 4:n=e.sent,"application/json"!==Object(W.u)(n).type?Object(W.o)(n,"统计总体情况分析-站点-数据明细.xlsx"):d.a.error("下载失败"),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}},e,null,[[1,9]])})),a.importClick=function(){var e=a.state.activeTabKey;"reportForm"===e&&a.reportFormExport(),"DataDetails"===e&&a.dataDetailsExport()},a}return j()(t,e),g()(t,[{key:"componentDidMount",value:function(){this.getCarCities()}},{key:"render",value:function(){var e=this,t=this.state,a=t.activeTabKey,n=t.carTree,d=this.props.form.getFieldDecorator;return _.a.createElement(r.a,{bordered:!1},_.a.createElement("div",{className:q.a.tableListForm},_.a.createElement(S.a,{onSubmit:this.handleSearch,layout:"inline"},_.a.createElement(l.a,{gutter:16},_.a.createElement(o.a,{md:5,sm:24},_.a.createElement("div",{className:ee.a.inputMain},_.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"检测时间"),_.a.createElement(ae,{style:{flex:1}},d("time")(_.a.createElement(u.a.RangePicker,{className:ee.a.inputGroupLeftRadius,style:{width:"100%"},showTime:{defaultValue:[H()("00:00:00","HH:mm:ss"),H()(new Date,"HH:mm:ss")]},format:"YYYY-MM-DD HH:mm:ss"}))))),_.a.createElement(o.a,{md:5,sm:24},_.a.createElement("div",{className:ee.a.inputMain},_.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"车辆种类"),_.a.createElement(ae,{style:{flex:1}},d("truckType")(_.a.createElement(O.a,{style:{width:"100%"},placeholder:"请选择"},_.a.createElement(ne,{value:1},"客货车"),_.a.createElement(ne,{value:2},"小汽车"),_.a.createElement(ne,{value:3},"其他")))))),_.a.createElement(o.a,{md:5,sm:24},_.a.createElement("div",{className:ee.a.inputMain},_.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"车属地"),_.a.createElement(ae,{style:{flex:1}},d("carTerritory")(_.a.createElement(s.a,{className:ee.a.inputGroupLeftRadius,treeData:n,style:{width:"100%"},placeholder:"请选择",onChange:this.treeSelectChange}))))),_.a.createElement(o.a,{md:5,sm:24},_.a.createElement("div",{className:ee.a.inputMain},_.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"轴数"),_.a.createElement(ae,{style:{flex:1}},d("axleNumber")(_.a.createElement(O.a,{style:{width:"100%"},placeholder:"请选择"},_.a.createElement(ne,{value:2},"2"),_.a.createElement(ne,{value:3},"3"),_.a.createElement(ne,{value:4},"4"),_.a.createElement(ne,{value:5},"5"),_.a.createElement(ne,{value:6},"6")))))),"chart"===a&&_.a.createElement(o.a,{md:4,sm:24},_.a.createElement("div",{className:ee.a.inputMain},_.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"显示方式"),_.a.createElement(ae,{style:{flex:1}},d("chartType",{initialValue:"line"})(_.a.createElement(O.a,{className:ee.a.inputGroupLeftRadius,placeholder:"请选择"},_.a.createElement(ne,{value:"line"},"曲线图"),_.a.createElement(ne,{value:"bar"},"柱状图"))))))),_.a.createElement("div",{style:{float:"right",marginBottom:24}},_.a.createElement(c.a,{type:"primary",htmlType:"submit"},"查询"),"chart"!==a&&_.a.createElement(c.a,{className:ee.a.import,icon:"import",onClick:this.importClick,style:{marginLeft:8}},"导出")))),_.a.createElement(i.a,{style:{margin:0}}),_.a.createElement(r.a,{bordered:!1,tabList:te,activeTabKey:a,onTabChange:function(t){return e.setState({activeTabKey:t})},bodyStyle:{padding:"24px 0 0"}},this.contentList()[a]))}}]),t}(M.PureComponent))||n)||n;t.default=ie}}]);