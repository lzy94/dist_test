(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{"3s/D":function(e,t,a){"use strict";a.r(t);a("DjyN");var n,o=a("NUBc"),r=(a("T2oS"),a("W9HT")),i=(a("5NDa"),a("5rEg")),l=a("pVnL"),s=a.n(l),c=(a("R9oj"),a("ECub")),d=(a("miYZ"),a("tsqr")),p=a("RIqP"),u=a.n(p),v=a("lwsE"),g=a.n(v),m=a("W8MJ"),f=a.n(m),y=a("a1gu"),h=a.n(y),E=a("Nsbk"),L=a.n(E),N=a("7W2i"),C=a.n(N),x=(a("y8nQ"),a("Vl3Y")),b=a("q1tI"),k=a.n(b),S=a("MuoO"),I=a("lTPH"),T=a("zOGa"),V=a("s9xL"),w=a.n(V),M=a("PCvj"),O=a.n(M),P=a("rtK1"),j=a.n(P),F=a("d5bk"),B=a.n(F),q=[[],[]],D=Object(S.connect)(function(e){return{Live:e.Live,ConserveMonitor:e.ConserveMonitor,loading:e.loading.models.ConserveMonitor}})(n=x.a.create()(n=function(e){function t(e){var a;return g()(this,t),(a=h()(this,L()(t).call(this,e))).state={index:-1,fullIndex:0,liveVideoList:[],formValue:[],defaultQuery:{},pageBean:{page:1,pageSize:15,showTotal:!0}},a.clearAutoTouch=function(){a.autoTouch&&clearInterval(a.autoTouch)},a.getNewPlanObject=function(){var e=Object(I.o)(),t=[e[1],e[0]],a=t[0],n=t[1];return a.indexOf("路政")>-1&&a.splice(a.indexOf("路政"),1),n.indexOf(-1)>-1&&n.splice(n.indexOf(-1),1),[n,a]},a.getList=function(e){(0,a.props.dispatch)({type:"ConserveMonitor/fetch",payload:e})},a.getVideoUrl=function(e,t){(0,a.props.dispatch)({type:"Live/GBSPath",payload:{serial:e},callback:function(n){a.setLiveVideo(n,t,e)}})},a.getTouch=function(e){(0,a.props.dispatch)({type:"Live/touch",payload:{serial:e}})},a.autoTouchFun=function(){a.autoTouch=setInterval(function(){for(var e=0;e<a.serialList.length;e+=1)a.getTouch(a.serialList[e])},12e3)},a.setLiveVideo=function(e,t,n){var o=a.state,r=o.liveVideoList,i=o.index,l=o.fullIndex;if(a.clearAutoTouch(),-1===i)r.length<a.fullNumber[l]?(a.serialList.push(n),a.setState({liveVideoList:[].concat(u()(r),[{title:t,node:k.a.createElement(T.a,{src:e})}])},function(){return a.autoTouchFun()})):d.a.error("没有播放位置");else{var s=Object.assign([],r);s[i]&&delete s[i],a.serialList[i]&&delete a.serialList[i],a.setState({liveVideoList:s},function(){var o=Object.assign([],a.state.liveVideoList);a.serialList[i]=n,o[i]={title:t,node:k.a.createElement(T.a,{src:e})},a.setState({liveVideoList:o,index:-1},function(){return a.autoTouchFun()})})}},a.paginationChange=function(e,t){var n=a.state,o=n.formValue,r=n.defaultQuery;a.getList({pageBean:{page:e,pageSize:t,showTotal:!0},querys:[].concat(u()(o),[r])})},a.search=function(e){var t=a.state,n=t.pageBean,o=t.defaultQuery,r=[{property:"pointName",value:e,group:"main",operation:"LIKE",relation:"AND"}].filter(function(e){return e.value});a.setState({formValue:r}),a.getList({pageBean:n,querys:[].concat(u()(r),[o])})},a.itemClick=function(e){var t=e.serial,n=e.pointName;a.getVideoUrl(t,n)},a.renderList=function(){var e=a.props.ConserveMonitor.data;return e.list.length?e.list.map(function(e){var t=e.cameraStatus?{className:w.a.nomal,onClick:function(){return a.itemClick(e)}}:{className:w.a.disable};return k.a.createElement("li",s()({key:e.id_},t),e.pointName,k.a.createElement("span",null))}):k.a.createElement(c.a,{image:c.a.PRESENTED_IMAGE_SIMPLE})},a.renderLive=function(){for(var e=a.state,t=e.liveVideoList,n=e.index,o=e.fullIndex,r=[],i=function(e){r.push(k.a.createElement("div",{key:e,className:"".concat(w.a.videoCell," ").concat(0===o?w.a.videoCell:1===o?w.a.nine:w.a.sixteen)},k.a.createElement("div",{className:"".concat(w.a.video," ").concat(n===e?w.a.selectCell:null)},k.a.createElement("div",{className:w.a.mask,onClick:function(){return a.getIndex(e)}},k.a.createElement("div",{className:w.a.title},t[e]?t[e].title:null)),t[e]?t[e].node:null)))},l=0;l<a.fullNumber[o];l+=1)i(l);return r},a.getIndex=function(e){a.setState({index:e})},a.handleFullScreen=function(){var e=document.documentElement;a.fullscreen?document.webkitCancelFullScreen():e.webkitRequestFullScreen(),a.fullscreen=!a.fullscreen},a.getFullIndex=function(e){var t=a.state.liveVideoList,n=u()(t);t.length>a.fullNumber[e]&&(n=n.slice(0,e)),a.setState({fullIndex:e,liveVideoList:n})},q=a.getNewPlanObject(),a.autoTouch=null,a.serialList=[],a.fullNumber=[4,9,16],a}return C()(t,e),f()(t,[{key:"componentDidMount",value:function(){var e=this.state.pageBean,t={property:"ponitObj",value:q[0],group:"main",operation:"IN",relation:"AND"};this.getList({pageBean:e,querys:[t]}),this.setState({defaultQuery:t})}},{key:"componentWillUnmount",value:function(){this.clearAutoTouch()}},{key:"render",value:function(){var e=this,t=this.props,a=t.loading,n=t.ConserveMonitor.data;return k.a.createElement("div",{className:w.a.videoPage},k.a.createElement("div",{className:w.a.left},k.a.createElement("div",{className:w.a.search},k.a.createElement(i.a.Search,{placeholder:"请输入路段名称",onSearch:this.search,style:{width:"100%"}})),k.a.createElement("div",{className:w.a.listMain},k.a.createElement(r.a,{spinning:a},k.a.createElement("ul",{className:w.a.list},this.renderList()))),k.a.createElement("div",{className:w.a.pagination},k.a.createElement(o.a,{size:"small",simple:!0,total:n.pagination.total,pageSize:15,onChange:this.paginationChange}))),k.a.createElement("div",{className:w.a.right},k.a.createElement("div",{className:w.a.header},"分屏：",k.a.createElement("div",{className:w.a.tool},k.a.createElement("img",{width:20,src:j.a,alt:"",onClick:function(){return e.getFullIndex(0)}}),k.a.createElement("img",{width:20,src:O.a,alt:"",onClick:function(){return e.getFullIndex(1)}}),k.a.createElement("img",{width:20,src:B.a,alt:"",onClick:function(){return e.getFullIndex(2)}}))),k.a.createElement("div",{className:w.a.videoMain},this.renderLive())))}}]),t}(b.PureComponent))||n)||n;t.default=D},s9xL:function(e,t,a){e.exports={videoPage:"antd-pro-pages-conserve-roadproperty-video-style-videoPage",left:"antd-pro-pages-conserve-roadproperty-video-style-left",search:"antd-pro-pages-conserve-roadproperty-video-style-search",pagination:"antd-pro-pages-conserve-roadproperty-video-style-pagination",listMain:"antd-pro-pages-conserve-roadproperty-video-style-listMain",list:"antd-pro-pages-conserve-roadproperty-video-style-list",disable:"antd-pro-pages-conserve-roadproperty-video-style-disable",active:"antd-pro-pages-conserve-roadproperty-video-style-active",nomal:"antd-pro-pages-conserve-roadproperty-video-style-nomal",right:"antd-pro-pages-conserve-roadproperty-video-style-right",header:"antd-pro-pages-conserve-roadproperty-video-style-header",tool:"antd-pro-pages-conserve-roadproperty-video-style-tool",videoMain:"antd-pro-pages-conserve-roadproperty-video-style-videoMain",videoCell:"antd-pro-pages-conserve-roadproperty-video-style-videoCell",nine:"antd-pro-pages-conserve-roadproperty-video-style-nine",sixteen:"antd-pro-pages-conserve-roadproperty-video-style-sixteen",video:"antd-pro-pages-conserve-roadproperty-video-style-video",selectCell:"antd-pro-pages-conserve-roadproperty-video-style-selectCell",mask:"antd-pro-pages-conserve-roadproperty-video-style-mask",title:"antd-pro-pages-conserve-roadproperty-video-style-title",close:"antd-pro-pages-conserve-roadproperty-video-style-close"}}}]);