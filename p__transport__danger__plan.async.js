(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{fhYm:function(e,a,t){"use strict";t.r(a);var l,n,i,r,s,o,c=t("pVnL"),m=t.n(c),d=(t("IzEo"),t("bx4M")),u=(t("14J3"),t("BMrR")),p=(t("jCWc"),t("kPKH")),f=(t("5NDa"),t("5rEg")),h=(t("miYZ"),t("tsqr")),b=(t("2qtc"),t("kLXV")),g=(t("qVdP"),t("jsC+")),E=(t("Pwec"),t("CtXQ")),y=(t("lUTK"),t("BvKs")),V=(t("/zsF"),t("PArb")),v=(t("P2fV"),t("NJEC")),k=(t("5Dmo"),t("3S7+")),C=(t("+L6B"),t("2/Rp")),D=t("lwsE"),S=t.n(D),M=t("W8MJ"),F=t.n(M),w=t("a1gu"),N=t.n(w),T=t("Nsbk"),I=t.n(T),P=t("PJYZ"),L=t.n(P),U=t("7W2i"),B=t.n(U),x=(t("y8nQ"),t("Vl3Y")),q=t("q1tI"),z=t.n(q),O=t("MuoO"),R=t("CkN6"),j=(t("DZo9"),t("8z0m")),A=(t("giR+"),t("fyUT")),J=t("MVZn"),K=t.n(J),Y=t("+n12"),Z=t("J1lK"),H=t("njnb"),X=t("ZP6J"),W=t.n(X),_=x.a.Item,Q=Object(O.connect)(function(e){return{TransportDangerPlan:e.TransportDangerPlan,loading:e.loading.models.TransportDangerPlan}})(l=x.a.create()((i=n=function(e){function a(){var e,t;S()(this,a);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(t=N()(this,(e=I()(a)).call.apply(e,[this].concat(n)))).state={templateVisible:!1,firmMultipleVisbile:!1,tempId:"",companyId:"",fileList:[]},t.handleTemplateVisible=function(e){t.setState({templateVisible:!!e})},t.handleFirmMultipleVisbile=function(e){t.setState({firmMultipleVisbile:!!e})},t.setSelectData=function(e,a){var l=t.props.form;t.setState({tempId:e}),l.setFieldsValue({tempName:a})},t.setSelectFirm=function(e,a){var l=t.props.form;t.setState({companyId:e}),l.setFieldsValue({companyName:a})},t.handleChange=function(e){var a=e.fileList;return t.setState({fileList:a})},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",accept:".pdf,.doc,.docx,.zip",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(Y.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:Y.s,onChange:t.handleChange}},t.save=function(){var e=t.props,a=e.dispatch,l=e.form,n=e.modalCallback,i=e.handleModalVisible,r=t.state,s=r.tempId,o=r.companyId,c=r.fileList;return l.validateFields(function(e,l){if(!e){var r=K()({},l,{tempId:s,companyId:o,status:1}),m=c.map(function(e){return e.response.filePath}),d=c.map(function(e){return e.response.fileName});r.fielUrls=m.join(),r.fileName=d.join(),a({type:"TransportDangerPlan/UAData",payload:r,callback:function(){h.a.success("添加成功"),i(),t.setState({fileList:[]}),setTimeout(function(){return n()},300)}})}}),null},t.cancelClick=function(){var e=t.props.handleModalVisible;t.setState({fileList:[]}),e()},t}return B()(a,e),F()(a,[{key:"render",value:function(){var e=this,a=this.props,t=a.form,l=a.modalVisible,n=a.loading,i=this.state,r=i.fileList,s=i.templateVisible,o=i.firmMultipleVisbile;return z.a.createElement(q.Fragment,null,z.a.createElement(b.a,{destroyOnClose:!0,title:"添加专项督查",className:W.a.formModal,visible:l,width:700,onCancel:this.cancelClick,footer:[z.a.createElement(C.a,{key:"back",onClick:this.cancelClick},"取消"),z.a.createElement(C.a,{key:"submit",type:"primary",loading:n,onClick:this.save},"确定")]},z.a.createElement("div",{className:W.a.formModalBody},z.a.createElement(u.a,{gutter:20},z.a.createElement(p.a,{md:12,sm:24},z.a.createElement(_,{label:"名称"},t.getFieldDecorator("name",{rules:[{required:!0,message:"请输入名称！"}]})(z.a.createElement(f.a,{placeholder:"请输入"}))),z.a.createElement(_,{label:"模板"},t.getFieldDecorator("tempName",{rules:[{required:!0,message:"请选择模板！"}]})(z.a.createElement(f.a,{readOnly:!0,placeholder:"请选择",onClick:function(){return e.handleTemplateVisible(!0)}})))),z.a.createElement(p.a,{md:12,sm:24},z.a.createElement(_,{label:"标题"},t.getFieldDecorator("title",{rules:[{required:!0,message:"请输入标题！"}]})(z.a.createElement(f.a,{placeholder:"请输入"}))),z.a.createElement(_,{label:"期限天数"},t.getFieldDecorator("term",{rules:[{required:!0,message:"请输入期限天数！"}]})(z.a.createElement(A.a,{style:{width:"100%"},placeholder:"请输入"})))),z.a.createElement(p.a,{md:24,sm:24},z.a.createElement(_,{label:"督查对象"},t.getFieldDecorator("companyName",{rules:[{required:!0,message:"请选择督查对象！"}]})(z.a.createElement(f.a.TextArea,{readOnly:!0,placeholder:"请选择",onClick:function(){return e.handleFirmMultipleVisbile(!0)}})))),z.a.createElement(p.a,{md:24,sm:24},z.a.createElement(_,{label:"情况说明概要"},t.getFieldDecorator("desc",{rules:[{required:!0,message:"请输入情况说明概要！"}]})(z.a.createElement(f.a.TextArea,{placeholder:"请输入"})))),z.a.createElement(p.a,{md:24,sm:24},z.a.createElement(_,{label:"附件"},t.getFieldDecorator("fielUrls",{})(z.a.createElement(j.a,m()({},this.uploadConfig(),{fileList:r}),r.length>0?null:z.a.createElement(C.a,null,z.a.createElement(E.a,{type:"upload"})," 选择附件！(pdf , doc, docx, zip)")))))))),s&&z.a.createElement(Z.a,{setSelectData:this.setSelectData,handleModalVisible:this.handleTemplateVisible,modalVisible:s}),o&&z.a.createElement(H.a,{setSelectData:this.setSelectFirm,handleModalVisible:this.handleFirmMultipleVisbile,modalVisible:o}))}}]),a}(q.PureComponent),n.defaultProps={modalVisible:!1,handleModalVisible:function(){}},l=i))||l)||l,G=t("y01j"),$=x.a.Item,ee=Object(O.connect)(function(e){return{TransportDangerPlan:e.TransportDangerPlan,loading:e.loading.models.TransportDangerPlan}})(r=x.a.create()((o=s=function(e){function a(){var e,t;S()(this,a);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(t=N()(this,(e=I()(a)).call.apply(e,[this].concat(n)))).state={templateVisible:!1,firmMultipleVisbile:!1,tempId:"",companyId:"",fileList:[],fileName:"",detail:{}},t.handleTemplateVisible=function(e){t.setState({templateVisible:!!e})},t.handleFirmMultipleVisbile=function(e){t.setState({firmMultipleVisbile:!!e})},t.setSelectData=function(e,a){var l=t.props.form;t.setState({tempId:e}),l.setFieldsValue({tempName:a})},t.setSelectFirm=function(e){var a=t.props.form;t.setState({companyId:e.id_}),a.setFieldsValue({companyName:e.companyName})},t.handleChange=function(e){var a=e.fileList;return t.setState({fileList:a})},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",accept:".pdf,.doc,.docx,.zip",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(Y.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:Y.s,onChange:t.handleChange}},t.save=function(){var e=t.props,a=e.dispatch,l=e.form,n=e.modalCallback,i=e.handleModalVisible,r=t.state,s=r.tempId,o=r.companyId,c=r.detail,m=r.fileName;return l.validateFields(function(e,l){if(!e){var r=K()({},l,{tempId:s,companyId:o,fileName:m});if("object"==typeof r.fielUrls){var d=r.fielUrls.fileList.map(function(e){return e.response.filePath}),u=r.fielUrls.fileList.map(function(e){return e.response.fileName});r.fielUrls=d.join(),r.fileName=u.join()}for(var p=JSON.parse(JSON.stringify(c)),f=Object.keys(r),b=0;b<f.length;b+=1)p[f[b]]=r[f[b]];t.setState({detail:p}),a({type:"TransportDangerPlan/UAData",payload:p,callback:function(){h.a.success("编辑成功"),i(),setTimeout(function(){return n()},300)}})}}),null},t.cancelClick=function(){var e=t.props.handleModalVisible;t.setState({fileList:[]}),e()},t}return B()(a,e),F()(a,[{key:"render",value:function(){var e=this,a=this.props,t=a.form,l=a.modalVisible,n=a.loading,i=this.state,r=i.fileList,s=i.templateVisible,o=i.firmMultipleVisbile,c=i.detail;return z.a.createElement(q.Fragment,null,z.a.createElement(b.a,{destroyOnClose:!0,title:"编辑专项督查",className:W.a.formModal,visible:l,width:700,onCancel:this.cancelClick,footer:[z.a.createElement(C.a,{key:"back",onClick:this.cancelClick},"取消"),z.a.createElement(C.a,{key:"submit",type:"primary",loading:n,onClick:this.save},"确定")]},z.a.createElement("div",{className:W.a.formModalBody},z.a.createElement(u.a,{gutter:20},z.a.createElement(p.a,{md:12,sm:24},z.a.createElement($,{label:"名称"},t.getFieldDecorator("name",{initialValue:c.name,rules:[{required:!0,message:"请输入名称！"}]})(z.a.createElement(f.a,{placeholder:"请输入"}))),z.a.createElement($,{label:"模板"},t.getFieldDecorator("tempName",{initialValue:c.tempName,rules:[{required:!0,message:"请选择模板！"}]})(z.a.createElement(f.a,{readOnly:!0,placeholder:"请选择",onClick:function(){return e.handleTemplateVisible(!0)}})))),z.a.createElement(p.a,{md:12,sm:24},z.a.createElement($,{label:"标题"},t.getFieldDecorator("title",{initialValue:c.title,rules:[{required:!0,message:"请输入标题！"}]})(z.a.createElement(f.a,{placeholder:"请输入"}))),z.a.createElement($,{label:"期限天数"},t.getFieldDecorator("term",{initialValue:c.term,rules:[{required:!0,message:"请输入期限天数！"}]})(z.a.createElement(A.a,{style:{width:"100%"},placeholder:"请输入"})))),z.a.createElement(p.a,{md:24,sm:24},z.a.createElement($,{label:"督查对象"},t.getFieldDecorator("companyName",{initialValue:c.companyName,rules:[{required:!0,message:"请选择督查对象！"}]})(z.a.createElement(f.a.TextArea,{readOnly:!0,placeholder:"请选择",onClick:function(){return e.handleFirmMultipleVisbile(!0)}})))),z.a.createElement(p.a,{md:24,sm:24},z.a.createElement($,{label:"情况说明概要"},t.getFieldDecorator("desc",{initialValue:c.desc,rules:[{required:!0,message:"请输入情况说明概要！"}]})(z.a.createElement(f.a.TextArea,{placeholder:"请输入"})))),z.a.createElement(p.a,{md:24,sm:24},z.a.createElement($,{label:"附件"},t.getFieldDecorator("fielUrls",{initialValue:c.fielUrls})(z.a.createElement(j.a,m()({},this.uploadConfig(),{fileList:r}),r.length>0?null:z.a.createElement(C.a,null,z.a.createElement(E.a,{type:"upload"})," 选择附件！(pdf , doc, docx, zip)")))))))),s&&z.a.createElement(Z.a,{setSelectData:this.setSelectData,handleModalVisible:this.handleTemplateVisible,modalVisible:s}),o&&z.a.createElement(G.a,{setSelectData:this.setSelectFirm,handleModalVisible:this.handleFirmMultipleVisbile,modalVisible:o}))}}],[{key:"getDerivedStateFromProps",value:function(e,a){var t=e.detail,l=a.isSet,n=t.fileName?t.fileName.split(","):[],i=t.fielUrls?t.fielUrls.split(",").map(function(e,a){return{uid:a,name:n[a],status:"done",url:"".concat(Y.t).concat(e),path:e}}):[];return l?null:{detail:t,tempId:t.tempId,companyId:t.companyId,fileList:i,fileName:t.fileName,isSet:!l}}}]),a}(q.PureComponent),s.defaultProps={modalVisible:!1,handleModalVisible:function(){}},r=o))||r)||r,ae=(t("g9YV"),t("wCAj")),te=(t("bP8k"),t("gFTJ")),le=function(e){function a(){var e,t;S()(this,a);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(t=N()(this,(e=I()(a)).call.apply(e,[this].concat(n)))).columns=[{title:"内容",dataIndex:"content",width:400,render:function(e){return e.length>20?z.a.createElement(k.a,{title:e},e.substring(0,20),"..."):e}},{title:"反馈内容",dataIndex:"control",render:function(e,a){return 1===e?a.superRet:z.a.createElement("a",{href:Y.t+a.superRet,download:"文件",target:"_blank"},"文件")}}],t}return B()(a,e),F()(a,[{key:"render",value:function(){var e=this.props,a=e.modalVisible,t=e.handleModalVisible,l=e.detail;return z.a.createElement(b.a,{destroyOnClose:!0,title:"专项督查详情",className:W.a.formModal,visible:a,width:700,onCancel:function(){return t()},footer:null},z.a.createElement(d.a,{bordered:!1},z.a.createElement(te.a,{size:"small",column:2,bordered:!0},z.a.createElement(te.a.Item,{label:"名称"},l.name),z.a.createElement(te.a.Item,{label:"标题"},l.title),z.a.createElement(te.a.Item,{label:"模板"},l.tempName),z.a.createElement(te.a.Item,{label:"周期天数"},l.term),z.a.createElement(te.a.Item,{label:"督查对象",span:2},l.companyName),z.a.createElement(te.a.Item,{label:"情况说明概要",span:2},l.desc),z.a.createElement(te.a.Item,{label:"附件",span:2},z.a.createElement("a",{href:"".concat(Y.t).concat(l.fielUrls),rel:"noopener noreferrer",target:"_blank",download:l.fileName},l.fileName))),z.a.createElement("h3",{style:{marginTop:20}},"反馈内容"),z.a.createElement(ae.a,{size:"small",pagination:!1,columns:this.columns,rowKey:"order",dataSource:l.superRet?JSON.parse(l.superRet):[]})))}}]),a}(q.PureComponent);le.defaultProps={detail:{},modalVisible:!1,handleModalVisible:function(){}};var ne,ie=le,re=t("9zHi"),se=t.n(re),oe=x.a.Item,ce=["待发布","已发布","待审核","审核通过","审核不通过"],me=Object(O.connect)(function(e){return{TransportDangerPlan:e.TransportDangerPlan,loading:e.loading.models.TransportDangerPlan}})(ne=x.a.create()(ne=function(e){function a(){var e,t;S()(this,a);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(t=N()(this,(e=I()(a)).call.apply(e,[this].concat(n)))).state={modalVisible:!1,detailVisible:!1,updateModalVisible:!1,selectedRows:[],formValues:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"督查名称",dataIndex:"name"},{title:"督查标题",dataIndex:"title"},{title:"督查对象",dataIndex:"companyName"},{title:"创建时间",width:170,dataIndex:"createTime"},{title:"状态",width:100,dataIndex:"status",render:function(e){return ce[e-1]}},{title:"操作",width:130,render:function(e,a){var l=null,n=z.a.createElement(k.a,{placement:"left",title:"详情"},z.a.createElement(C.a,{onClick:function(){return t.showDetailModal(a.id)},type:"primary",shape:"circle",icon:"eye",size:"small"}));if(1===a.status)l=z.a.createElement(q.Fragment,null,z.a.createElement(v.a,{title:"是否发布数据?",onConfirm:function(){return t.pushData(a.id)},okText:"确定",cancelText:"取消"},z.a.createElement(k.a,{placement:"left",title:"发布"},z.a.createElement(C.a,{shape:"circle",icon:"to-top",size:"small"}))),z.a.createElement(V.a,{type:"vertical"}),z.a.createElement(k.a,{placement:"left",title:"编辑"},z.a.createElement(C.a,{onClick:function(){return t.showUpdateModal(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),z.a.createElement(V.a,{type:"vertical"}),z.a.createElement(v.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},z.a.createElement(k.a,{placement:"left",title:"删除"},z.a.createElement(C.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))));else if(3===a.status){var i=z.a.createElement(y.b,{onClick:t.toExamine.bind(L()(t),a.id)},z.a.createElement(y.b.Item,{key:"4"},"通过"),z.a.createElement(y.b.Item,{key:"5"},"不通过"));l=z.a.createElement(q.Fragment,null,n,z.a.createElement(V.a,{type:"vertical"}),z.a.createElement(g.a,{overlay:i},z.a.createElement(C.a,{size:"small"},"审核 ",z.a.createElement(E.a,{type:"down"}))))}else l=n;return l}}],t.getList=function(e){(0,t.props.dispatch)({type:"TransportDangerPlan/fetch",payload:e})},t.toExamine=function(e,a){var l=a.key,n="4"===l?"审核通过":"审核不通过";b.a.confirm({title:"提示",content:"".concat(n,"？"),onOk:function(){return t.pushPublic(e,l,"操作成功")}})},t.pushData=function(e){t.pushPublic(e,2,"发布成功")},t.pushPublic=function(e,a,l){(0,t.props.dispatch)({type:"TransportDangerPlan/updateStatus",payload:{type:a,id:e},callback:function(){h.a.success(l,function(){var e=t.state,a=e.pageBean,l=e.formValues;t.getList({pageBean:a,querys:l})})}})},t.showUpdateModal=function(e){return t.setState({detail:e},function(){return t.handleUpdateModalVisible(!0)})},t.showDetailModal=function(e){(0,t.props.dispatch)({type:"TransportDangerPlan/detail",payload:e,callback:function(e){return t.setState({detail:e},function(){return t.handleDetailVisible(!0)})}})},t.dataDel=function(e){t.delUtil(e)},t.batchDel=function(){var e=t.state.selectedRows;e.length&&b.a.confirm({title:"提示",content:"是否删除数据？",onOk:function(){var a=e.map(function(e){return e.id});t.delUtil(a.join(),function(){t.setState({selectedRows:[]})})}})},t.delUtil=function(e,a){(0,t.props.dispatch)({type:"TransportDangerPlan/remove",payload:{ids:e},callback:function(){h.a.success("删除成功");var e=t.state.pageBean;t.getList({pageBean:e}),a&&a()}})},t.handleStandardTableChange=function(e){var a=t.state.formValues,l={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:a};t.getList(l)},t.handleFormReset=function(){var e=t.props.form,a=t.state.pageBean;e.resetFields(),t.setState({formValues:[],selectedRows:[]}),t.getList({pageBean:a})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.handleSearch=function(e){e.preventDefault();var a=t.props.form,l=t.state.pageBean;a.validateFields(function(e,a){if(!e){var n={name:a.MC,title:a.BT},i=Object.keys(n).map(function(e){return n[e]?{property:e,value:n[e],group:"main",operation:"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:i}),t.getList({pageBean:l,querys:i})}})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{}})},t.handleDetailVisible=function(e){t.setState({detailVisible:!!e}),e||t.setState({detail:{}})},t.modalCallback=function(){var e=t.state.pageBean;t.getList({pageBean:e})},t}return B()(a,e),F()(a,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return z.a.createElement(x.a,{onSubmit:this.handleSearch,layout:"inline"},z.a.createElement(u.a,{gutter:16},z.a.createElement(p.a,{md:6,sm:24},z.a.createElement(oe,null,e("MC")(z.a.createElement(f.a,{addonBefore:"名称",placeholder:"请输入"})))),z.a.createElement(p.a,{md:6,sm:24},z.a.createElement(oe,null,e("BT")(z.a.createElement(f.a,{addonBefore:"标题",placeholder:"请输入"})))),z.a.createElement(p.a,{md:4,sm:24},z.a.createElement("span",{className:se.a.submitButtons},z.a.createElement(C.a,{type:"primary",htmlType:"submit"},"查询"),z.a.createElement(C.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.TransportDangerPlan.data,l=a.loading,n=this.state,i=n.selectedRows,r=n.modalVisible,s=n.updateModalVisible,o=n.detail,c=n.detailVisible,u={modalCallback:this.modalCallback,handleModalVisible:this.handleModalVisible},p={detail:o,modalCallback:this.modalCallback,handleModalVisible:this.handleUpdateModalVisible};return z.a.createElement(q.Fragment,null,z.a.createElement(d.a,{bordered:!1},z.a.createElement("div",{className:se.a.tableList},z.a.createElement("div",{className:se.a.tableListForm},this.renderSimpleForm()),z.a.createElement("div",{className:se.a.tableListOperator},z.a.createElement(C.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"),i.length>0&&z.a.createElement(C.a,{type:"danger",onClick:this.batchDel},"批量删除")),z.a.createElement(R.a,{size:"middle",tableAlert:!0,selectedRows:i,loading:l,data:t,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),z.a.createElement(Q,m()({},u,{modalVisible:r})),s&&Object.keys(o).length&&z.a.createElement(ee,m()({},p,{modalVisible:s})),c&&Object.keys(o).length&&z.a.createElement(ie,{detail:o,modalVisible:c,handleModalVisible:this.handleDetailVisible}))}}]),a}(q.PureComponent))||ne)||ne;a.default=me}}]);