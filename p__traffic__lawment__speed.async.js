(window.webpackJsonp=window.webpackJsonp||[]).push([[157],{n1sA:function(e,t,a){"use strict";a.r(t);var n,i=a("pVnL"),r=a.n(i),l=(a("IzEo"),a("bx4M")),o=(a("14J3"),a("BMrR")),s=(a("iQDF"),a("+eQT")),d=(a("5NDa"),a("5rEg")),m=(a("jCWc"),a("kPKH")),c=(a("nRaC"),a("5RzL")),p=a("MVZn"),u=a.n(p),h=(a("5Dmo"),a("3S7+")),g=(a("+L6B"),a("2/Rp")),E=(a("+BJd"),a("mr32")),f=a("lwsE"),y=a.n(f),v=a("W8MJ"),S=a.n(v),b=a("a1gu"),w=a.n(b),N=a("Nsbk"),I=a.n(N),L=a("7W2i"),M=a.n(L),k=(a("2qtc"),a("kLXV")),D=(a("bP8k"),a("gFTJ")),C=(a("OaEy"),a("2fM7")),x=(a("y8nQ"),a("Vl3Y")),T=a("q1tI"),B=a.n(T),V=a("MuoO"),R=a("wd/R"),H=a.n(R),Y=a("mf+E"),A=a("CkN6"),F=a("+n12"),z=a("Py4S"),O=a.n(z),Q=a("9zHi"),J=a.n(Q),j=a("ns75"),G=a.n(j),q=a("ZP6J"),P=a.n(q),W=x.a.Item,U=C.a.Option,K=["/lawment/speed"],Z=x.a.create()(function(e){var t=e.handleModalVisible,a=e.modalVisible,n=e.detail;return B.a.createElement(k.a,{destroyOnClose:!0,title:"详情",className:P.a.myModal+" "+P.a.modalbody,visible:a,footer:null,onCancel:function(){return t()},width:800},B.a.createElement("div",{className:P.a.detailMsg},B.a.createElement("div",{style:{padding:20}},B.a.createElement(D.a,{bordered:!0,size:"small",column:2},B.a.createElement(D.a.Item,{label:"检测站"},n.siteName),B.a.createElement(D.a.Item,{label:"检测时间"},n.previewTime),B.a.createElement(D.a.Item,{label:"车牌号码"},n.carNo),B.a.createElement(D.a.Item,{label:"速度(km/h)"},n.speed),B.a.createElement(D.a.Item,{label:"限速(km/h)"},n.speedLimit),B.a.createElement(D.a.Item,{label:"违章类别"},n.violationName),B.a.createElement(D.a.Item,{label:"图片",span:2},["oneUrl","twoUrl","threeUrl"].map(function(e,t){return B.a.createElement("div",{key:t,style:{overflow:"hidden",width:100,height:100,marginRight:20,float:"left"}},B.a.createElement(O.a,{backdrop:"rgba(255,255,255,.3)",src:F.E+n[e],alt:"图片",style:{height:"100px"}}))}))))))}),X=Object(V.connect)(function(e){var t=e.Speed,a=e.loading,n=e.system;return{Site:e.Site,system:n,Speed:t,loading:a.models.Speed}})(n=x.a.create()(n=function(e){function t(){var e,a;y()(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=w()(this,(e=I()(t)).call.apply(e,[this].concat(i)))).state={modalVisible:!1,formValues:[],detail:{},siteList:[],organCode:"",newSiteList:[],pageBean:{page:1,pageSize:10,showTotal:!0},baseQuery:[]},a.columns=[{title:"检测站",dataIndex:"siteName"},{title:"车牌号码",dataIndex:"carNo"},{title:"检测时间",width:170,dataIndex:"previewTime",render:function(e){return H()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"速度(km/h)",dataIndex:"speed"},{title:"限速(km/h)",dataIndex:"speedLimit",render:function(e){return B.a.createElement(E.a,{color:"#87d068"},e)}},{title:"违章类别",dataIndex:"violationName"},{title:"操作",width:70,render:function(e,t){return B.a.createElement(T.Fragment,null,B.a.createElement(h.a,{placement:"left",title:"详情"},B.a.createElement(g.a,{onClick:function(){return a.showDetailModal(t.id)},type:"primary",shape:"circle",icon:"eye",size:"small"})))}}],a.showDetailModal=function(e){(0,a.props.dispatch)({type:"Speed/detail",payload:{id:e},callback:function(e){a.setState({detail:e}),a.handleModalVisible(!0)}})},a.getList=function(e){(0,a.props.dispatch)({type:"Speed/fetch",payload:u()({},e,{sorter:[{direction:"DESC",property:"previewTime"}]})})},a.getSiteIN=function(){return[{property:"siteCode",value:a.state.newSiteList.map(function(e){return e.code}),group:"main",operation:"IN",relation:"AND"}]},a.handleStandardTableChange=function(e){var t=a.state,n=t.formValues,i=t.baseQuery,r={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:i.concat(n.length?n:a.getSiteIN())};a.getList(r)},a.handleFormReset=function(){var e=a.props.form,t=a.state,n=t.pageBean,i=t.baseQuery,r=Object(F.z)("organId");e.resetFields(),a.setState({formValues:[],organCode:""}),a.getSite(r,function(){a.getList({pageBean:n,querys:i.concat(a.getSiteIN())})})},a.handleSearch=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){var n=a.state,i=n.pageBean,r=n.baseQuery,l=(n.organCode,[t.siteCode?{property:"siteCode",value:t.siteCode||"",group:"main",operation:"EQUAL",relation:"AND"}:a.getSiteIN()[0].value.length?a.getSiteIN()[0]:{},{property:"previewTime",value:t.previewTime?[H()(t.previewTime[0]).format("YYYY-MM-DD HH:mm:ss"),H()(t.previewTime[1]).format("YYYY-MM-DD HH:mm:ss")]:"",group:"main",operation:"BETWEEN",relation:"AND"},{property:"speed",value:t.speedStart&&t.speedEnd?[t.speedStart,t.speedEnd]:"",group:"main",operation:"BETWEEN",relation:"AND"},{property:"carNo",value:t.carNo||"",group:"main",operation:"LIKE",relation:"AND"},{property:"violationName",value:t.violationName||"",group:"main",operation:"LIKE",relation:"AND"}].filter(function(e){return e.value}));a.setState({formValues:l}),a.getList({pageBean:i,querys:r.concat(l)})}})},a.handleModalVisible=function(e){a.setState({modalVisible:!!e}),e||a.setState({detail:{}})},a.treeSelectChange=function(e,t){a.getSite(e),a.setState({organCode:e})},a.getSite=function(e,t){(0,a.props.dispatch)({type:"Site/siteByUserSite",payload:{organId:e,siteIds:a.state.siteList.map(function(e){return e.code})},callback:function(e){var n=e.map(function(e){return"1"===e.siteType?{code:e.siteCode,name:e.siteName}:""});a.setState({newSiteList:n}),t&&t(n)}})},a}return M()(t,e),S()(t,[{key:"componentDidMount",value:function(){var e=this;if(Object(F.c)(K[0])){var t=this.state,a=t.pageBean,n=t.baseQuery;(0,this.props.dispatch)({type:"system/userSite",payload:{siteType:1},callback:function(t){if(t.length){var i=t.map(function(e){var t=Object.keys(e);return{code:t[0],name:e[t[0]]}}),r=[{property:"siteCode",value:i.map(function(e){return e.code}),group:"main",operation:"IN",relation:"AND"}];e.setState({siteList:i,newSiteList:i}),e.getList({pageBean:a,querys:n.concat(r)})}else k.a.error({title:"提示",content:"您没有绑定站点！！！"})}})}}},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.system.treeList,a=e.form.getFieldDecorator,n=this.state.newSiteList,i=Object(F.z)("organId").toString();return B.a.createElement(x.a,{onSubmit:this.handleSearch,layout:"inline"},B.a.createElement(o.a,{gutter:16},B.a.createElement(m.a,{md:5,sm:24},B.a.createElement("div",{className:G.a.inputMain},B.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"所属机构"),B.a.createElement(W,{style:{flex:1}},a("name")(B.a.createElement(c.a,{className:G.a.inputGroupLeftRadius,treeData:t,treeDefaultExpandedKeys:[i],style:{width:"100%"},placeholder:"请选择",onChange:this.treeSelectChange}))))),B.a.createElement(m.a,{md:4,sm:24},B.a.createElement("div",{className:G.a.inputMain},B.a.createElement("span",{style:{width:"65px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"检测点"),B.a.createElement(W,{style:{flex:1}},a("siteCode")(B.a.createElement(C.a,{dropdownMatchSelectWidth:!1,className:G.a.inputGroupLeftRadius,placeholder:"请选择"},n.map(function(e,t){return B.a.createElement(U,{key:t,value:e.code},e.name)})))))),B.a.createElement(m.a,{md:5,sm:24},B.a.createElement(d.a.Group,{compact:!0},B.a.createElement(W,{style:{display:"inline-block",width:"50%"}},a("speedStart")(B.a.createElement(d.a,{className:G.a.inputGroupRightRadius+" "+G.a.inputGroupRightborder,addonBefore:"速度(km)",placeholder:"请输入",style:{width:"100%",borderRight:0}}))),B.a.createElement(W,{style:{display:"inline-block",width:"50%"}},a("speedEnd")(B.a.createElement(d.a,{className:G.a.inputGroupRadiusAddon,addonBefore:"至",placeholder:"请输入",style:{width:"100%"}}))))),B.a.createElement(m.a,{md:4,sm:24},B.a.createElement(W,null,a("carNo")(B.a.createElement(d.a,{addonBefore:"车牌号",placeholder:"请输入"})))),B.a.createElement(m.a,{md:6,sm:24},B.a.createElement("div",{className:G.a.inputMain},B.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"检测时间"),B.a.createElement(W,{style:{flex:1}},a("previewTime")(B.a.createElement(s.a.RangePicker,{className:G.a.inputGroupLeftRadius,style:{width:"100%"},showTime:{defaultValue:[H()("00:00:00","HH:mm:ss"),H()(new Date,"HH:mm:ss")]},format:"YYYY-MM-DD HH:mm:ss"})))))),B.a.createElement(o.a,{gutter:16},B.a.createElement(m.a,{md:5,sm:24},a("violationName")(B.a.createElement(d.a,{addonBefore:"违章类别",placeholder:"请输入"}))),B.a.createElement(m.a,{md:5,sm:24,style:{float:"right"}},B.a.createElement("div",{style:{overflow:"hidden"}},B.a.createElement("div",{style:{float:"right",marginBottom:24}},B.a.createElement(g.a,{type:"primary",htmlType:"submit"},"查询"),B.a.createElement(g.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置"))))))}},{key:"render",value:function(){var e=this.props,t=e.Speed.data,a=e.loading,n=this.state,i=n.modalVisible,o=n.detail,s={detail:o,handleModalVisible:this.handleModalVisible};return B.a.createElement(T.Fragment,null,Object(F.c)(K[0])?null:B.a.createElement(Y.a,{to:"/exception/403"}),B.a.createElement(l.a,{bordered:!1},B.a.createElement("div",{className:J.a.tableList},B.a.createElement("div",{className:J.a.tableListForm},this.renderSimpleForm()),B.a.createElement(A.a,{size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:a,data:t,columns:this.columns,onChange:this.handleStandardTableChange}))),i&&"{}"!==JSON.stringify(o)?B.a.createElement(Z,r()({},s,{modalVisible:i})):null)}}]),t}(T.PureComponent))||n)||n;t.default=X}}]);