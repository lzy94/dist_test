(window.webpackJsonp=window.webpackJsonp||[]).push([[212],{ebWa:function(e,t,n){"use strict";n.r(t);var a=n("MVZn"),r=n.n(a),c=n("o0o1"),u=n.n(c),o=n("7DNP"),s=n("yXPU"),i=n.n(s),p=n("t3Un"),d=n("+n12");function l(e){return f.apply(this,arguments)}function f(){return(f=i()(u.a.mark(function e(t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p.a)("/result/auth",{method:"POST",data:t}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function b(){return h.apply(this,arguments)}function h(){return(h=i()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p.a)("/result/isTokenExpired?token="+Object(d.z)("token")[0],{headers:{Authorization:"Bearer ".concat(Object(d.z)("token")[0]),"x-requested-with":"XMLHttpRequest"}}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var w=n("k9Yu");t.default={namespace:"userLogin",state:{status:void 0},effects:{login:u.a.mark(function e(t,n){var a,r,c,s,i,p,f,b,h,k;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.payload,r=t.callback,c=n.call,s=n.put,a.code.toLowerCase()===a.value.yzm.toLowerCase()){e.next=6;break}return e.next=5,s({type:"changeLoginStatus",payload:{code:20}});case 5:return e.abrupt("return");case 6:return e.next=8,c(l,a.value);case 8:return i=e.sent,Object(d.u)(i),e.next=12,s({type:"changeLoginStatus",payload:i});case 12:if(200!==i.code){e.next=37;break}return p=i.data,Object(d.M)("token",p.token),localStorage.setItem("mainMsg",JSON.stringify({department:p.department,name:p.username})),e.next=18,c(w.a);case 18:if(f=e.sent,Object(d.M)("auth",f.data.curUserMethod),b=new URL(window.location.href),h=Object(d.A)(),!(k=h.redirect)){e.next=32;break}if(new URL(k).origin!==b.origin){e.next=30;break}(k=k.substr(b.origin.length)).match(/^\/.*#/)&&(k=k.substr(k.indexOf("#")+1)),e.next=32;break;case 30:return window.location.href=k,e.abrupt("return");case 32:return e.next=34,s({type:"changeLoginStatus",payload:{code:void 0}});case 34:return r&&r(),e.next=37,s(o.routerRedux.replace(k||"/"));case 37:case"end":return e.stop()}},e)}),isToken:u.a.mark(function e(t,n){var a,r,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.payload,a=t.callback,r=n.call,n.put,e.next=4,r(b);case 4:c=e.sent,a&&a(c);case 6:case"end":return e.stop()}},e)})},reducers:{changeLoginStatus:function(e,t){var n=t.payload;return Object(d.L)("admin"),r()({},e,{status:n.code})}}}}}]);