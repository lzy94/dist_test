(window.webpackJsonp=window.webpackJsonp||[]).push([[196],{HHti:function(e,a,t){"use strict";t.r(a);var l,r,n,i,s,o,c,d,m=t("pVnL"),u=t.n(m),p=(t("IzEo"),t("bx4M")),h=(t("14J3"),t("BMrR")),f=(t("jCWc"),t("kPKH")),g=(t("5NDa"),t("5rEg")),E=(t("miYZ"),t("tsqr")),b=(t("P2fV"),t("NJEC")),y=(t("/zsF"),t("PArb")),v=(t("5Dmo"),t("3S7+")),V=(t("+L6B"),t("2/Rp")),F=t("lwsE"),S=t.n(F),k=t("W8MJ"),D=t.n(k),M=t("a1gu"),C=t.n(M),w=t("Nsbk"),N=t.n(w),T=t("7W2i"),I=t.n(T),L=(t("OaEy"),t("2fM7")),B=(t("y8nQ"),t("Vl3Y")),x=t("q1tI"),A=t.n(x),q=t("MuoO"),U=t("wd/R"),O=t.n(U),R=t("CkN6"),z=(t("2qtc"),t("kLXV")),j=t("MVZn"),H=t.n(j),P=(t("nRaC"),t("5RzL")),K=t("+n12"),J=t("ns75"),Y=t.n(J),_=t("ZP6J"),X=t.n(_),G=t("9zHi"),Q=t.n(G),W=B.a.Item,Z=[[],[]],$=Object(q.connect)(function(e){var a=e.system,t=e.systemUser,l=e.user,r=e.loading;return{system:a,systemUser:t,currentUser:l.currentUser,loading:r.models.systemUser}})(l=B.a.create()(l=function(e){function a(e){var t;return S()(this,a),(t=C()(this,N()(a).call(this,e))).state={formValues:[],defaultFormValue:{property:"isDelete",value:"0",group:"main",operation:"NOT_EQUAL",relation:"AND"},pageBean:{page:1,pageSize:7,showTotal:!0},deptSearch:{}},t.columns=[{title:"登录名",dataIndex:"account"},{title:"姓名",dataIndex:"fullname"},{title:"电话",dataIndex:"mobile"},{title:"机构",dataIndex:"organName"},{title:"操作",width:80,render:function(e,a){return A.a.createElement(v.a,{placement:"left",title:"选择"},A.a.createElement(V.a,{type:"primary",shape:"circle",icon:"check",size:"small",onClick:function(){return t.selectData(a)}}))}}],t.getList=function(e){(0,t.props.dispatch)({type:"systemUser/fetch",payload:e})},t.selectData=function(e){var a=t.props,l=a.setSelectData,r=a.handleModalVisible;l(e),r()},t.handleStandardTableChange=function(e){var a=t.state,l=a.formValues,r=a.defaultFormValue,n=a.deptSearch,i=[];i.unshift(r),Object.keys(n).length&&i.push(n);var s={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:i.concat(l)};t.getList(s)},t.handleFormReset=function(){var e=t.props,a=e.form,l=e.currentUser,r=t.state,n=r.defaultFormValue,i=r.pageBean,s=r.deptSearch;a.resetFields(),t.setState({formValues:[]});var o=[n];Object.keys(s).length&&o.push(s),t.getList({pageBean:i,querys:[].concat(o,[{property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}])})},t.handleSearch=function(e){e.preventDefault();var a=t.props,l=a.form,r=a.currentUser,n=t.state,i=n.defaultFormValue,s=n.pageBean,o=n.deptSearch;l.validateFields(function(e,a){if(!e){var l=H()({},a);delete l.organId;var n=Object.keys(l).map(function(e){return l[e]?{property:e,value:l[e],group:"main",operation:"LIKE",relation:"AND"}:""}).filter(function(e){return e});n.push({property:"organId",value:a.organId||r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.setState({formValues:n}),n.unshift(i),Object.keys(o).length&&n.push(o),t.getList({pageBean:s,querys:n})}})},Z=Object(K.B)(),t}return I()(a,e),D()(a,[{key:"componentDidMount",value:function(){var e=this.state,a=e.defaultFormValue,t=e.pageBean,l=localStorage.getItem("organId"),r={property:"department",value:Z[0].join(),group:"main",operation:"LIKE",relation:"AND"},n=[a];Z[0].length<4&&(n.push(r),this.setState({deptSearch:r})),this.getList({pageBean:t,querys:[].concat(n,[{property:"organId",value:l,group:"main",operation:"RIGHT_LIKE",relation:"AND"}])})}},{key:"renderSimpleForm",value:function(){var e=this.props,a=e.system.treeList,t=e.form.getFieldDecorator;return A.a.createElement(B.a,{onSubmit:this.handleSearch,layout:"inline"},A.a.createElement(h.a,{gutter:{md:8,lg:8,xl:8}},A.a.createElement(f.a,{md:5,sm:24},A.a.createElement("div",{className:Y.a.inputMain},A.a.createElement("span",{style:{width:"60px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"区域"),A.a.createElement(W,{style:{flex:1}},t("organId")(A.a.createElement(P.a,{treeData:a,style:{width:"100%"},placeholder:"请选择"}))))),A.a.createElement(f.a,{md:5,sm:24},A.a.createElement(W,null,t("account")(A.a.createElement(g.a,{addonBefore:"登录名",placeholder:"请输入"})))),A.a.createElement(f.a,{md:5,sm:24},A.a.createElement(W,null,t("fullname")(A.a.createElement(g.a,{addonBefore:"姓名",placeholder:"请输入"})))),A.a.createElement(f.a,{md:5,sm:24},A.a.createElement(W,null,t("mobile")(A.a.createElement(g.a,{addonBefore:"电话",placeholder:"请输入"})))),A.a.createElement(f.a,{md:4,sm:24},A.a.createElement("span",{className:Q.a.submitButtons},A.a.createElement(V.a,{type:"primary",htmlType:"submit"},"查询"),A.a.createElement(V.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this.props,a=e.systemUser.data,t=e.loading,l=e.handleModalVisible,r=e.modalVisible,n={tableAlert:!1,selectedRows:0,rowSelection:null,size:"middle",loading:t,data:a,columns:this.columns,onChange:this.handleStandardTableChange};return A.a.createElement(z.a,{destroyOnClose:!0,title:"选择人员",className:X.a.formModal,visible:r,width:1100,onCancel:function(){return l()},footer:null},A.a.createElement(p.a,{bordered:!1},A.a.createElement("div",{className:Q.a.tableList},A.a.createElement("div",{className:Q.a.tableListForm},this.renderSimpleForm()),A.a.createElement(R.a,n))))}}]),a}(x.PureComponent))||l)||l,ee=B.a.Item,ae=Object(q.connect)(function(e){return{TransportArchivesFirm:e.TransportArchivesFirm,loading:e.loading.models.TransportArchivesFirm}})(r=B.a.create()((i=n=function(e){function a(){var e,t;S()(this,a);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return(t=C()(this,(e=N()(a)).call.apply(e,[this].concat(r)))).state={modalUserVisible:!1},t.handleUserModalVisible=function(e){t.setState({modalUserVisible:!!e})},t.setSelectData=function(e){t.props.form.setFieldsValue({safetySupervisor:e.fullname})},t.save=function(){var e=t.props,a=e.dispatch,l=e.form,r=e.modalCallback,n=e.handleModalVisible;l.validateFields(function(e,t){if(!e){var l=H()({},t,{createType:2,status:2});a({type:"TransportArchivesFirm/add",payload:l,callback:function(){E.a.success("添加成功"),n(),setTimeout(function(){return r()},300)}})}})},t}return I()(a,e),D()(a,[{key:"render",value:function(){var e=this,a=this.props,t=a.form,l=a.modalVisible,r=a.handleModalVisible,n=a.loading,i=this.state.modalUserVisible;return A.a.createElement(x.Fragment,null,A.a.createElement(z.a,{destroyOnClose:!0,title:"添加",className:X.a.formModal,visible:l,width:800,onCancel:function(){return r()},footer:[A.a.createElement(V.a,{key:"back",onClick:function(){return r()}},"取消"),A.a.createElement(V.a,{key:"submit",type:"primary",loading:n,onClick:function(){return e.save()}},"确定")]},A.a.createElement("div",{className:X.a.formModalBody},A.a.createElement(h.a,{gutter:40},A.a.createElement(f.a,{md:12,sm:24},A.a.createElement(ee,{label:"公司名称"},t.getFieldDecorator("companyName",{rules:[{required:!0,message:"请输入公司名称！"}]})(A.a.createElement(g.a,{placeholder:"请输入"}))),A.a.createElement(ee,{label:"账号"},t.getFieldDecorator("account",{rules:[{required:!0,message:"请输入账号！"}]})(A.a.createElement(g.a,{placeholder:"接收短信消息通知的号码"}))),A.a.createElement(ee,{label:"密码"},t.getFieldDecorator("password",{rules:[{required:!0,message:"请输入密码！"}]})(A.a.createElement(g.a,{placeholder:"请输入"}))),A.a.createElement(ee,{label:"详细地址"},t.getFieldDecorator("addr",{rules:[{required:!0,message:"请输入详细地址！"}]})(A.a.createElement(g.a,{placeholder:"请输入"})))),A.a.createElement(f.a,{md:12,sm:24},A.a.createElement(ee,{label:"联系人"},t.getFieldDecorator("concacts",{rules:[{required:!0,message:"请输入联系人！"}]})(A.a.createElement(g.a,{placeholder:"请输入"}))),A.a.createElement(ee,{label:"联系方式"},t.getFieldDecorator("concactsTel",{rules:[{required:!0,message:"请输入联系方式！"}]})(A.a.createElement(g.a,{placeholder:"请输入"}))),A.a.createElement(ee,{label:"信用代码"},t.getFieldDecorator("creditCode",{rules:[{required:!0,message:"请输入信用代码！"}]})(A.a.createElement(g.a,{placeholder:"请输入"}))),A.a.createElement(ee,{label:"安全督导员"},t.getFieldDecorator("safetySupervisor",{rules:[{required:!0,message:"请选择安全督导员！"}]})(A.a.createElement(g.a,{readOnly:!0,placeholder:"请选择",onClick:function(){return e.handleUserModalVisible(!0)}}))))))),i?A.a.createElement($,{modalVisible:i,setSelectData:this.setSelectData,handleModalVisible:this.handleUserModalVisible}):null)}}]),a}(x.PureComponent),n.defaultProps={modalVisible:!1,handleModalVisible:function(){}},r=i))||r)||r,te=(t("7Kak"),t("9yH6")),le=B.a.Item,re=["审核中","通过","驳回","申请修改"],ne=Object(q.connect)(function(e){return{TransportArchivesFirm:e.TransportArchivesFirm,loading:e.loading.models.TransportArchivesFirm}})(s=B.a.create()((c=o=function(e){function a(){var e,t;S()(this,a);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return(t=C()(this,(e=N()(a)).call.apply(e,[this].concat(r)))).state={detail:{},modalUserVisible:!1},t.handleUserModalVisible=function(e){t.setState({modalUserVisible:!!e})},t.setSelectData=function(e){t.props.form.setFieldsValue({safetySupervisor:e.fullname})},t.save=function(){var e=t.props,a=e.dispatch,l=e.form,r=e.modalCallback,n=e.handleModalVisible,i=e.detail;l.validateFields(function(e,l){if(!e){for(var s=JSON.parse(JSON.stringify(i)),o=Object.keys(l),c=0;c<o.length;c+=1)s[o[c]]=l[o[c]];t.setState({detail:s}),a({type:"TransportArchivesFirm/update",payload:s,callback:function(){E.a.success("编辑成功"),n(),setTimeout(function(){return r()},300)}})}})},t}return I()(a,e),D()(a,[{key:"render",value:function(){var e=this,a=this.props,t=a.form,l=a.modalVisible,r=a.handleModalVisible,n=a.loading,i=this.state,s=i.detail,o=i.modalUserVisible;return A.a.createElement(x.Fragment,null,A.a.createElement(z.a,{destroyOnClose:!0,title:"编辑",className:X.a.formModal,visible:l,width:800,onCancel:function(){return r()},footer:[A.a.createElement(V.a,{key:"back",onClick:function(){return r()}},"取消"),A.a.createElement(V.a,{key:"submit",type:"primary",loading:n,onClick:function(){return e.save()}},"确定")]},A.a.createElement("div",{className:X.a.formModalBody},A.a.createElement(h.a,{gutter:40},A.a.createElement(f.a,{md:12,sm:24},A.a.createElement(le,{label:"公司名称"},t.getFieldDecorator("companyName",{initialValue:s.companyName,rules:[{required:!0,message:"请输入公司名称！"}]})(A.a.createElement(g.a,{placeholder:"请输入"}))),A.a.createElement(le,{label:"账号"},t.getFieldDecorator("account",{initialValue:s.account,rules:[{required:!0,message:"请输入账号！"}]})(A.a.createElement(g.a,{placeholder:"接收短信消息通知的号码"}))),A.a.createElement(le,{label:"密码"},t.getFieldDecorator("password",{initialValue:s.password,rules:[{required:!0,message:"请输入密码！"}]})(A.a.createElement(g.a,{placeholder:"请输入"}))),A.a.createElement(le,{label:"详细地址"},t.getFieldDecorator("addr",{initialValue:s.addr,rules:[{required:!0,message:"请输入详细地址！"}]})(A.a.createElement(g.a,{placeholder:"请输入"}))),A.a.createElement(le,{label:"状态"},t.getFieldDecorator("status",{initialValue:s.status,rules:[{required:!0,message:"请选择状态！"}]})(A.a.createElement(te.a.Group,null,re.map(function(e,a){return A.a.createElement(te.a,{value:a+1,key:a},e)}))))),A.a.createElement(f.a,{md:12,sm:24},A.a.createElement(le,{label:"联系人"},t.getFieldDecorator("concacts",{initialValue:s.concacts,rules:[{required:!0,message:"请输入联系人！"}]})(A.a.createElement(g.a,{placeholder:"请输入"}))),A.a.createElement(le,{label:"联系方式"},t.getFieldDecorator("concactsTel",{initialValue:s.concactsTel,rules:[{required:!0,message:"请输入联系方式！"}]})(A.a.createElement(g.a,{placeholder:"请输入"}))),A.a.createElement(le,{label:"信用代码"},t.getFieldDecorator("creditCode",{initialValue:s.creditCode,rules:[{required:!0,message:"请输入信用代码！"}]})(A.a.createElement(g.a,{placeholder:"请输入"}))),A.a.createElement(le,{label:"安全督导员"},t.getFieldDecorator("safetySupervisor",{initialValue:s.safetySupervisor,rules:[{required:!0,message:"请输入安全督导员！"}]})(A.a.createElement(g.a,{readOnly:!0,placeholder:"请选择",onClick:function(){return e.handleUserModalVisible(!0)}}))))))),o?A.a.createElement($,{modalVisible:o,setSelectData:this.setSelectData,handleModalVisible:this.handleUserModalVisible}):null)}}],[{key:"getDerivedStateFromProps",value:function(e){return{detail:e.detail}}}]),a}(x.PureComponent),o.defaultProps={detail:{},modalVisible:!1,handleModalVisible:function(){}},s=c))||s)||s,ie=t("ytuB"),se=B.a.Item,oe=L.a.Option,ce=["自主申请","管理员添加"],de=["审核中","通过","驳回","申请修改"],me=Object(q.connect)(function(e){return{TransportArchivesFirm:e.TransportArchivesFirm,loading:e.loading.models.TransportArchivesFirm}})(d=B.a.create()(d=function(e){function a(){var e,t;S()(this,a);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return(t=C()(this,(e=N()(a)).call.apply(e,[this].concat(r)))).state={exportVisible:!1,modalVisible:!1,updateModalVisible:!1,selectedRows:[],formValues:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"公司名称",dataIndex:"companyName"},{title:"注册账号",dataIndex:"account"},{title:"详细地址",dataIndex:"addr"},{title:"安全监督员",dataIndex:"safetySupervisor"},{title:"创建方式",dataIndex:"createType",width:100,render:function(e){return ce[e-1]}},{title:"创建时间",dataIndex:"createTime",width:170,render:function(e){return O()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"状态",width:90,dataIndex:"status",render:function(e){return de[e-1]}},{title:"操作",width:100,render:function(e,a){return A.a.createElement(x.Fragment,null,A.a.createElement(v.a,{placement:"left",title:"编辑"},A.a.createElement(V.a,{onClick:function(){return t.showDetailModal(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),A.a.createElement(y.a,{type:"vertical"}),A.a.createElement(b.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id_)},okText:"确定",cancelText:"取消"},A.a.createElement(v.a,{placement:"left",title:"删除"},A.a.createElement(V.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.getList=function(e){(0,t.props.dispatch)({type:"TransportArchivesFirm/fetch",payload:e})},t.showDetailModal=function(e){return t.setState({detail:e},function(){return t.handleUpdateModalVisible(!0)})},t.dataDel=function(e){(0,t.props.dispatch)({type:"TransportArchivesFirm/remove",payload:e,callback:function(){var e=t.state.pageBean;E.a.success("删除成功"),t.getList({pageBean:e})}})},t.handleStandardTableChange=function(e){var a=t.state.formValues,l={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:a};t.getList(l)},t.handleFormReset=function(){var e=t.props.form,a=t.state.pageBean;e.resetFields(),t.setState({formValues:[],selectedRows:[]}),t.getList({pageBean:a})},t.handleSearch=function(e){e.preventDefault();var a=t.props.form,l=t.state.pageBean;a.validateFields(function(e,a){if(!e){var r={companyName:a.comName,concacts:a.LXR,concactsTel:a.LXFS,status:a.state},n=Object.keys(r).map(function(e){return r[e]?{property:e,value:r[e],group:"main",operation:"status"===e?"EQUAL":"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:n}),t.getList({pageBean:l,querys:n})}})},t.handleExportVisible=function(e){t.setState({exportVisible:!!e})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{}})},t.modalCallback=function(){var e=t.state.pageBean;t.getList({pageBean:e})},t}return I()(a,e),D()(a,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return A.a.createElement(B.a,{onSubmit:this.handleSearch,layout:"inline"},A.a.createElement(h.a,{gutter:16},A.a.createElement(f.a,{md:5,sm:24},A.a.createElement(se,null,e("comName")(A.a.createElement(g.a,{addonBefore:"公司名称",placeholder:"请输入"})))),A.a.createElement(f.a,{md:5,sm:24},A.a.createElement(se,null,e("LXR")(A.a.createElement(g.a,{addonBefore:"联系人",placeholder:"请输入"})))),A.a.createElement(f.a,{md:5,sm:24},A.a.createElement(se,null,e("LXFS")(A.a.createElement(g.a,{addonBefore:"联系方式",placeholder:"请输入"})))),A.a.createElement(f.a,{md:5,sm:24},A.a.createElement("div",{className:Y.a.inputMain},A.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"状态"),A.a.createElement(se,{style:{flex:1,flexShrink:0}},e("state")(A.a.createElement(L.a,{placeholder:"请选择",style:{width:"100%"}},de.map(function(e,a){return A.a.createElement(oe,{value:a+1,key:a},e)})))))),A.a.createElement(f.a,{md:4,sm:24},A.a.createElement("span",{className:Q.a.submitButtons},A.a.createElement(V.a,{type:"primary",htmlType:"submit"},"查询"),A.a.createElement(V.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.TransportArchivesFirm.data,l=a.loading,r=this.state,n=(r.selectedRows,r.exportVisible),i=r.modalVisible,s=r.updateModalVisible,o=r.detail,c={modalCallback:this.modalCallback,handleModalVisible:this.handleModalVisible},d={detail:o,modalCallback:this.modalCallback,handleModalVisible:this.handleUpdateModalVisible};return A.a.createElement(x.Fragment,null,A.a.createElement(p.a,{bordered:!1},A.a.createElement("div",{className:Q.a.tableList},A.a.createElement("div",{className:Q.a.tableListForm},this.renderSimpleForm()),A.a.createElement("div",{className:Q.a.tableListOperator},A.a.createElement(V.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"),A.a.createElement(V.a,{className:Y.a.import,icon:"export",onClick:function(){return e.handleExportVisible(!0)}},"导入")),A.a.createElement(R.a,{rowKey:"id_",size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:l,data:t,columns:this.columns,onChange:this.handleStandardTableChange}))),A.a.createElement(ae,u()({},c,{modalVisible:i})),s&&Object.keys(o).length?A.a.createElement(ne,u()({},d,{modalVisible:s})):null,n&&A.a.createElement(ie.a,{modalVisible:n,path:"/transport/api/tsAdmin/company/importExcelCompany",modalCallback:this.modalCallback,handleModalVisible:this.handleExportVisible}))}}]),a}(x.PureComponent))||d)||d;a.default=me}}]);