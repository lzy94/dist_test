(window.webpackJsonp=window.webpackJsonp||[]).push([[199],{wT5s:function(e,t,a){"use strict";a.r(t);var l,n,i,r,o,s,c,d,m,u,p,f,h,b,g,E,y=a("pVnL"),V=a.n(y),v=(a("IzEo"),a("bx4M")),D=(a("14J3"),a("BMrR")),k=(a("jCWc"),a("kPKH")),C=(a("5NDa"),a("5rEg")),S=(a("2qtc"),a("kLXV")),M=(a("miYZ"),a("tsqr")),I=(a("/zsF"),a("PArb")),T=(a("P2fV"),a("NJEC")),w=(a("5Dmo"),a("3S7+")),F=(a("+L6B"),a("2/Rp")),N=a("lwsE"),P=a.n(N),q=a("W8MJ"),L=a.n(q),x=a("a1gu"),O=a.n(x),R=a("Nsbk"),z=a.n(R),B=a("7W2i"),U=a.n(B),j=(a("y8nQ"),a("Vl3Y")),A=a("q1tI"),J=a.n(A),K=a("MuoO"),H=a("CkN6"),X=(a("DZo9"),a("8z0m")),Z=(a("Pwec"),a("CtXQ")),Q=(a("giR+"),a("fyUT")),W=a("MVZn"),Y=a.n(W),_=(a("OaEy"),a("2fM7")),G=a("+n12"),$=a("lTPH"),ee=a("J1lK"),te=a("njnb"),ae=a("ZP6J"),le=a.n(ae),ne=j.a.Item,ie=_.a.Option,re=Object(K.connect)(function(e){return{TransportDangerPeriodic:e.TransportDangerPeriodic,loading:e.loading.models.TransportDangerPeriodic}})(l=j.a.create()((i=n=function(e){function t(){var e,a;P()(this,t);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(a=O()(this,(e=z()(t)).call.apply(e,[this].concat(n)))).state={templateVisible:!1,firmMultipleVisbile:!1,tempId:"",companyId:"",fileList:[]},a.handleTemplateVisible=function(e){a.setState({templateVisible:!!e})},a.handleFirmMultipleVisbile=function(e){a.setState({firmMultipleVisbile:!!e})},a.setSelectData=function(e,t){var l=a.props.form;a.setState({tempId:e}),l.setFieldsValue({tempName:t})},a.setSelectFirm=function(e,t){var l=a.props.form;a.setState({companyId:e}),l.setFieldsValue({companyName:t})},a.handleChange=function(e){var t=e.fileList;return a.setState({fileList:t})},a.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",accept:"pdf,doc,docx,zip",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(G.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:G.p,onChange:a.handleChange}},a.save=function(){var e=a.props,t=e.dispatch,l=e.form,n=e.modalCallback,i=e.handleModalVisible,r=a.state,o=r.tempId,s=r.companyId,c=r.fileList;return l.validateFields(function(e,l){if(!e){var r=Y()({},l,{tempId:o,companyId:s,status:1}),d=c.map(function(e){return e.response.filePath}),m=c.map(function(e){return e.response.fileName});r.fielUrls=d.join(),r.fileName=m.join(),t({type:"TransportDangerPeriodic/UAData",payload:r,callback:function(){M.a.success("添加成功"),i(),a.setState({fileList:[]}),setTimeout(function(){return n()},300)}})}}),null},a.cancelClick=function(){var e=a.props.handleModalVisible;a.setState({fileList:[]}),e()},a}return U()(t,e),L()(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.form,l=t.modalVisible,n=t.loading,i=this.state,r=i.fileList,o=i.templateVisible,s=i.firmMultipleVisbile;return J.a.createElement(A.Fragment,null,J.a.createElement(S.a,{destroyOnClose:!0,title:"添加周期性督查",className:le.a.formModal,visible:l,width:700,onCancel:this.cancelClick,footer:[J.a.createElement(F.a,{key:"back",onClick:this.cancelClick},"取消"),J.a.createElement(F.a,{key:"submit",type:"primary",loading:n,onClick:this.save},"确定")]},J.a.createElement("div",{className:le.a.formModalBody},J.a.createElement(D.a,{gutter:20},J.a.createElement(k.a,{md:12,sm:24},J.a.createElement(ne,{label:"名称"},a.getFieldDecorator("name",{rules:[{required:!0,message:"请输入名称！"}]})(J.a.createElement(C.a,{placeholder:"请输入"}))),J.a.createElement(ne,{label:"督查类别"},a.getFieldDecorator("type",{rules:[{required:!0,message:"请选择督查类别！"}]})(J.a.createElement(_.a,{style:{width:"100%"},placeholder:"请选择"},$.E.map(function(e,t){return J.a.createElement(ie,{value:t+1,key:t},e)})))),J.a.createElement(ne,{label:"模板"},a.getFieldDecorator("tempName",{rules:[{required:!0,message:"请选择模板！"}]})(J.a.createElement(C.a,{readOnly:!0,placeholder:"请选择",onClick:function(){return e.handleTemplateVisible(!0)}})))),J.a.createElement(k.a,{md:12,sm:24},J.a.createElement(ne,{label:"标题"},a.getFieldDecorator("title",{rules:[{required:!0,message:"请输入标题！"}]})(J.a.createElement(C.a,{placeholder:"请输入"}))),J.a.createElement(ne,{label:"频率"},a.getFieldDecorator("frequency",{rules:[{required:!0,message:"请选择频率！"}]})(J.a.createElement(_.a,{style:{width:"100%"},placeholder:"请选择"},$.n.map(function(e,t){return J.a.createElement(ie,{value:e,key:t},e)})))),J.a.createElement(ne,{label:"期限天数"},a.getFieldDecorator("term",{rules:[{required:!0,message:"请输入期限天数！"}]})(J.a.createElement(Q.a,{style:{width:"100%"},placeholder:"请输入"})))),J.a.createElement(k.a,{md:24,sm:24},J.a.createElement(ne,{label:"督查对象"},a.getFieldDecorator("companyName",{rules:[{required:!0,message:"请选择督查对象！"}]})(J.a.createElement(C.a.TextArea,{readOnly:!0,placeholder:"请选择",onClick:function(){return e.handleFirmMultipleVisbile(!0)}})))),J.a.createElement(k.a,{md:24,sm:24},J.a.createElement(ne,{label:"情况说明概要"},a.getFieldDecorator("desc",{rules:[{required:!0,message:"请输入情况说明概要！"}]})(J.a.createElement(C.a.TextArea,{placeholder:"请输入"})))),J.a.createElement(k.a,{md:24,sm:24},J.a.createElement(ne,{label:"附件"},a.getFieldDecorator("fielUrls",{})(J.a.createElement(X.a,V()({},this.uploadConfig(),{fileList:r}),r.length>0?null:J.a.createElement(F.a,null,J.a.createElement(Z.a,{type:"upload"})," 选择附件！（pdf,doc,docx,zip）")))))))),o&&J.a.createElement(ee.a,{setSelectData:this.setSelectData,handleModalVisible:this.handleTemplateVisible,modalVisible:o}),s&&J.a.createElement(te.a,{setSelectData:this.setSelectFirm,handleModalVisible:this.handleFirmMultipleVisbile,modalVisible:s}))}}]),t}(A.PureComponent),n.defaultProps={modalVisible:!1,handleModalVisible:function(){}},l=i))||l)||l,oe=a("y01j"),se=j.a.Item,ce=_.a.Option,de=Object(K.connect)(function(e){return{TransportDangerPeriodic:e.TransportDangerPeriodic,loading:e.loading.models.TransportDangerPeriodic}})(r=j.a.create()((s=o=function(e){function t(){var e,a;P()(this,t);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(a=O()(this,(e=z()(t)).call.apply(e,[this].concat(n)))).state={templateVisible:!1,firmMultipleVisbile:!1,tempId:"",companyId:"",fileList:[],fileName:"",detail:{}},a.handleTemplateVisible=function(e){a.setState({templateVisible:!!e})},a.handleFirmMultipleVisbile=function(e){a.setState({firmMultipleVisbile:!!e})},a.setSelectData=function(e,t){var l=a.props.form;a.setState({tempId:e}),l.setFieldsValue({tempName:t})},a.setSelectFirm=function(e){var t=a.props.form;a.setState({companyId:e.id_}),t.setFieldsValue({companyName:e.companyName})},a.handleChange=function(e){var t=e.fileList;return a.setState({fileList:t})},a.uploadConfig=function(){return{name:"files",accept:"pdf,doc,docx,zip",action:"/result/api/file/v1/fileUpload",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(G.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:G.p,onChange:a.handleChange}},a.save=function(){var e=a.props,t=e.dispatch,l=e.form,n=e.modalCallback,i=e.handleModalVisible,r=a.state,o=r.tempId,s=r.companyId,c=r.detail,d=r.fileName;return l.validateFields(function(e,l){if(!e){var r=Y()({},l,{tempId:o,companyId:s,fileName:d});if("object"==typeof r.fielUrls){var m=r.fielUrls.fileList.map(function(e){return e.response.filePath}),u=r.fielUrls.fileList.map(function(e){return e.response.fileName});r.fielUrls=m.join(),r.fileName=u.join()}for(var p=JSON.parse(JSON.stringify(c)),f=Object.keys(r),h=0;h<f.length;h+=1)p[f[h]]=r[f[h]];a.setState({detail:p}),t({type:"TransportDangerPeriodic/UAData",payload:p,callback:function(){M.a.success("编辑成功"),i(),setTimeout(function(){return n()},300)}})}}),null},a.cancelClick=function(){var e=a.props.handleModalVisible;a.setState({fileList:[]}),e()},a}return U()(t,e),L()(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.form,l=t.modalVisible,n=t.loading,i=this.state,r=i.fileList,o=i.templateVisible,s=i.firmMultipleVisbile,c=i.detail;return J.a.createElement(A.Fragment,null,J.a.createElement(S.a,{destroyOnClose:!0,title:"编辑周期性督查",className:le.a.formModal,visible:l,width:700,onCancel:this.cancelClick,footer:[J.a.createElement(F.a,{key:"back",onClick:this.cancelClick},"取消"),J.a.createElement(F.a,{key:"submit",type:"primary",loading:n,onClick:this.save},"确定")]},J.a.createElement("div",{className:le.a.formModalBody},J.a.createElement(D.a,{gutter:20},J.a.createElement(k.a,{md:12,sm:24},J.a.createElement(se,{label:"名称"},a.getFieldDecorator("name",{initialValue:c.name,rules:[{required:!0,message:"请输入名称！"}]})(J.a.createElement(C.a,{placeholder:"请输入"}))),J.a.createElement(se,{label:"督查类别"},a.getFieldDecorator("type",{initialValue:parseInt(c.type,10),rules:[{required:!0,message:"请选择督查类别！"}]})(J.a.createElement(_.a,{style:{width:"100%"},placeholder:"请选择"},$.E.map(function(e,t){return J.a.createElement(ce,{value:t+1,key:t},e)})))),J.a.createElement(se,{label:"模板"},a.getFieldDecorator("tempName",{initialValue:c.tempName,rules:[{required:!0,message:"请选择模板！"}]})(J.a.createElement(C.a,{readOnly:!0,placeholder:"请选择",onClick:function(){return e.handleTemplateVisible(!0)}})))),J.a.createElement(k.a,{md:12,sm:24},J.a.createElement(se,{label:"标题"},a.getFieldDecorator("title",{initialValue:c.title,rules:[{required:!0,message:"请输入标题！"}]})(J.a.createElement(C.a,{placeholder:"请输入"}))),J.a.createElement(se,{label:"频率"},a.getFieldDecorator("frequency",{initialValue:c.frequency,rules:[{required:!0,message:"请选择频率！"}]})(J.a.createElement(_.a,{style:{width:"100%"},placeholder:"请选择"},$.n.map(function(e,t){return J.a.createElement(ce,{value:e,key:t},e)})))),J.a.createElement(se,{label:"期限天数"},a.getFieldDecorator("term",{initialValue:c.term,rules:[{required:!0,message:"请输入期限天数！"}]})(J.a.createElement(Q.a,{style:{width:"100%"},placeholder:"请输入"})))),J.a.createElement(k.a,{md:24,sm:24},J.a.createElement(se,{label:"督查对象"},a.getFieldDecorator("companyName",{initialValue:c.companyName,rules:[{required:!0,message:"请选择督查对象！"}]})(J.a.createElement(C.a.TextArea,{readOnly:!0,placeholder:"请选择",onClick:function(){return e.handleFirmMultipleVisbile(!0)}})))),J.a.createElement(k.a,{md:24,sm:24},J.a.createElement(se,{label:"情况说明概要"},a.getFieldDecorator("desc",{initialValue:c.desc,rules:[{required:!0,message:"请输入情况说明概要！"}]})(J.a.createElement(C.a.TextArea,{placeholder:"请输入"})))),J.a.createElement(k.a,{md:24,sm:24},J.a.createElement(se,{label:"附件"},a.getFieldDecorator("fielUrls",{initialValue:c.fielUrls})(J.a.createElement(X.a,V()({},this.uploadConfig(),{fileList:r}),r.length>0?null:J.a.createElement(F.a,null,J.a.createElement(Z.a,{type:"upload"})," 选择附件！(pdf,doc,docx,zip)")))))))),o&&J.a.createElement(ee.a,{setSelectData:this.setSelectData,handleModalVisible:this.handleTemplateVisible,modalVisible:o}),s&&J.a.createElement(oe.a,{setSelectData:this.setSelectFirm,handleModalVisible:this.handleFirmMultipleVisbile,modalVisible:s}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.detail,l=t.isSet,n=a.fileName?a.fileName.split(","):[],i=a.fielUrls?a.fielUrls.split(",").map(function(e,t){return{uid:t,name:n[t],status:"done",url:"".concat(G.q).concat(e),path:e}}):[];return l?null:{detail:a,tempId:a.tempId,companyId:a.companyId,fileName:a.fileName,fileList:i,isSet:!l}}}]),t}(A.PureComponent),o.defaultProps={modalVisible:!1,handleModalVisible:function(){}},r=s))||r)||r,me=(a("g9YV"),a("wCAj")),ue=(a("bP8k"),a("gFTJ")),pe=(a("7Kak"),a("9yH6")),fe=["审核通过","不通过"],he=Object(K.connect)(function(e){return{TransportDangerPeriodic:e.TransportDangerPeriodic,loading:e.loading.models.TransportDangerPeriodic}})(c=j.a.create()((m=d=function(e){function t(){var e,a;P()(this,t);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(a=O()(this,(e=z()(t)).call.apply(e,[this].concat(n)))).state={statusValue:0},a.columns=[{title:"内容",dataIndex:"content",width:400,render:function(e){return e?e.length>20?J.a.createElement(w.a,{title:e},e.substring(0,20),"..."):e:""}},{title:"反馈内容",dataIndex:"control",render:function(e,t){return 1===e?t.superRet:J.a.createElement("a",{href:G.q+t.superRet,download:"文件"},"文件")}}],a.statusChange=function(e){a.setState({statusValue:e.target.value})},a.save=function(){var e=a.props,t=e.dispatch,l=e.detail,n=e.supervisionId,i=e.form,r=e.modalCallback,o=e.handleModalVisible,s=e.retDetailID;return i.validateFields(function(e,a){if(!e){var i=Y()({},a,{id:s,supervisionId:n,superRet:JSON.stringify(l.superRet)});t({type:"TransportDangerPeriodic/saveCycleSuperRet",payload:i,callback:function(){r(),o(),M.a.success("审核成功")}})}}),null},a}return U()(t,e),L()(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.modalVisible,l=t.handleModalVisible,n=t.detail,i=t.form,r=t.loading,o=this.state.statusValue;return J.a.createElement(S.a,{destroyOnClose:!0,title:"督查反馈",className:le.a.formModal,visible:a,width:600,onCancel:function(){return l()},footer:[J.a.createElement(F.a,{key:"back",onClick:function(){return l()}},"取消"),J.a.createElement(F.a,{key:"submit",type:"primary",loading:r,onClick:function(){return e.save()}},"确定")]},J.a.createElement(v.a,{bordered:!1},J.a.createElement(me.a,{size:"small",columns:this.columns,rowKey:"order",dataSource:n.superRet?JSON.parse(n.superRet):[],pagination:!1}),J.a.createElement(j.a.Item,{label:"审核"},i.getFieldDecorator("status",{rules:[{required:!0,message:"请选择！"}]})(J.a.createElement(pe.a.Group,{onChange:this.statusChange},fe.map(function(e,t){return J.a.createElement(pe.a,{value:t+1},e)})))),2===o&&J.a.createElement(j.a.Item,{label:"不通过原因"},i.getFieldDecorator("reson",{rules:[{message:"请输入！"}]})(J.a.createElement(C.a.TextArea,{placeholder:"请输入"})))))}}]),t}(A.PureComponent),d.defaultProps={detail:{},modalVisible:!1,handleModalVisible:function(){}},c=m))||c)||c,be=["","审核通过","不通过"],ge=Object(K.connect)(function(e){return{TransportDangerPeriodic:e.TransportDangerPeriodic,loading:e.loading.models.TransportDangerPeriodic}})((f=p=function(e){function t(){var e,a;P()(this,t);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(a=O()(this,(e=z()(t)).call.apply(e,[this].concat(n)))).columns=[{title:"内容",dataIndex:"content",width:400,render:function(e){return e?e.length>20?J.a.createElement(w.a,{title:e},e.substring(0,20),"..."):e:""}},{title:"反馈内容",dataIndex:"control",render:function(e,t){return 1===e?t.superRet:J.a.createElement("a",{href:G.q+t.superRet,download:"文件"},"文件")}}],a}return U()(t,e),L()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.handleModalVisible,l=e.detail;return J.a.createElement(S.a,{destroyOnClose:!0,title:"详情",className:le.a.formModal,visible:t,width:600,onCancel:function(){return a()},footer:null},J.a.createElement(v.a,{bordered:!1},J.a.createElement(me.a,{size:"small",columns:this.columns,rowKey:"order",dataSource:l.superRet?JSON.parse(l.superRet):[],pagination:!1,style:{marginBottom:10}}),J.a.createElement(ue.a,{size:"small",column:1,bordered:!0},J.a.createElement(ue.a.Item,{label:"审核"},be[l.status]),2===l.status&&J.a.createElement(ue.a.Item,{label:"不通过原因"},l.reson||""))))}}]),t}(A.PureComponent),p.defaultProps={detail:{},modalVisible:!1,handleModalVisible:function(){}},u=f))||u,Ee=["未审核","审核通过","不通过"],ye=Object(K.connect)(function(e){return{TransportDangerPeriodic:e.TransportDangerPeriodic,loading:e.loading.models.TransportDangerPeriodic}})((g=b=function(e){function t(){var e,a;P()(this,t);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(a=O()(this,(e=z()(t)).call.apply(e,[this].concat(n)))).state={supervisionId:"",retDetailID:"",retDetail:{},querys:[],modalSuprtVisible:!1,toExamineVisible:!1},a.columns=[{title:"创建时间",dataIndex:"createTime",width:170},{title:"审核",dataIndex:"status",render:function(e){return Ee[e]}},{title:"不通过的原因",dataIndex:"reson",render:function(e){return e&&e.length>10?J.a.createElement(w.a,{title:e},"".concat(e.substring(0,10),"...")):e}},{title:"操作",width:90,render:function(e,t){return J.a.createElement(A.Fragment,null,t.status>0?J.a.createElement(w.a,{placement:"left",title:"详情"},J.a.createElement(F.a,{onClick:function(){return a.showDetailModal(t,"detail")},type:"primary",shape:"circle",icon:"eye",size:"small"})):J.a.createElement(w.a,{placement:"left",title:"审核"},J.a.createElement(F.a,{onClick:function(){return a.showDetailModal(t,"toExamine")},type:"primary",shape:"circle",icon:"edit",size:"small"})),J.a.createElement(I.a,{type:"vertical"}),J.a.createElement(T.a,{title:"是否删除数据?",onConfirm:function(){return a.dataDel(t.id)},okText:"确定",cancelText:"取消"},J.a.createElement(w.a,{placement:"left",title:"删除"},J.a.createElement(F.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],a.showDetailModal=function(e,t){var l=e.id,n=e.supervisionId;e.superRet;a.setState({retDetail:e,retDetailID:l,supervisionId:n},function(){"detail"===t?a.handleSuperModalVisible(!0):a.handleToExamineVisible(!0)})},a.dataDel=function(e){(0,a.props.dispatch)({type:"TransportDangerPeriodic/removeCycleSuperRet",payload:{ids:e},callback:function(){a.modalCallback()}})},a.getList=function(e){(0,a.props.dispatch)({type:"TransportDangerPeriodic/cycleSuperRetListfetch",payload:e})},a.tableChange=function(e){var t=a.state.querys,l=e.pageSize,n=e.current;a.getList({pageBean:{page:n,pageSize:l,showTotal:!0},querys:t})},a.handleToExamineVisible=function(e){a.setState({toExamineVisible:!!e}),e||a.setState({retDetail:{}})},a.handleSuperModalVisible=function(e){a.setState({modalSuprtVisible:!!e}),e||a.setState({retDetail:{}})},a.modalCallback=function(){var e=a.state.querys;a.getList({pageBean:{page:1,pageSize:10,showTotal:!0},querys:e})},a}return U()(t,e),L()(t,[{key:"componentDidMount",value:function(){var e=[{group:"main",operation:"EQUAL",property:"supervisionId",relation:"AND",value:this.props.detail.id}];this.setState({querys:e}),this.getList({pageBean:{page:1,pageSize:10,showTotal:!0},querys:e})}},{key:"render",value:function(){var e=this.props,t=e.TransportDangerPeriodic.cycleSuperRetListData,a=t.list,l=t.pagination,n=e.loading,i=e.modalVisible,r=e.handleModalVisible,o=e.detail,s=this.state,c=s.modalSuprtVisible,d=s.retDetail,m=s.retDetailID,u=s.supervisionId,p=s.toExamineVisible;return J.a.createElement(J.a.Fragment,null,J.a.createElement(S.a,{destroyOnClose:!0,title:"周期性督查详情",className:le.a.formModal,visible:i,width:700,onCancel:function(){return r()},footer:null},J.a.createElement(v.a,{bordered:!1},J.a.createElement(ue.a,{size:"small",column:2,bordered:!0},J.a.createElement(ue.a.Item,{label:"名称"},o.name),J.a.createElement(ue.a.Item,{label:"标题"},o.title),J.a.createElement(ue.a.Item,{label:"督查类别"},$.E[parseInt(o.type,10)-1]),J.a.createElement(ue.a.Item,{label:"频率"},o.frequency),J.a.createElement(ue.a.Item,{label:"模板"},o.tempName),J.a.createElement(ue.a.Item,{label:"期限天数"},o.term),J.a.createElement(ue.a.Item,{label:"督查对象",span:2},o.companyName),J.a.createElement(ue.a.Item,{label:"附件",span:2},J.a.createElement("a",{href:"".concat(G.q).concat(o.fielUrls),rel:"noopener noreferrer",target:"_blank",download:o.fileName},o.fileName))),J.a.createElement("h3",{style:{marginTop:10}},"反馈"),J.a.createElement(me.a,{rowKey:"id",size:"small",loading:n,columns:this.columns,dataSource:a,pagination:l,onChange:this.tableChange}))),p&&Object.keys(d).length&&J.a.createElement(he,{supervisionId:u,retDetailID:m,detail:d,modalVisible:p,modalCallback:this.modalCallback,handleModalVisible:this.handleToExamineVisible}),c&&Object.keys(d).length&&J.a.createElement(ge,{supervisionId:u,retDetailID:m,detail:d,modalVisible:c,modalCallback:this.modalCallback,handleModalVisible:this.handleSuperModalVisible}))}}]),t}(A.PureComponent),b.defaultProps={detail:{},modalVisible:!1,handleModalVisible:function(){}},h=g))||h,Ve=a("9zHi"),ve=a.n(Ve),De=j.a.Item,ke=["待发布","已发布"],Ce=Object(K.connect)(function(e){return{TransportDangerPeriodic:e.TransportDangerPeriodic,loading:e.loading.models.TransportDangerPeriodic}})(E=j.a.create()(E=function(e){function t(){var e,a;P()(this,t);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(a=O()(this,(e=z()(t)).call.apply(e,[this].concat(n)))).state={modalVisible:!1,detailVisible:!1,updateModalVisible:!1,selectedRows:[],formValues:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},a.columns=[{title:"督查名称",dataIndex:"name"},{title:"督查标题",dataIndex:"title"},{title:"督查对象",dataIndex:"companyName"},{title:"类别",dataIndex:"type",render:function(e){return $.E[e-1]}},{title:"状态",width:100,dataIndex:"status",render:function(e){return ke[e-1]}},{title:"创建时间",dataIndex:"createTime"},{title:"操作",width:130,render:function(e,t){return 1===t.status?J.a.createElement(A.Fragment,null,J.a.createElement(T.a,{title:"是否发布数据?",onConfirm:function(){return a.pushData(t.id)},okText:"确定",cancelText:"取消"},J.a.createElement(w.a,{placement:"left",title:"发布"},J.a.createElement(F.a,{shape:"circle",icon:"to-top",size:"small"}))),J.a.createElement(I.a,{type:"vertical"}),J.a.createElement(w.a,{placement:"left",title:"编辑"},J.a.createElement(F.a,{onClick:function(){return a.showUpdateModal(t)},type:"primary",shape:"circle",icon:"edit",size:"small"})),J.a.createElement(I.a,{type:"vertical"}),J.a.createElement(T.a,{title:"是否删除数据?",onConfirm:function(){return a.dataDel(t.id)},okText:"确定",cancelText:"取消"},J.a.createElement(w.a,{placement:"left",title:"删除"},J.a.createElement(F.a,{type:"danger",shape:"circle",icon:"delete",size:"small"})))):J.a.createElement(w.a,{placement:"left",title:"详情"},J.a.createElement(F.a,{onClick:function(){return a.showDetailModal(t)},type:"primary",shape:"circle",icon:"eye",size:"small"}))}}],a.getList=function(e){(0,a.props.dispatch)({type:"TransportDangerPeriodic/fetch",payload:e})},a.pushData=function(e){(0,a.props.dispatch)({type:"TransportDangerPeriodic/updateStatus",payload:{type:2,id:e},callback:function(){M.a.success("发布成功",function(){var e=a.state,t=e.pageBean,l=e.formValues;a.getList({pageBean:t,querys:l})})}})},a.showUpdateModal=function(e){return a.setState({detail:e},function(){return a.handleUpdateModalVisible(!0)})},a.showDetailModal=function(e){return a.setState({detail:e},function(){return a.handleDetailVisible(!0)})},a.dataDel=function(e){a.delUtil(e)},a.batchDel=function(){var e=a.state.selectedRows;e.length&&S.a.confirm({title:"提示",content:"是否删除数据？",onOk:function(){var t=e.map(function(e){return e.id});a.delUtil(t.join(),function(){a.setState({selectedRows:[]})})}})},a.delUtil=function(e,t){(0,a.props.dispatch)({type:"TransportDangerPeriodic/remove",payload:{ids:e},callback:function(){M.a.success("删除成功",function(){var e=a.state.pageBean;a.getList({pageBean:e})}),t&&t()}})},a.handleStandardTableChange=function(e){var t=a.state.formValues,l={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:t};a.getList(l)},a.handleFormReset=function(){var e=a.props.form,t=a.state.pageBean;e.resetFields(),a.setState({formValues:[],selectedRows:[]}),a.getList({pageBean:t})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.handleSearch=function(e){e.preventDefault();var t=a.props.form,l=a.state.pageBean;t.validateFields(function(e,t){if(!e){var n={name:t.MC,title:t.BT},i=Object.keys(n).map(function(e){return n[e]?{property:e,value:n[e],group:"main",operation:"LIKE",relation:"AND"}:""}).filter(function(e){return e});a.setState({formValues:i}),a.getList({pageBean:l,querys:i})}})},a.handleModalVisible=function(e){a.setState({modalVisible:!!e})},a.handleUpdateModalVisible=function(e){a.setState({updateModalVisible:!!e}),e||a.setState({detail:{}})},a.handleDetailVisible=function(e){a.setState({detailVisible:!!e}),e||a.setState({detail:{}})},a.modalCallback=function(){var e=a.state.pageBean;a.getList({pageBean:e})},a}return U()(t,e),L()(t,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return J.a.createElement(j.a,{onSubmit:this.handleSearch,layout:"inline"},J.a.createElement(D.a,{gutter:{md:8,lg:16,xl:32}},J.a.createElement(k.a,{md:6,sm:24},J.a.createElement(De,null,e("MC")(J.a.createElement(C.a,{addonBefore:"名称",placeholder:"请输入"})))),J.a.createElement(k.a,{md:6,sm:24},J.a.createElement(De,null,e("BT")(J.a.createElement(C.a,{addonBefore:"标题",placeholder:"请输入"})))),J.a.createElement(k.a,{md:4,sm:24},J.a.createElement("span",{className:ve.a.submitButtons},J.a.createElement(F.a,{type:"primary",htmlType:"submit"},"查询"),J.a.createElement(F.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,t=this.props,a=t.TransportDangerPeriodic.data,l=t.loading,n=this.state,i=n.selectedRows,r=n.modalVisible,o=n.updateModalVisible,s=n.detail,c=n.detailVisible,d={modalCallback:this.modalCallback,handleModalVisible:this.handleModalVisible},m={detail:s,modalCallback:this.modalCallback,handleModalVisible:this.handleUpdateModalVisible};return J.a.createElement(A.Fragment,null,J.a.createElement(v.a,{bordered:!1},J.a.createElement("div",{className:ve.a.tableList},J.a.createElement("div",{className:ve.a.tableListForm},this.renderSimpleForm()),J.a.createElement("div",{className:ve.a.tableListOperator},J.a.createElement(F.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"),i.length>0&&J.a.createElement(F.a,{type:"danger",onClick:this.batchDel},"批量删除")),J.a.createElement(H.a,{size:"middle",tableAlert:!0,selectedRows:i,loading:l,data:a,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),J.a.createElement(re,V()({},d,{modalVisible:r})),o&&Object.keys(s).length&&J.a.createElement(de,V()({},m,{modalVisible:o})),c&&Object.keys(s).length&&J.a.createElement(ye,{detail:s,modalVisible:c,handleModalVisible:this.handleDetailVisible}))}}]),t}(A.PureComponent))||E)||E;t.default=Ce}}]);