(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{Ce0X:function(e,a,t){"use strict";t.r(a);t("IzEo");var l,r=t("bx4M"),n=(t("T2oS"),t("W9HT")),s=(t("ozfa"),t("MJZm")),o=(t("miYZ"),t("tsqr")),d=(t("P2fV"),t("NJEC")),c=(t("/zsF"),t("PArb")),i=(t("+L6B"),t("2/Rp")),m=(t("5Dmo"),t("3S7+")),u=t("lwsE"),p=t.n(u),h=t("W8MJ"),g=t.n(h),E=t("a1gu"),y=t.n(E),b=t("Nsbk"),f=t.n(b),v=t("7W2i"),F=t.n(v),S=t("pVnL"),V=t.n(S),C=t("MVZn"),I=t.n(C),D=(t("2qtc"),t("kLXV")),k=(t("14J3"),t("BMrR")),M=(t("nRaC"),t("5RzL")),N=(t("giR+"),t("fyUT")),w=(t("jCWc"),t("kPKH")),T=(t("5NDa"),t("5rEg")),O=(t("y8nQ"),t("Vl3Y")),L=t("q1tI"),B=t.n(L),x=t("MuoO"),R=t("mf+E"),j=t("CkN6"),q=t("+n12"),K=t("9zHi"),U=t.n(K),J=t("ZP6J"),A=t.n(J),z=O.a.Item,H=["/datemain/source","/datemain/source/addSource","/datemain/source/update","/datemain/source/deleteSource"],G=O.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleAdd,r=e.handleModalVisible,n=e.treeList;e.cascaderChange;return B.a.createElement(D.a,{destroyOnClose:!0,title:"新增源头企业",visible:a,className:A.a.formModal,onOk:function(){t.validateFields(function(e,a){e||(t.resetFields(),l(a))})},onCancel:function(){return r()},width:800},B.a.createElement("div",{className:A.a.formModalBody},B.a.createElement(k.a,{gutter:40},B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{hasFeedback:!0,label:"企业名称"},t.getFieldDecorator("companyName",{rules:[{required:!0,message:"请输入企业名称"}]})(B.a.createElement(T.a,{placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{hasFeedback:!0,label:"企业编码"},t.getFieldDecorator("siteCode",{rules:[{required:!0,message:"请输入企业编码"}]})(B.a.createElement(T.a,{placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"企业联系人"},t.getFieldDecorator("contactMan",{rules:[{message:"请输入企业联系人"}]})(B.a.createElement(T.a,{placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"企业号码"},t.getFieldDecorator("companyTel",{rules:[{message:"请输入企业号码",validator:q.j}]})(B.a.createElement(T.a,{placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"监管单位"},t.getFieldDecorator("supervisionCompany",{rules:[{message:"请输入监管单位"}]})(B.a.createElement(T.a,{placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"监管责任人"},t.getFieldDecorator("supervisionMan",{rules:[{message:"请输入监管责任人"}]})(B.a.createElement(T.a,{placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"监管人电话"},t.getFieldDecorator("supervisionTel",{rules:[{message:"请输入监管人联系方式",validator:q.j}]})(B.a.createElement(T.a,{placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"年货运吞吐量"},t.getFieldDecorator("throughput",{rules:[{message:"请输入年货运吞吐量",type:"number"}]})(B.a.createElement(N.a,{style:{width:"100%"},min:0,placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"所在道路"},t.getFieldDecorator("whereLoad",{rules:[{message:"请输入所在道路"}]})(B.a.createElement(T.a,{placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"经度"},t.getFieldDecorator("longitude",{rules:[{message:"请输入经度",validator:q.f}]})(B.a.createElement(T.a,{placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"纬度"},t.getFieldDecorator("latitude",{rules:[{message:"请输入纬度",validator:q.i}]})(B.a.createElement(T.a,{placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{hasFeedback:!0,label:"行政区域"},t.getFieldDecorator("organId",{rules:[{required:!0,message:"请选择行政区域"}]})(B.a.createElement(M.a,{treeData:n,style:{width:"100%"},placeholder:"请选择"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{hasFeedback:!0,label:"企业地址"},t.getFieldDecorator("address",{rules:[{required:!0,message:"企业地址"}]})(B.a.createElement(T.a.TextArea,{placeholder:"请输入"})))))))}),P=O.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleUpdate,r=e.handleModalVisible,n=e.treeList,s=(e.cascaderChange,e.detail),o=Object(q.c)(H[2]),d=o?{}:{footer:null},c=o?{}:{color:"rgba(0,0,0,.7)",border:0};return B.a.createElement(D.a,V()({destroyOnClose:!0,title:Object(q.c)(H[2])?"编辑源头企业":"源头企业详情",visible:a,className:A.a.formModal,onOk:function(){t.validateFields(function(e,a){e||(t.resetFields(),l(a))})},onCancel:function(){return r()},width:800},d),B.a.createElement("div",{className:A.a.formModalBody},B.a.createElement(k.a,{gutter:40},B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{hasFeedback:o,label:"企业名称"},t.getFieldDecorator("companyName",{initialValue:s.companyName,rules:[{required:!0,message:"请输入企业名称"}]})(B.a.createElement(T.a,{disabled:!o,style:c,placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{hasFeedback:o,label:"企业编码"},t.getFieldDecorator("siteCode",{initialValue:s.siteCode,rules:[{required:!0,message:"请输入企业编码"}]})(B.a.createElement(T.a,{disabled:!o,style:c,placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"企业联系人"},t.getFieldDecorator("contactMan",{initialValue:s.contactMan,rules:[{message:"请输入企业联系人"}]})(B.a.createElement(T.a,{disabled:!o,style:c,placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"企业号码"},t.getFieldDecorator("companyTel",{initialValue:s.companyTel,rules:[{message:"请输入企业号码",validator:q.j}]})(B.a.createElement(T.a,{disabled:!o,style:c,placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"监管单位"},t.getFieldDecorator("supervisionCompany",{initialValue:s.supervisionCompany,rules:[{message:"请输入监管单位"}]})(B.a.createElement(T.a,{disabled:!o,style:c,placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"监管责任人"},t.getFieldDecorator("supervisionMan",{initialValue:s.supervisionCompany,rules:[{message:"请输入监管责任人"}]})(B.a.createElement(T.a,{disabled:!o,style:c,placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"监管人电话"},t.getFieldDecorator("supervisionTel",{initialValue:s.supervisionTel,rules:[{message:"请输入监管人联系方式",validator:q.j}]})(B.a.createElement(T.a,{disabled:!o,style:c,placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"年货运吞吐量"},t.getFieldDecorator("throughput",{initialValue:s.throughput,rules:[{message:"请输入年货运吞吐量",type:"number"}]})(B.a.createElement(N.a,{min:0,disabled:!o,style:I()({},c,{width:"100%"}),placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"所在道路"},t.getFieldDecorator("whereLoad",{initialValue:s.whereLoad,rules:[{message:"请输入所在道路"}]})(B.a.createElement(T.a,{disabled:!o,style:c,placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"经度"},t.getFieldDecorator("longitude",{initialValue:s.longitude,rules:[{message:"请输入经度",validator:q.i}]})(B.a.createElement(T.a,{disabled:!o,style:c,placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{label:"纬度"},t.getFieldDecorator("latitude",{initialValue:s.latitude,rules:[{message:"请输入纬度",validator:q.f}]})(B.a.createElement(T.a,{disabled:!o,style:c,placeholder:"请输入"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{hasFeedback:o,label:"行政区域"},t.getFieldDecorator("organId",{initialValue:s.organId?[s.organId]:[],rules:[{required:!0,message:"请选择行政区域"}]})(B.a.createElement(M.a,{disabled:!o,treeData:n,style:I()({width:"100%"},c),placeholder:"请选择"})))),B.a.createElement(w.a,{md:12,sm:24},B.a.createElement(z,{hasFeedback:o,label:"企业地址"},t.getFieldDecorator("address",{initialValue:s.address,rules:[{required:!0,message:"企业地址"}]})(B.a.createElement(T.a.TextArea,{disabled:!o,style:c,placeholder:"请输入"})))))))}),_=Object(x.connect)(function(e){var a=e.system,t=e.Source,l=e.loading;return{system:a,Source:t,currentUser:e.user.currentUser,loading:l.models.Source,systemLoading:l.models.system}})(l=O.a.create()(l=function(e){function a(){var e,t;p()(this,a);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return(t=y()(this,(e=f()(a)).call.apply(e,[this].concat(r)))).state={modalVisible:!1,selectedRows:[],formValues:[],expandCheckKeys:[],orangValue:"",treeFormValue:{},selectedKeys:[],updateModalVisible:!1,detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"企业编码",dataIndex:"siteCode"},{title:"企业名称",dataIndex:"companyName"},{title:"企业电话",dataIndex:"companyTel"},{title:"地址",dataIndex:"address",render:function(e){return e.length>12?B.a.createElement(m.a,{title:e},e.substring(0,12)+"..."):e}},{title:"联系人",dataIndex:"contactMan"},{title:"年货运吞吐量",dataIndex:"throughput"},{title:"监管责任单位",dataIndex:"supervisionCompany"},{title:"监管责任人",dataIndex:"supervisionMan"},{title:"监管电话",dataIndex:"supervisionTel"},{title:"操作",width:Object(q.c)(H[3])?100:70,render:function(e,a){return B.a.createElement(L.Fragment,null,Object(q.c)(H[2])?B.a.createElement(m.a,{placement:"left",title:"编辑"},B.a.createElement(i.a,{onClick:function(){return t.showUpdateModal(a.id)},type:"primary",shape:"circle",icon:"edit",size:"small"})):B.a.createElement(m.a,{placement:"left",title:"详情"},B.a.createElement(i.a,{onClick:function(){return t.showUpdateModal(a.id)},type:"primary",shape:"circle",icon:"eye",size:"small"})),Object(q.c)(H[3])?B.a.createElement(L.Fragment,null,B.a.createElement(c.a,{type:"vertical"}),B.a.createElement(d.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},B.a.createElement(m.a,{placement:"left",title:"删除"},B.a.createElement(i.a,{type:"danger",shape:"circle",icon:"delete",size:"small"})))):null)}}],t.showUpdateModal=function(e){(0,t.props.dispatch)({type:"Source/detail",payload:e,callback:function(e){t.setState({detail:e}),t.handleUpdateModalVisible(!0)}})},t.dataDel=function(e){(0,t.props.dispatch)({type:"Source/remove",payload:{remove:{id:e},query:{pageBean:t.state.pageBean}}})},t.handleStandardTableChange=function(e,a,l){var r=t.props,n=r.dispatch,s=r.currentUser,o=t.state,d=o.formValues,c=o.treeFormValue,i=[];"{}"!==JSON.stringify(c)?i.push(c):i.unshift({property:"organId",value:s.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),n({type:"Source/fetch",payload:{pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:i.concat(d)}})},t.handleFormReset=function(){var e=t.props,a=e.form,l=e.dispatch,r=e.currentUser,n=t.state.pageBean;a.resetFields(),t.setState({formValues:[],expandCheckKeys:[],selectedKeys:[]}),l({type:"Source/fetch",payload:{pageBean:n,querys:[{property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}]}})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.handleSearch=function(e){e.preventDefault();var a=t.props,l=a.dispatch,r=a.form,n=a.currentUser,s=t.state,o=s.pageBean,d=s.treeFormValue;r.validateFields(function(e,a){if(!e){var r=Object.keys(a).map(function(e){return a[e]?{property:e,value:a[e],group:"main",operation:"LIKE",relation:"OR"}:""}).filter(function(e){return e});t.setState({formValues:JSON.parse(JSON.stringify(r))}),"{}"!==JSON.stringify(d)?r.push(d):r.unshift({property:"organId",value:n.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),l({type:"Source/fetch",payload:{pageBean:o,querys:r}})}})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e})},t.handleAdd=function(e){var a=t.props.dispatch,l=t.state,r=l.pageBean;l.orangValue;a({type:"Source/add",payload:{add:e,query:{pageBean:r}},callback:function(){o.a.success("添加成功"),t.handleModalVisible()}})},t.handleUpdate=function(e){var a=t.props.dispatch,l=t.state,r=l.pageBean,n=l.detail,s=JSON.parse(JSON.stringify(n)),d=Object.keys(e);"object"==typeof e.organId&&(e.organId=e.organId.join());for(var c=0;c<d.length;c++)s[d[c]]=e[d[c]];t.setState({detail:s}),a({type:"Source/update",payload:{update:s,query:{pageBean:r}},callback:function(){o.a.success("编辑成功"),t.handleUpdateModalVisible()}})},t.cascaderChange=function(e,a){},t.onSelect=function(e,a){if(e[0]){t.setState({selectedKeys:e});var l=t.props.dispatch,r=t.state,n=r.formValues,s=r.pageBean,o=[],d={property:"organId",value:e[0],group:"main",operation:"RIGHT_LIKE",relation:"OR"};t.setState({treeFormValue:d}),o.push(d),l({type:"Source/fetch",payload:{pageBean:s,querys:o=o.concat(n)}})}},t.expandCheck=function(e){t.setState({expandCheckKeys:e})},t.renderTreeNodes=function(e){return e.map(function(e){return e.children?B.a.createElement(s.a.TreeNode,{title:e.title,key:e.key,dataRef:e},t.renderTreeNodes(e.children)):B.a.createElement(s.a.TreeNode,e)})},t}return F()(a,e),g()(a,[{key:"componentDidMount",value:function(){Object(q.c)(H[0])&&(0,this.props.dispatch)({type:"Source/fetch",payload:{pageBean:this.state.pageBean,querys:[{property:"organId",value:localStorage.getItem("organId"),group:"main",operation:"RIGHT_LIKE",relation:"AND"}]}})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return B.a.createElement(O.a,{onSubmit:this.handleSearch,layout:"inline"},B.a.createElement(k.a,{gutter:{md:8,lg:16,xl:16}},B.a.createElement(w.a,{md:5,sm:12},B.a.createElement(z,null,e("siteCode")(B.a.createElement(T.a,{addonBefore:"企业编码",placeholder:"请输入"})))),B.a.createElement(w.a,{md:5,sm:12},B.a.createElement(z,null,e("companyName")(B.a.createElement(T.a,{addonBefore:"企业名称",placeholder:"请输入"})))),B.a.createElement(w.a,{md:5,sm:12},B.a.createElement(z,null,e("address")(B.a.createElement(T.a,{addonBefore:"地址",placeholder:"请输入"})))),B.a.createElement(w.a,{md:5,sm:12},B.a.createElement(z,null,e("throughput")(B.a.createElement(T.a,{addonBefore:"年货运吞吐量",placeholder:"请输入"})))),B.a.createElement(w.a,{md:4,sm:12},B.a.createElement("span",{className:U.a.submitButtons},B.a.createElement(i.a,{type:"primary",htmlType:"submit"},"查询"),B.a.createElement(i.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.system.treeList,l=a.Source.data,o=a.loading,d=a.systemLoading,c=this.state,m=c.selectedRows,u=c.modalVisible,p=c.updateModalVisible,h=c.detail,g=c.expandCheckKeys,E=c.selectedKeys,y={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible,cascaderChange:this.cascaderChange,treeList:t},b={handleUpdate:this.handleUpdate,handleModalVisible:this.handleUpdateModalVisible,cascaderChange:this.cascaderChange,treeList:t,detail:h};return B.a.createElement(L.Fragment,null,Object(q.c)(H[0])?null:B.a.createElement(R.a,{to:"/exception/403"}),B.a.createElement("div",{className:U.a.tableMain},B.a.createElement(n.a,{spinning:d},B.a.createElement("div",{className:U.a.treeLeft},B.a.createElement(s.a,{selectedKeys:E,showLine:!0,onSelect:this.onSelect,expandedKeys:g[0]?g:[t[0]?t[0].key:""],onExpand:this.expandCheck},this.renderTreeNodes(t)))),B.a.createElement("div",{className:U.a.rightTable},B.a.createElement(r.a,{bordered:!1,style:{height:"100%"}},B.a.createElement("div",{className:U.a.tableList},B.a.createElement("div",{className:U.a.tableListForm},this.renderSimpleForm()),B.a.createElement("div",{className:U.a.tableListOperator},Object(q.c)(H[1])?B.a.createElement(i.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"):null,m.length>0&&B.a.createElement(i.a,null,"批量操作")),B.a.createElement(j.a,{selectedRows:m,rowSelection:null,loading:o,data:l,tableAlert:!1,size:"middle",columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))))),Object(q.c)(H[1])?B.a.createElement(G,V()({},y,{modalVisible:u})):null,p&&"{}"!==JSON.stringify(h)?B.a.createElement(P,V()({},b,{modalVisible:p})):null)}}]),a}(L.PureComponent))||l)||l;a.default=_}}]);