(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{SzZq:function(e,t,a){"use strict";a.r(t);var l,n,i,r,o,c,s,d=a("pVnL"),u=a.n(d),p=(a("IzEo"),a("bx4M")),m=(a("14J3"),a("BMrR")),f=(a("jCWc"),a("kPKH")),h=(a("5NDa"),a("5rEg")),b=(a("miYZ"),a("tsqr")),g=(a("2qtc"),a("kLXV")),y=(a("P2fV"),a("NJEC")),v=(a("/zsF"),a("PArb")),E=(a("5Dmo"),a("3S7+")),C=(a("+L6B"),a("2/Rp")),k=a("lwsE"),V=a.n(k),D=a("W8MJ"),S=a.n(D),M=a("a1gu"),w=a.n(M),B=a("Nsbk"),x=a.n(B),L=a("7W2i"),P=a.n(L),z=(a("y8nQ"),a("Vl3Y")),F=a("q1tI"),I=a.n(F),N=a("MuoO"),T=a("CkN6"),q=(a("Pwec"),a("CtXQ")),R=(a("g9YV"),a("wCAj")),A=a("MVZn"),j=a.n(A),O=a("RIqP"),U=a.n(O),J=a("ZP6J"),Z=a.n(J),W=a("NWc4"),H=a.n(W),X=(a("DZo9"),a("8z0m")),Y=a("+n12"),_=z.a.Item,K=z.a.create()((i=n=function(e){function t(){var e,a;V()(this,t);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(a=w()(this,(e=x()(t)).call.apply(e,[this].concat(n)))).state={detail:{},fileList:[],isSet:!1},a.save=function(){var e=a.props,t=e.form,l=e.getData,n=e.type,i=e.saveData;t.validateFields(function(e,t){if(!e){var r=a.state,o=r.fileList,c=r.detail;if(o.length){var s=j()({},t,{key:(new Date).getTime()});if("object"==typeof t.publicData){var d=t.publicData.file.response;s.publicData=d?d.filePath:""}"add"===n?l(s,n):"edit_add"===n?l(s,n):(s.id=c.id,i(s,n)),a.cancelClick()}else b.a.error("请选择文件")}})},a.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".pdf,.doc,.docx,.zip",className:"upload-list-inline",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(Y.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:Y.p,onChange:a.uploadChange}},a.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(b.a.success("上传成功"),a.setState({fileList:e.fileList})):b.a.error(e.file.response.code.msg):"error"===e.file.status?b.a.error("上传失败"):"removed"===e.file.status&&a.setState({fileList:e.fileList})},a.cancelClick=function(){var e=a.props.handleModalVisible;a.setState({fileList:[]}),e()},a}return P()(t,e),S()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.form,l=e.type,n=this.state,i=n.fileList,r=n.detail;return I.a.createElement(g.a,{destroyOnClose:!0,title:"add"===l?"添加":"编辑",className:Z.a.formModal,visible:t,onCancel:this.cancelClick,onOk:this.save},I.a.createElement("div",{className:Z.a.formModalBody},I.a.createElement(_,{label:"项目名称"},a.getFieldDecorator("projectName",{initialValue:r.projectName||"",rules:[{required:!0,message:"请输入项目名称"}]})(I.a.createElement(h.a,{placeholder:"请输入"}))),I.a.createElement(_,{label:"公开内容"},a.getFieldDecorator("publicContent",{initialValue:r.publicContent||"",rules:[{required:!0,message:"请输入公开内容"}]})(I.a.createElement(h.a.TextArea,{placeholder:"请输入"}))),I.a.createElement(_,{label:"公开主题"},a.getFieldDecorator("publicTopic",{initialValue:r.publicTopic||"",rules:[{required:!0,message:"请输入公开主题"}]})(I.a.createElement(h.a.TextArea,{placeholder:"请输入"}))),I.a.createElement(_,{label:"公开资料"},a.getFieldDecorator("publicData",{initialValue:r.publicData||"",rules:[{required:!0,message:"公开资料"}]})(I.a.createElement(X.a,u()({},this.uploadConfig(),{defaultFileList:i}),!i.length&&I.a.createElement(C.a,null,I.a.createElement(q.a,{type:"upload"})," 公开资料( pdf , doc, docx, zip)"))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.detail,l=t.isSet;return l?null:{isSet:!l,detail:a,fileList:a.publicData?[{uid:"-1",name:"当前文件",status:"done",url:Y.q+a.publicData}]:[]}}}]),t}(F.PureComponent),n.defaultProps={modalVisible:!1,detail:{},handleModalVisible:function(){},modalCallback:function(){},getData:function(){},saveData:function(){}},l=i))||l,Q=Object(N.connect)(function(e){return{BuildPublicContent:e.BuildPublicContent,loading:e.loading.models.BuildPublicContent}})((c=o=function(e){function t(){var e,a;V()(this,t);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(a=w()(this,(e=x()(t)).call.apply(e,[this].concat(n)))).state={list:[],detail:{},dataIndex:[],type:"add",addModalVisible:!1},a.columns=[{title:"项目名称",dataIndex:"projectName"},{title:"公开内容",dataIndex:"publicContent"},{title:"公开主体",dataIndex:"publicTopic"},{title:"公开资料",dataIndex:"publicData"},{title:"操作",width:100,render:function(e,t){return I.a.createElement(F.Fragment,null,I.a.createElement(E.a,{placement:"left",title:"编辑"},I.a.createElement(C.a,{onClick:function(){return a.showDetailModal(t)},type:"primary",shape:"circle",icon:"file-search",size:"small"})),I.a.createElement(v.a,{type:"vertical"}),I.a.createElement(y.a,{title:"是否删除数据?",onConfirm:function(){return a.delUtil(t.index)},okText:"确定",cancelText:"取消"},I.a.createElement(E.a,{placement:"left",title:"删除"},I.a.createElement(C.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],a.showDetailModal=function(e){a.setState({detail:e,type:"edit_add",dataIndex:e.index},function(){return a.handleAddModalVisible(!0)})},a.delUtil=function(e){var t=a.state.list,l=U()(t);l.splice(e,1),a.setState({list:a.setIndex(l)})},a.setIndex=function(e){return e.map(function(e,t){return j()({},e,{index:t})})},a.getData=function(e,t){var l=a.state,n=l.list,i=l.dataIndex;if("add"===t){var r=a.setIndex([].concat(U()(n),[e]));return a.setState({list:r}),null}var o=U()(n);return o[i]=e,a.setState({list:o}),null},a.handleAddModalVisible=function(e){a.setState({addModalVisible:!!e}),e||a.setState({detail:{},type:"add"})},a.save=function(){var e=a.state,t=e.list,l=e.type;if(t.length){var n=a.props,i=n.dispatch,r=n.modalCallback;i({type:"BuildPublicContent/add",payload:t,callback:function(){b.a.success("".concat("add"===l?"添加":"编辑","成功")),r(),a.cancelClick()}})}else b.a.error("请添加数据")},a.cancelClick=function(){(0,a.props.handleModalVisible)()},a}return P()(t,e),S()(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.loading,l=t.modalVisible,n=this.state,i=n.list,r=n.addModalVisible,o=n.type,c=n.detail;return I.a.createElement(F.Fragment,null,I.a.createElement(g.a,{destroyOnClose:!0,title:"新建公开内容",className:Z.a.formModal,visible:l,onCancel:this.cancelClick,width:1e3,footer:[I.a.createElement(C.a,{key:"back",onClick:this.cancelClick},"取消"),I.a.createElement(C.a,{key:"submit",type:"primary",loading:a,onClick:this.save},"确定")]},I.a.createElement(p.a,{bordered:!1},I.a.createElement(R.a,{columns:this.columns,size:"middle",dataSource:i,pagination:!1}),I.a.createElement("div",{className:H.a.plusBtn,onClick:function(){return e.handleAddModalVisible(!0)}},I.a.createElement(q.a,{type:"plus",style:{fontSize:20}}),I.a.createElement("p",null,"添加")))),r&&I.a.createElement(K,{type:o,detail:c,handleModalVisible:this.handleAddModalVisible,getData:this.getData,modalVisible:r}))}}]),t}(F.PureComponent),o.defaultProps={modalVisible:!1,handleModalVisible:function(){},modalCallback:function(){}},r=c))||r,G=a("9zHi"),$=a.n(G),ee=z.a.Item,te=Object(N.connect)(function(e){return{BuildPublicContent:e.BuildPublicContent,loading:e.loading.models.BuildPublicContent}})(s=z.a.create()(s=function(e){function t(){var e,a;V()(this,t);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(a=w()(this,(e=x()(t)).call.apply(e,[this].concat(n)))).state={modalVisible:!1,updateModalVisible:!1,selectedRows:[],formValues:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},a.columns=[{title:"项目名称",dataIndex:"projectName"},{title:"公开内容",dataIndex:"publicContent"},{title:"公开主体",dataIndex:"publicTopic"},{title:"公开资料",dataIndex:"publicData",width:100,render:function(e){return I.a.createElement("a",{href:Y.q+e,target:"_blank",download:"公开资料"},"资料下载")}},{title:"操作",width:100,render:function(e,t){return I.a.createElement(F.Fragment,null,I.a.createElement(E.a,{placement:"left",title:"编辑"},I.a.createElement(C.a,{onClick:function(){return a.showDetailModal(t.id)},type:"primary",shape:"circle",icon:"file-search",size:"small"})),I.a.createElement(v.a,{type:"vertical"}),I.a.createElement(y.a,{title:"是否删除数据?",onConfirm:function(){return a.delUtil(t.id)},okText:"确定",cancelText:"取消"},I.a.createElement(E.a,{placement:"left",title:"删除"},I.a.createElement(C.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],a.batchDel=function(){g.a.confirm({title:"提示",content:"确定要删除数据吗？",okType:"danger",onOk:function(){var e=a.state.selectedRows;a.delUtil(e.map(function(e){return e.id}).join())}})},a.delUtil=function(e){(0,a.props.dispatch)({type:"BuildPublicContent/remove",payload:{ids:e},callback:function(){b.a.success("删除成功");var e=a.state.pageBean;a.getList({pageBean:e}),a.setState({selectedRows:[]})}})},a.getList=function(e){(0,a.props.dispatch)({type:"BuildPublicContent/fetch",payload:e})},a.showDetailModal=function(e){(0,a.props.dispatch)({type:"BuildPublicContent/detail",payload:e,callback:function(e){a.setState({detail:e},function(){return a.handleUpdateModalVisible(!0)})}})},a.handleStandardTableChange=function(e){var t=a.state.formValues,l={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:t};a.getList(l)},a.handleFormReset=function(){var e=a.props.form,t=a.state.pageBean;e.resetFields(),a.setState({formValues:[],selectedRows:[]}),a.getList({pageBean:t})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.handleSearch=function(e){e.preventDefault();var t=a.props.form,l=a.state.pageBean;t.validateFields(function(e,t){if(!e){var n={publicContent:t.gknr,publicTopic:t.gkzt},i=Object.keys(n).map(function(e){return n[e]?{property:e,value:n[e],group:"main",operation:"LIKE",relation:"AND"}:""}).filter(function(e){return e});a.setState({formValues:i}),a.getList({pageBean:l,querys:i})}})},a.handleModalVisible=function(e){a.setState({modalVisible:!!e})},a.handleUpdateModalVisible=function(e){a.setState({updateModalVisible:!!e}),e||a.setState({detail:{}})},a.saveData=function(e,t){(0,a.props.dispatch)({type:"BuildPublicContent/add",payload:[e],callback:function(){b.a.success("编辑成功"),a.modalCallback()}})},a.modalCallback=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",t=a.state,l=t.pageBean,n=t.formValues;return"add"===e?a.getList({pageBean:l}):a.getList({pageBean:l,querys:n})},a}return P()(t,e),S()(t,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return I.a.createElement(z.a,{onSubmit:this.handleSearch,layout:"inline"},I.a.createElement(m.a,{gutter:16},I.a.createElement(f.a,{md:6,sm:24},I.a.createElement(ee,null,e("gknr")(I.a.createElement(h.a,{addonBefore:"公开内容",placeholder:"请输入"})))),I.a.createElement(f.a,{md:6,sm:24},I.a.createElement(ee,null,e("gkzt")(I.a.createElement(h.a,{addonBefore:"公开主体",placeholder:"请输入"})))),I.a.createElement(f.a,{md:6,sm:24},I.a.createElement("span",{className:$.a.submitButtons},I.a.createElement(C.a,{type:"primary",htmlType:"submit"},"查询"),I.a.createElement(C.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,t=this.props,a=t.BuildPublicContent.data,l=t.loading,n=this.state,i=n.selectedRows,r=n.modalVisible,o=n.updateModalVisible,c=n.detail,s={modalCallback:this.modalCallback},d={handleModalVisible:this.handleModalVisible},m={detail:c,type:"edit",saveData:this.saveData,handleModalVisible:this.handleUpdateModalVisible};return I.a.createElement(F.Fragment,null,I.a.createElement(p.a,{bordered:!1},I.a.createElement("div",{className:$.a.tableList},I.a.createElement("div",{className:$.a.tableListForm},this.renderSimpleForm()),I.a.createElement("div",{className:$.a.tableListOperator},I.a.createElement(C.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"),i.length>0&&I.a.createElement(C.a,{type:"danger",onClick:this.batchDel},"批量删除")),I.a.createElement(T.a,{tableAlert:!0,selectedRows:i,loading:l,data:a,size:"middle",columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),r&&I.a.createElement(Q,u()({},s,d,{modalVisible:r})),o&&Object.keys(c).length&&I.a.createElement(K,u()({},s,m,{modalVisible:o})))}}]),t}(F.PureComponent))||s)||s;t.default=te}}]);