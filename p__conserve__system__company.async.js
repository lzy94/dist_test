(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{fFg2:function(e,a,t){e.exports={readModal:"antd-pro-pages-conserve-system-company-index-readModal",header:"antd-pro-pages-conserve-system-company-index-header",listHeader:"antd-pro-pages-conserve-system-company-index-listHeader",content:"antd-pro-pages-conserve-system-company-index-content",leftList:"antd-pro-pages-conserve-system-company-index-leftList",rightList:"antd-pro-pages-conserve-system-company-index-rightList",selectRoadList:"antd-pro-pages-conserve-system-company-index-selectRoadList",companyName:"antd-pro-pages-conserve-system-company-index-companyName"}},okh4:function(e,a,t){"use strict";t.r(a);var n,l,r,o,i,s,c,d,m=t("pVnL"),u=t.n(m),p=(t("IzEo"),t("bx4M")),g=(t("14J3"),t("BMrR")),f=(t("jCWc"),t("kPKH")),h=(t("5NDa"),t("5rEg")),y=t("MVZn"),E=t.n(y),v=(t("miYZ"),t("tsqr")),C=(t("2qtc"),t("kLXV")),b=(t("P2fV"),t("NJEC")),S=(t("/zsF"),t("PArb")),D=(t("5Dmo"),t("3S7+")),k=(t("+L6B"),t("2/Rp")),M=t("lwsE"),V=t.n(M),I=t("W8MJ"),R=t.n(I),w=t("a1gu"),L=t.n(w),N=t("Nsbk"),T=t.n(N),A=t("7W2i"),x=t.n(A),B=(t("y8nQ"),t("Vl3Y")),F=t("q1tI"),q=t.n(F),P=t("MuoO"),O=t("wd/R"),j=t.n(O),z=t("CkN6"),Y=(t("sRBo"),t("kaz8")),H=(t("DZo9"),t("8z0m")),U=(t("Pwec"),t("CtXQ")),J=(t("iQDF"),t("+eQT")),W=t("+n12"),Q=t("ZP6J"),_=t.n(Q),G=J.a.RangePicker,K=B.a.Item,X=Object(P.connect)(function(e){return{RoadConserveTag:e.RoadConserveTag,ConserveCompany:e.ConserveCompany,loading:e.loading.models.ConserveCompany}})(n=B.a.create()(n=function(e){function a(){var e,t;V()(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=L()(this,(e=T()(a)).call.apply(e,[this].concat(l)))).state={fileList:[]},t.getTag=function(){(0,t.props.dispatch)({type:"RoadConserveTag/fetch"})},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",className:"upload-list-inline",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(W.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:W.A,onChange:t.uploadChange}},t.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(v.a.success("上传成功"),t.setState({fileList:e.fileList})):v.a.error(e.file.response.code.msg):"error"===e.file.status?v.a.error("上传失败"):"removed"===e.file.status&&t.setState({fileList:e.fileList})},t.save=function(){var e=t.props,a=e.form,n=e.dispatch,l=e.handleModalVisible,r=e.modalSuccess,o=t.state.fileList;a.validateFields(function(e,a){if(!e){var t=E()({},a);o.length?(t.contractPicture=t.contractPicture?t.contractPicture.file.response.filePath:"",t.agreementBeginTime=t.time[0],t.agreementEndTime=t.time[1],t.conserveCategoryId=t.conserveCategoryId.join(),n({type:"ConserveCompany/add",payload:t,callback:function(){v.a.success("添加成功"),l(),r()}})):v.a.error("请选择图片")}})},t.cancelClick=function(){var e=t.props.handleModalVisible;t.setState({fileList:[]}),e()},t}return x()(a,e),R()(a,[{key:"componentDidMount",value:function(){this.getTag()}},{key:"render",value:function(){var e=this.props,a=e.RoadConserveTag.data,t=e.modalVisible,n=e.handleModalVisible,l=e.form,r=e.loading,o=this.state.fileList;return q.a.createElement(C.a,{destroyOnClose:!0,title:"新建企业",className:_.a.formModal,visible:t,width:800,onCancel:function(){return n()},footer:[q.a.createElement(k.a,{key:"back",onClick:function(){return n()}},"取消"),q.a.createElement(k.a,{key:"submit",type:"primary",loading:r,onClick:this.save},"确定")]},q.a.createElement("div",{className:_.a.formModalBody},q.a.createElement(g.a,{gutter:40},q.a.createElement(f.a,{md:12,sm:24},q.a.createElement(K,{label:"企业名称"},l.getFieldDecorator("companyName",{rules:[{required:!0,message:"请输入企业名称！"}]})(q.a.createElement(h.a,{placeholder:"请输入"})))),q.a.createElement(f.a,{md:12,sm:24},q.a.createElement(K,{label:"企业编号"},l.getFieldDecorator("companyCode",{rules:[{required:!0,message:"请输入企业编号！"}]})(q.a.createElement(h.a,{placeholder:"请输入"})))),q.a.createElement(f.a,{md:12,sm:24},q.a.createElement(K,{label:"法人代表"},l.getFieldDecorator("companyHeader",{rules:[{required:!0,message:"请输入法人代表！"}]})(q.a.createElement(h.a,{placeholder:"请输入"})))),q.a.createElement(f.a,{md:12,sm:24},q.a.createElement(K,{label:"联系方式"},l.getFieldDecorator("companyTel",{rules:[{required:!0,validator:W.h}]})(q.a.createElement(h.a,{placeholder:"请输入"})))),q.a.createElement(f.a,{md:12,sm:24},q.a.createElement(K,{label:"合约签订时间"},l.getFieldDecorator("time",{rules:[{required:!0,message:"请选择合约签订时间！"}]})(q.a.createElement(G,null)))),q.a.createElement(f.a,{md:12,sm:24},q.a.createElement(K,{label:"合同上传"},l.getFieldDecorator("contractPicture",{rules:[{required:!0,message:"请上传合约附件！"}]})(q.a.createElement(H.a,u()({},this.uploadConfig(),{defaultFileList:o}),o.length>0?null:q.a.createElement(k.a,null,q.a.createElement(U.a,{type:"upload"})," 请上传合约附件"))))),q.a.createElement(f.a,{md:24,sm:24},q.a.createElement(K,{label:"合同签订内容"},l.getFieldDecorator("agreement",{rules:[{required:!0,message:"请输入合同签订内容！"}]})(q.a.createElement(h.a.TextArea,{rows:4})))),q.a.createElement(f.a,{md:24,sm:24},q.a.createElement(K,{label:"企业介绍"},l.getFieldDecorator("companyDesc",{rules:[{required:!0,message:"请输入企业介绍！"}]})(q.a.createElement(h.a.TextArea,{rows:4})))),q.a.createElement(f.a,{md:24,sm:24},q.a.createElement(K,{label:"企业标签"},l.getFieldDecorator("conserveCategoryId",{rules:[{required:!0,message:"请选择企业标签！"}]})(q.a.createElement(Y.a.Group,null,a.list.map(function(e,a){return q.a.createElement(Y.a,{value:e.id,key:a},e.tagName)}))))))))}}]),a}(F.PureComponent))||n)||n,Z=J.a.RangePicker,$=B.a.Item,ee=Object(P.connect)(function(e){return{RoadConserveTag:e.RoadConserveTag,ConserveCompany:e.ConserveCompany,loading:e.loading.models.ConserveCompany}})(l=B.a.create()(l=function(e){function a(){var e,t;V()(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=L()(this,(e=T()(a)).call.apply(e,[this].concat(l)))).state={fileList:[]},t.getDetail=function(){var e=t.props.detail;t.setState({fileList:e.contractPicture?[{uid:"-1",name:"当前图片",status:"done",url:W.B+e.contractPicture}]:[]})},t.getTag=function(){(0,t.props.dispatch)({type:"RoadConserveTag/fetch"})},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",className:"upload-list-inline",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(W.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},onChange:t.uploadChange}},t.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(v.a.success("上传成功"),t.setState({fileList:e.fileList})):v.a.error(e.file.response.code.msg):"error"===e.file.status?v.a.error("上传失败"):"removed"===e.file.status&&t.setState({fileList:e.fileList})},t.save=function(){var e=t.props,a=e.form,n=e.dispatch,l=e.handleModalVisible,r=e.modalSuccess,o=e.detail,i=t.props.fileList;a.validateFields(function(e,a){if(!e){var t=E()({},a);if(i.length){var s=E()({},o);if(t.agreementBeginTime=t.time[0],t.agreementEndTime=t.time[1],t.conserveCategoryId=t.conserveCategoryId.join(),"object"==typeof t.contractPicture){var c=t.contractPicture.file.response;t.contractPicture=c?c.filePath:""}for(var d in t)s[d]=t[d];n({type:"ConserveCompany/update",payload:s,callback:function(){v.a.success("编辑成功"),l(),r()}})}else v.a.error("请选择图片")}})},t.cancelClick=function(){var e=t.props.handleModalVisible;t.setState({fileList:[]}),e()},t}return x()(a,e),R()(a,[{key:"componentDidMount",value:function(){this.getTag(),this.getDetail()}},{key:"render",value:function(){var e=this.props,a=e.RoadConserveTag.data,t=e.detail,n=e.modalVisible,l=(e.handleModalVisible,e.form),r=e.loading,o=this.state.fileList;return q.a.createElement(C.a,{destroyOnClose:!0,title:"编辑企业",className:_.a.formModal,visible:n,width:800,onCancel:this.cancelClick,footer:[q.a.createElement(k.a,{key:"back",onClick:this.cancelClick},"取消"),q.a.createElement(k.a,{key:"submit",type:"primary",loading:r,onClick:this.save},"确定")]},q.a.createElement("div",{className:_.a.formModalBody},q.a.createElement(g.a,{gutter:40},q.a.createElement(f.a,{md:12,sm:24},q.a.createElement($,{label:"企业名称"},l.getFieldDecorator("companyName",{initialValue:t.companyName,rules:[{required:!0,message:"请输入企业名称！"}]})(q.a.createElement(h.a,{placeholder:"请输入"})))),q.a.createElement(f.a,{md:12,sm:24},q.a.createElement($,{label:"企业编号"},l.getFieldDecorator("companyCode",{initialValue:t.companyCode,rules:[{required:!0,message:"请输入企业编号！"}]})(q.a.createElement(h.a,{placeholder:"请输入"})))),q.a.createElement(f.a,{md:12,sm:24},q.a.createElement($,{label:"法人代表"},l.getFieldDecorator("companyHeader",{initialValue:t.companyHeader,rules:[{required:!0,message:"请输入法人代表！"}]})(q.a.createElement(h.a,{placeholder:"请输入"})))),q.a.createElement(f.a,{md:12,sm:24},q.a.createElement($,{label:"联系方式"},l.getFieldDecorator("companyTel",{initialValue:t.companyTel,rules:[{required:!0,validator:W.h}]})(q.a.createElement(h.a,{placeholder:"请输入"})))),q.a.createElement(f.a,{md:12,sm:24},q.a.createElement($,{label:"合约签订时间"},l.getFieldDecorator("time",{initialValue:[j()(new Date(t.agreementBeginTime),"YYYY-MM-DD"),j()(new Date(t.agreementEndTime),"YYYY-MM-DD")],rules:[{required:!0,message:"请选择合约签订时间！"}]})(q.a.createElement(Z,null)))),q.a.createElement(f.a,{md:12,sm:24},q.a.createElement($,{label:"合同上传"},l.getFieldDecorator("contractPicture",{initialValue:t.contractPicture,rules:[{required:!0,message:"请上传合约附件！"}]})(q.a.createElement(H.a,u()({},this.uploadConfig(),{defaultFileList:o}),o.length>0?null:q.a.createElement(k.a,null,q.a.createElement(U.a,{type:"upload"})," 请上传合约附件"))))),q.a.createElement(f.a,{md:24,sm:24},q.a.createElement($,{label:"合同签订内容"},l.getFieldDecorator("agreement",{initialValue:t.agreement,rules:[{required:!0,message:"请输入合同签订内容！"}]})(q.a.createElement(h.a.TextArea,{rows:4})))),q.a.createElement(f.a,{md:24,sm:24},q.a.createElement($,{label:"企业介绍"},l.getFieldDecorator("companyDesc",{initialValue:t.companyDesc,rules:[{required:!0,message:"请输入企业介绍！"}]})(q.a.createElement(h.a.TextArea,{rows:4})))),q.a.createElement(f.a,{md:24,sm:24},q.a.createElement($,{label:"企业标签"},l.getFieldDecorator("conserveCategoryId",{initialValue:t.conserveCategoryId.split(","),rules:[{required:!0,message:"请选择企业标签！"}]})(q.a.createElement(Y.a.Group,null,a.list.map(function(e,a){return q.a.createElement(Y.a,{value:e.id,key:a},e.tagName)}))))))))}}]),a}(F.PureComponent))||l)||l,ae=t("Py4S"),te=t.n(ae),ne=Object(P.connect)(function(e){return{RoadWorkOrdes:e.RoadWorkOrdes,loading:e.loading.models.RoadWorkOrdes}})(r=B.a.create()((i=o=function(e){function a(){var e,t;V()(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=L()(this,(e=T()(a)).call.apply(e,[this].concat(l)))).state={formValues:[],defaultQuery:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"取证照片",width:100,dataIndex:"evidence",render:function(e){return q.a.createElement("div",{style:{overflow:"hidden",width:70,height:50,float:"left",marginRight:10}},q.a.createElement(te.a,{backdrop:"rgba(255,255,255,.3)",src:W.B+e,alt:"图片",style:{width:"100%",height:"50px"}}))}},{title:"扣分",width:90,dataIndex:"delScore"},{title:"罚款",width:90,dataIndex:"fine"},{title:"原因",dataIndex:"reson",render:function(e){return e?e.length>20?q.a.createElement(D.a,{title:e},e.substring(0,20),"..."):e:""}}],t.getList=function(e){(0,t.props.dispatch)({type:"RoadWorkOrdes/getExamineList",payload:e})},t.handleStandardTableChange=function(e){var a=t.state.defaultQuery,n={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:[a]};t.getList(n)},t}return x()(a,e),R()(a,[{key:"componentDidMount",value:function(){var e=this.props.companyID,a=this.state.pageBean,t={group:"main",operation:"EQUAL",property:"companyId",relation:"AND",value:e};this.getList({pageBean:a,querys:[t]}),this.setState({defaultQuery:t})}},{key:"render",value:function(){var e=this.props,a=e.RoadWorkOrdes.examineList,t=e.modalVisible,n=e.handleModalVisible,l=e.loading;return q.a.createElement(C.a,{destroyOnClose:!0,title:"评分列表",className:_.a.formModal,visible:t,width:800,onCancel:function(){return n()},footer:null},q.a.createElement(p.a,{bordered:!1},q.a.createElement(z.a,{rowKey:"id_",size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:l,data:a,columns:this.columns,onChange:this.handleStandardTableChange})))}}]),a}(F.PureComponent),o.defaultProps={modalVisible:!1,handleModalVisible:function(){}},r=i))||r)||r,le=(t("R9oj"),t("ECub")),re=t("H9P5"),oe=B.a.Item,ie=Object(P.connect)(function(e){return{ConserveCompany:e.ConserveCompany,loading:e.loading.models.ConserveCompany}})(s=B.a.create()(s=function(e){function a(e){var t;return V()(this,a),(t=L()(this,T()(a).call(this,e))).state={detail:{},roadMileage:0,startAddr:"",endAddr:"",startlongla:"",endlongla:""},t.getMapData=function(e){var a=e.line,n=e.distance,l=e.startAddr,r=e.endAddr,o=e.sn_lnglat;t.paths=a,t.setState({roadMileage:n/1e3,startAddr:l,endAddr:r,startlongla:o[0].join(),endlongla:o[1].join()})},t.getDetail=function(){var e=t.props;(0,e.dispatch)({type:"RoadInfo/detail",payload:e.roadID,callback:function(e){t.setState({detail:e})}})},t.save=function(){var e=t.props,a=e.form,n=e.dispatch,l=e.handleModalVisible,r=e.modalSuccess,o=e.companyID,i=e.roadID,s=e.roadName;a.validateFields(function(e,a){if(!e){if(!t.paths.length)return v.a.error("请选择道路");var c=t.state,d=c.roadMileage,m=c.startAddr,u=c.endAddr,p=c.startlongla,g=c.endlongla,f=E()({},a,{startAddr:m,endAddr:u,startlongla:p,endlongla:g});f.companyId=o,f.longitudeandlatitude=JSON.stringify(t.paths),f.startlongla=[t.paths[0].lng,t.paths[0].lat].join(),f.roadMileage=d,f.roadId=i,f.roadName=s,n({type:"ConserveCompany/addCompanyRoadConserveData",payload:f,callback:function(){l(),r(),v.a.success("添加成功")}})}})},t.paths=[],t}return x()(a,e),R()(a,[{key:"componentDidMount",value:function(){this.getDetail()}},{key:"componentWillUnmount",value:function(){this.setState({roadMileage:0,startAddr:"",endAddr:"",startlongla:"",endlongla:""})}},{key:"render",value:function(){var e=this,a=this.props,t=a.modalVisible,n=a.handleModalVisible,l=a.form,r=a.loading,o=this.state.detail;return q.a.createElement(C.a,{destroyOnClose:!0,title:"添加路段信息",className:_.a.formModal,visible:t,width:800,onCancel:function(){return n()},footer:[q.a.createElement(k.a,{key:"back",onClick:function(){return n()}},"取消"),q.a.createElement(k.a,{key:"submit",type:"primary",loading:r,onClick:function(){return e.save()}},"确定")]},q.a.createElement("div",{className:_.a.formModalBody},q.a.createElement(g.a,{gutter:40},q.a.createElement(f.a,{md:24,sm:24},"{}"===JSON.stringify(o)?null:q.a.createElement(re.a,{getMapData:this.getMapData,line:JSON.parse(o.longitudeandlatitude)})),q.a.createElement(f.a,{md:24,sm:24},q.a.createElement(oe,{label:"维护内容"},l.getFieldDecorator("content",{rules:[{required:!0,message:"请输入维护内容！"}]})(q.a.createElement(h.a.TextArea,{rows:4,placeholder:"请输入"})))))))}}]),a}(F.PureComponent))||s)||s,se=t("fFg2"),ce=t.n(se),de=Object(P.connect)(function(e){var a=e.ConserveCompany,t=e.RoadInfo,n=e.loading;return{RoadInfo:t,loading:n.models.RoadInfo,ConserveCompany:a,conLoading:n.models.ConserveCompany}})(c=function(e){function a(){var e,t;V()(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=L()(this,(e=T()(a)).call.apply(e,[this].concat(l)))).state={addModalVisible:!1,baseOrgan:[],roadInfos:[],roadID:"",roadName:"",pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"公路名称",dataIndex:"roadName"},{title:"公路编号",dataIndex:"roadCode"},{title:"里程（km）",dataIndex:"roadMileage"},{title:"起始地",dataIndex:"startAddr"},{title:"结束地",dataIndex:"endAddr"},{title:"操作",width:90,render:function(e,a){return q.a.createElement(F.Fragment,null,q.a.createElement("a",{onClick:function(){return t.showAddModal(a)}},"添加"))}}],t.showAddModal=function(e){t.setState({roadID:e.id,roadName:e.roadName},function(){return t.handleAddModalVisible(!0)})},t.handleAddModalVisible=function(e){t.setState({addModalVisible:!!e})},t.getList=function(e){(0,t.props.dispatch)({type:"RoadInfo/fetch",payload:e})},t.modalSuccess=function(){t.getRoadInfos()},t.getRoadInfos=function(){var e=t.props;(0,e.dispatch)({type:"ConserveCompany/getRoadInfosData",payload:e.companyID,callback:function(e){t.setState({roadInfos:e})}})},t.removeRoad=function(e){C.a.confirm({title:"提示",content:"是否删除？",onOk:function(){(0,t.props.dispatch)({type:"ConserveCompany/deleteCompanyRoadConserveByIdData",payload:{id:e},callback:function(){v.a.success("删除成功"),t.getRoadInfos()}})}})},t.renderSelectRoadList=function(){var e=t.state.roadInfos;return e.length?e.map(function(e,a){return q.a.createElement("li",{key:a},q.a.createElement("h3",null,e.roadName),q.a.createElement("p",null,"起点：",e.startAddr),q.a.createElement("p",null,"终点：",e.endAddr),q.a.createElement("p",null,"里程：",e.roadMileage,"km"),q.a.createElement("p",null,"内容：",e.content),q.a.createElement("a",{onClick:function(){return t.removeRoad(e.id_)}},"移除"))}):q.a.createElement(le.a,{image:le.a.PRESENTED_IMAGE_SIMPLE})},t.handleStandardTableChange=function(e,a,n){var l=t.state.formValues,r={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:l};t.getList(r)},t}return x()(a,e),R()(a,[{key:"componentDidMount",value:function(){var e=this.state.pageBean,a=[{property:"organCode",value:localStorage.getItem("organId"),group:"main",operation:"RIGHT_LIKE",relation:"AND"}];this.setState({baseOrgan:a}),this.getList({pageBean:e,querys:a}),this.getRoadInfos()}},{key:"render",value:function(){var e=this.props,a=e.RoadInfo.data,t=e.companyName,n=e.modalVisible,l=e.handleModalVisible,r=e.loading,o=e.companyID,i=this.state,s=i.addModalVisible,c={companyID:o,roadID:i.roadID,roadName:i.roadName,modalSuccess:this.modalSuccess,handleModalVisible:this.handleAddModalVisible};return q.a.createElement(F.Fragment,null,q.a.createElement(C.a,{destroyOnClose:!0,title:"查看添加养护公路",className:_.a.formModal+" "+ce.a.readModal,visible:n,width:1200,onCancel:function(){return l()},footer:null},q.a.createElement("div",{className:ce.a.content},q.a.createElement("div",{className:ce.a.leftList},q.a.createElement("h3",{className:ce.a.header},q.a.createElement("span",null),"已选公路路段"),q.a.createElement("div",{style:{height:540,overflowY:"auto"}},q.a.createElement("ul",{className:ce.a.selectRoadList},this.renderSelectRoadList()),q.a.createElement("p",{className:ce.a.companyName},q.a.createElement("span",null),t))),q.a.createElement("div",{className:ce.a.rightList},q.a.createElement("h3",{className:ce.a.header+" "+ce.a.listHeader},q.a.createElement("span",null),"可选公路路段"),q.a.createElement(z.a,{size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:r,data:a,columns:this.columns,onChange:this.handleStandardTableChange})))),s?q.a.createElement(ie,u()({},c,{modalVisible:s})):null)}}]),a}(F.PureComponent))||c,me=t("9zHi"),ue=t.n(me),pe=B.a.Item,ge=Object(P.connect)(function(e){return{ConserveCompany:e.ConserveCompany,loading:e.loading.models.ConserveCompany}})(d=B.a.create()(d=function(e){function a(){var e,t;V()(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=L()(this,(e=T()(a)).call.apply(e,[this].concat(l)))).state={modalVisible:!1,scoreVisible:!1,updateModalVisible:!1,companyRoadConserveVisible:!1,selectedRows:[],formValues:[],companyID:"",companyName:"",detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"企业名称",dataIndex:"companyName"},{title:"法人代表",dataIndex:"companyHeader"},{title:"联系方式",dataIndex:"companyTel"},{title:"标签",dataIndex:"conserveCategoryName",render:function(e){return e?e.split(",").filter(function(e){return e}).join():""}},{title:"签订时间",dataIndex:"agreementBeginTime",render:function(e){return j()(e).format("YYYY-MM-DD")}},{title:"结束时间",dataIndex:"agreementEndTime",render:function(e){return j()(e).format("YYYY-MM-DD")}},{title:"操作",width:180,render:function(e,a){return q.a.createElement(F.Fragment,null,q.a.createElement(D.a,{placement:"left",title:"评分列表"},q.a.createElement(k.a,{onClick:function(){return t.showScoreModal(a)},type:"primary",shape:"circle",icon:"star",size:"small"})),q.a.createElement(S.a,{type:"vertical"}),q.a.createElement(D.a,{placement:"left",title:"添加路段"},q.a.createElement(k.a,{onClick:function(){return t.showCompanyRoadConserve(a)},type:"primary",shape:"circle",icon:"plus",size:"small"})),q.a.createElement(S.a,{type:"vertical"}),q.a.createElement(D.a,{placement:"left",title:"编辑"},q.a.createElement(k.a,{onClick:function(){return t.editData(a.id)},type:"primary",shape:"circle",icon:"edit",size:"small"})),q.a.createElement(S.a,{type:"vertical"}),q.a.createElement(b.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},q.a.createElement(D.a,{placement:"left",title:"删除"},q.a.createElement(k.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.getList=function(e){(0,t.props.dispatch)({type:"ConserveCompany/fetch",payload:e})},t.showCompanyRoadConserve=function(e){t.setState({companyName:e.companyName,companyID:e.id},function(){return t.handdleCompanyRoadConserveVisible(!0)})},t.showScoreModal=function(e){return t.setState({companyID:e.id},function(){return t.handleScoreVisible(!0)})},t.editData=function(e){(0,t.props.dispatch)({type:"ConserveCompany/detail",payload:e,callback:function(e){return t.setState({detail:e},function(){return t.handleUpdateModalVisible(!0)})}})},t.dataDel=function(e){t.delUtil(e)},t.delBatch=function(){var e=t.state.selectedRows;e&&C.a.confirm({title:"提示",content:"您确定要批量删除吗?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){t.delUtil(e.map(function(e){return e.id}).join())}})},t.delUtil=function(e){(0,t.props.dispatch)({type:"ConserveCompany/remove",payload:{ids:e},callback:function(){v.a.success("删除成功"),t.getList({pageBean:t.state.pageBean}),t.setState({selectedRows:[]})}})},t.handleStandardTableChange=function(e,a,n){var l=t.state.formValues,r={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:l};t.getList(r)},t.handleFormReset=function(){t.props.form.resetFields(),t.setState({formValues:[],selectedRows:[]}),t.getList({pageBean:t.state.pageBean})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var n=E()({},a),l=t.state.pageBean,r=Object.keys(n).map(function(e){return n[e]?{property:e,value:n[e],group:"main",operation:"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:r}),t.getList({pageBean:l,querys:r})}})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.handleScoreVisible=function(e){t.setState({scoreVisible:!!e}),e||t.setState({companyID:""})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{}})},t.handdleCompanyRoadConserveVisible=function(e){t.setState({companyRoadConserveVisible:!!e}),e||t.setState({companyID:""})},t.modalSuccess=function(){t.setState({detailID:""}),t.getList({pageBean:t.state.pageBean})},t}return x()(a,e),R()(a,[{key:"componentDidMount",value:function(){this.getList({pageBean:this.state.pageBean})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return q.a.createElement(B.a,{onSubmit:this.handleSearch,layout:"inline"},q.a.createElement(g.a,{gutter:{md:8,lg:16,xl:32}},q.a.createElement(f.a,{md:6,sm:24},q.a.createElement(pe,null,e("companyHeader")(q.a.createElement(h.a,{addonBefore:"法人代表",placeholder:"请输入"})))),q.a.createElement(f.a,{md:6,sm:24},q.a.createElement(pe,null,e("companyName")(q.a.createElement(h.a,{addonBefore:"企业名称",placeholder:"请输入"})))),q.a.createElement(f.a,{md:6,sm:24},q.a.createElement("span",{className:ue.a.submitButtons},q.a.createElement(k.a,{type:"primary",htmlType:"submit"},"查询"),q.a.createElement(k.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.ConserveCompany.data,n=a.loading,l=this.state,r=l.companyName,o=l.selectedRows,i=l.modalVisible,s=l.detail,c=l.updateModalVisible,d=l.companyRoadConserveVisible,m=l.companyID,g=l.scoreVisible,f={modalSuccess:this.modalSuccess,handleModalVisible:this.handleModalVisible},h={detail:s,modalSuccess:this.modalSuccess,handleModalVisible:this.handleUpdateModalVisible},y={companyID:m,companyName:r,modalSuccess:this.modalSuccess,handleModalVisible:this.handdleCompanyRoadConserveVisible};return q.a.createElement(F.Fragment,null,q.a.createElement(p.a,{bordered:!1},q.a.createElement("div",{className:ue.a.tableList},q.a.createElement("div",{className:ue.a.tableListForm},this.renderSimpleForm()),q.a.createElement("div",{className:ue.a.tableListOperator},q.a.createElement(k.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"),o.length>0&&q.a.createElement(k.a,{type:"danger",onClick:this.delBatch},"批量删除")),q.a.createElement(z.a,{size:"middle",tableAlert:!0,selectedRows:o,loading:n,data:t,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),i?q.a.createElement(X,u()({},f,{modalVisible:i})):null,c&&Object.keys(s).length&&q.a.createElement(ee,u()({},h,{modalVisible:c})),d&&m&&q.a.createElement(de,u()({},y,{modalVisible:d})),g&&m&&q.a.createElement(ne,{companyID:m,modalVisible:g,handleModalVisible:this.handleScoreVisible}))}}]),a}(F.PureComponent))||d)||d;a.default=ge}}]);