(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{RzrX:function(e,t,a){"use strict";a.r(t);var n,i,r,l,o=a("pVnL"),s=a.n(o),c=(a("IzEo"),a("bx4M")),d=(a("14J3"),a("BMrR")),m=(a("iQDF"),a("+eQT")),p=(a("5NDa"),a("5rEg")),u=(a("jCWc"),a("kPKH")),h=(a("nRaC"),a("5RzL")),g=(a("2qtc"),a("kLXV")),E=(a("miYZ"),a("tsqr")),f=a("MVZn"),v=a.n(f),y=(a("5Dmo"),a("3S7+")),S=(a("+L6B"),a("2/Rp")),N=(a("+BJd"),a("mr32")),b=a("lwsE"),L=a.n(b),w=a("W8MJ"),x=a.n(w),D=a("a1gu"),I=a.n(D),R=a("Nsbk"),C=a.n(R),M=a("7W2i"),V=a.n(M),k=(a("OaEy"),a("2fM7")),T=(a("y8nQ"),a("Vl3Y")),B=a("q1tI"),H=a.n(B),Y=a("MuoO"),F=a("wd/R"),A=a.n(F),O=a("mf+E"),G=a("CkN6"),j=a("+n12"),z=a("9zHi"),q=a.n(z),W=a("ns75"),P=a.n(W),J=(a("Pwec"),a("CtXQ")),K=a("ZP6J"),Q=a.n(K),Z=a("8ZFW"),X=a("faNv"),_=Object(Y.connect)(function(e){return{Static:e.Static,loading:e.loading.models.Static}})(n=T.a.create()((r=i=function(e){function t(e){var a;return L()(this,t),(a=I()(this,C()(t).call(this,e))).state={openRecord:[],busStaticData:{},invalidVisible:!1},a.getDetail=function(){var e=a.props;(0,e.dispatch)({type:"Static/detail",payload:{id:e.detailID},callback:function(e){a.setState({openRecord:e.openRecord,busStaticData:e.busStaticData})}})},a.handleInvalidVisible=function(e){a.setState({invalidVisible:!!e})},a.modalSuccess=function(){var e=a.props.handleModalVisible;setTimeout(function(){e(),a.props.modalSuccess()},300)},a.title=function(){var e=a.state.busStaticData;return H.a.createElement("div",{className:Q.a.modalHeader},H.a.createElement("div",{className:Q.a.title},H.a.createElement("span",{className:Q.a.value},e.carNo),H.a.createElement("span",{className:Q.a.time},A()(e.previewTime).format("YYYY-M-D HH:mm:ss"))),H.a.createElement("div",{className:Q.a.titleRight},H.a.createElement("div",{className:Q.a.local},H.a.createElement(J.a,{type:"environment"}),H.a.createElement("a",{title:e.siteName},e.siteName)),e.reson?H.a.createElement(N.a,{style:{padding:"5px 10px",marginLeft:10},color:"red"},"数据已作废"):H.a.createElement(S.a,{type:"danger",style:{marginLeft:10},onClick:function(){return a.handleInvalidVisible(!0)}},"数据作废")))},a.columns=[{title:"操作员",dataIndex:"executor"},{title:"办理时间",dataIndex:"executorTime"},{title:"状态",dataIndex:"logType"},{title:"原因",dataIndex:"remark"}],a.myCarousel=H.a.createRef(),a}return V()(t,e),x()(t,[{key:"componentDidMount",value:function(){this.getDetail()}},{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.handleModalVisible,n=(e.loading,e.detailID),i=this.state,r=i.busStaticData,l=(i.openRecord,i.invalidVisible),o={detailID:n,modalSuccess:this.modalSuccess,handleModalVisible:this.handleInvalidVisible};return H.a.createElement(B.Fragment,null,H.a.createElement(g.a,{destroyOnClose:!0,className:Q.a.modalStyle,title:this.title(),visible:t,onCancel:function(){return a()},footer:null,width:1150},H.a.createElement(X.a,{detail:r}),r.reson?H.a.createElement("div",{className:Q.a.detailMsg,style:{marginTop:16}},H.a.createElement("div",{className:Q.a.detailMsgTitle},H.a.createElement(J.a,{type:"stop"})," 作废原因"),H.a.createElement("p",{style:{padding:"0 20px 20px"}},r.reson)):null),l?H.a.createElement(Z.a,s()({},o,{modalVisible:l})):null)}}]),t}(B.PureComponent),i.defaultProps={handleModalVisible:function(){}},n=r))||n)||n,U=["/overview/static","/overview/static/info","/overview/static/export"],$=T.a.Item,ee=k.a.Option,te=Object(Y.connect)(function(e){var t=e.Static,a=e.loading;return{system:e.system,Site:e.Site,Static:t,loading:a.models.Static}})(l=T.a.create()(l=function(e){function t(){var e,a;L()(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=I()(this,(e=C()(t)).call.apply(e,[this].concat(i)))).state={modalVisible:!1,formValues:[],siteList:[],newSiteList:[],detailID:"",organCode:"",importLoading:!1,pageBean:{page:1,pageSize:10,showTotal:!0}},a.columns=[{title:"监测站",dataIndex:"siteName"},{title:"车牌号",dataIndex:"carNo"},{title:"检测时间",dataIndex:"previewTime",width:170,render:function(e){return A()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"轴数",dataIndex:"axleNumber"},{title:"总重(t)",dataIndex:"totalLoad",render:function(e){return(e/1e3).toFixed(2)}},{title:"限重(t)",dataIndex:"weightLimited",render:function(e){return H.a.createElement(N.a,{color:"#87d068"},(e/1e3).toFixed(2)," ")}},{title:"超重(t)",dataIndex:"overLoad",render:function(e){return e>0?H.a.createElement(N.a,{color:"#f5222d"},(e/1e3).toFixed(2)):(e/1e3).toFixed(2)}},{title:"超重比(%)",dataIndex:"overLoadRate",render:function(e){return(1*e).toFixed(2)}},Object(j.c)(U[1])?{title:"操作",width:"80px",render:function(e,t){return H.a.createElement(B.Fragment,null,H.a.createElement(y.a,{placement:"left",title:"详情"},H.a.createElement(S.a,{onClick:function(){return a.showDetailModal(t.id)},type:"primary",shape:"circle",icon:"eye",size:"small"})))}}:""].filter(function(e){return e}),a.getList=function(e){(0,a.props.dispatch)({type:"Static/fetch",payload:v()({},e,{sorter:[{direction:"DESC",property:"previewTime"}]})})},a.getSiteIN=function(){return[{property:"siteCode",value:a.state.newSiteList.map(function(e){return e.code}),group:"main",operation:"IN",relation:"AND"}]},a.showDetailModal=function(e){a.setState({detailID:e}),a.handleModalVisible(!0)},a.handleStandardTableChange=function(e,t,n){var i=a.state.formValues,r={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:i.join()?i:a.getSiteIN()};a.getList(r)},a.handleFormReset=function(){var e=a.props,t=e.form,n=(e.dispatch,a.state.pageBean);t.resetFields(),a.setState({formValues:[],organCode:""});var i=Object(j.z)("organId"),r=[{property:"organCode",value:i,group:"main",operation:"RIGHT_LIKE",relation:"AND"}];a.getSite(i,function(){a.getList({pageBean:n,querys:a.getSiteIN().concat(r)})})},a.handleSearch=function(e){e.preventDefault();var t=a.props;t.dispatch;t.form.validateFields(function(e,t){if(!e){var n=a.state,i=n.pageBean,r=n.organCode,l=Object(j.z)("organId"),o=[t.siteCode?{property:"siteCode",value:t.siteCode,group:"main",operation:"IN",relation:"AND"}:a.getSiteIN()[0].value.length?a.getSiteIN()[0]:{},{property:"carNo",value:t.carNo||"",group:"main",operation:"LIKE",relation:"AND"},{property:"axleNumber",value:"other"===t.axleNumber?6:t.axleNumber||"",group:"main",operation:"other"===t.axleNumber?"GREAT":"EQUAL",relation:"AND"},{property:"previewTime",value:t.previewTime?[A()(t.previewTime[0]).format("YYYY-MM-DD HH:mm:ss"),A()(t.previewTime[1]).format("YYYY-MM-DD HH:mm:ss")]:"",group:"main",operation:"BETWEEN",relation:"AND"},{property:"totalLoad",value:t.totalLoadStart&&t.totalLoadEnd?[1e3*t.totalLoadStart,1e3*t.totalLoadEnd]:"",group:"main",operation:"BETWEEN",relation:"AND"},{property:"overLoadRate",value:t.overLoadRateStart&&t.overLoadRateEnd?[t.overLoadRateStart/100,t.overLoadRateEnd/100]:"",group:"main",operation:"BETWEEN",relation:"AND"}].filter(function(e){return e.value});o.unshift({property:"organCode",value:r||l,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),a.setState({formValues:o}),a.getList({pageBean:i,querys:o})}})},a.handleModalVisible=function(e){a.setState({modalVisible:!!e})},a.renderOption=function(){return a.state.newSiteList.map(function(e){return H.a.createElement(ee,{key:e.code,value:e.code},e.name)})},a.importClick=function(){a.setState({importLoading:!0});var e=a.props.dispatch,t=a.state,n=t.formValues;e({type:"Static/import",payload:{pageBean:t.pageBean,querys:n},callback:function(e){404===e&&E.a.error("暂无数据"),a.setState({importLoading:!1})}})},a.getSite=function(e,t){(0,a.props.dispatch)({type:"Site/siteByUserSite",payload:{organId:e,siteIds:a.state.siteList.map(function(e){return e.code})},callback:function(e){var n=e.map(function(e){return"2"===e.siteType?{code:e.siteCode,name:e.siteName}:""});a.setState({newSiteList:n}),t&&t(n)}})},a.treeSelectChange=function(e,t){a.props.form.setFieldsValue({siteCode:""}),a.getSite(e),a.setState({organCode:e})},a.modalSuccess=function(){var e=a.state,t=e.pageBean,n=e.formValues;a.getList({pageBean:t,querys:n.length?n:a.getSiteIN()})},a}return V()(t,e),x()(t,[{key:"componentDidMount",value:function(){var e=this;if(Object(j.c)(U[0])){var t=this.props.dispatch,a=this.state.pageBean;t({type:"system/userSite",payload:{siteType:2},callback:function(t){if(t.length){var n=t.map(function(e){var t=Object.keys(e);return{code:t[0],name:e[t[0]]}});e.setState({siteList:n,newSiteList:n});var i=[{property:"organCode",value:Object(j.z)("organId"),group:"main",operation:"RIGHT_LIKE",relation:"AND"}];e.getList({pageBean:a,querys:[{property:"siteCode",value:t.map(function(e){return Object.keys(e)[0]}),group:"main",operation:"IN",relation:"AND"}].concat(i)})}else g.a.error({title:"提示",content:"您没有绑定站点！！！"})}})}}},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.system.treeList,n=Object(j.z)("organId").toString(),i=this.state.importLoading;return H.a.createElement(T.a,{onSubmit:this.handleSearch,layout:"inline"},H.a.createElement(d.a,{gutter:16},H.a.createElement(u.a,{md:5,sm:24},H.a.createElement("div",{className:P.a.inputMain},H.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"所属机构"),H.a.createElement($,{style:{flex:1}},t("name")(H.a.createElement(h.a,{className:P.a.inputGroupLeftRadius,treeData:a,treeDefaultExpandedKeys:[n],style:{width:"100%"},placeholder:"请选择",onChange:this.treeSelectChange}))))),H.a.createElement(u.a,{md:5,sm:24},H.a.createElement("div",{className:P.a.inputMain},H.a.createElement("span",{style:{width:"60px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"站点"),H.a.createElement($,{style:{flex:1}},t("siteCode")(H.a.createElement(k.a,{dropdownMatchSelectWidth:!1,className:P.a.inputGroupLeftRadius,placeholder:"请选择"},this.renderOption()))))),H.a.createElement(u.a,{md:4,sm:24},H.a.createElement($,null,t("carNo")(H.a.createElement(p.a,{addonBefore:"车牌号",placeholder:"请输入"})))),H.a.createElement(u.a,{md:4,sm:24},H.a.createElement("div",{className:P.a.inputMain},H.a.createElement("span",{style:{width:"60px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"轴数"),H.a.createElement($,{style:{flex:1}},t("axleNumber")(H.a.createElement(k.a,{className:P.a.inputGroupLeftRadius,placeholder:"请选择"},H.a.createElement(ee,{value:""},"全部轴数"),H.a.createElement(ee,{value:2},"2"),H.a.createElement(ee,{value:3},"3"),H.a.createElement(ee,{value:4},"4"),H.a.createElement(ee,{value:5},"5"),H.a.createElement(ee,{value:6},"6"),H.a.createElement(ee,{value:"other"},"其他")))))),H.a.createElement(u.a,{md:6,sm:24},H.a.createElement("div",{className:P.a.inputMain},H.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"检测时间"),H.a.createElement($,{style:{flex:1}},t("previewTime")(H.a.createElement(m.a.RangePicker,{className:P.a.inputGroupLeftRadius,style:{width:"100%"},showTime:{defaultValue:[A()("00:00:00","HH:mm:ss"),A()(new Date,"HH:mm:ss")]},format:"YYYY-MM-DD HH:mm:ss"})))))),H.a.createElement(d.a,{gutter:16},H.a.createElement(u.a,{md:5,sm:24},H.a.createElement(p.a.Group,{compact:!0},H.a.createElement($,{style:{display:"inline-block",width:"50%"}},t("totalLoadStart")(H.a.createElement(p.a,{className:P.a.inputGroupRightRadius+" "+P.a.inputGroupRightborder,addonBefore:"总重(t)",placeholder:"请输入",style:{width:"100%",borderRight:0}}))),H.a.createElement($,{style:{display:"inline-block",width:"50%"}},t("totalLoadEnd")(H.a.createElement(p.a,{className:P.a.inputGroupRadiusAddon,addonBefore:"至",placeholder:"请输入",style:{width:"100%"}}))))),H.a.createElement(u.a,{md:5,sm:24},H.a.createElement(p.a.Group,{compact:!0},H.a.createElement($,{style:{display:"inline-block",width:"60%"}},t("overLoadRateStart")(H.a.createElement(p.a,{className:P.a.inputGroupRightRadius+" "+P.a.inputGroupRightborder,addonBefore:"超限幅度(%)",placeholder:"请输入",style:{width:"100%",borderRight:0}}))),H.a.createElement($,{style:{display:"inline-block",width:"40%"}},t("overLoadRateEnd")(H.a.createElement(p.a,{className:P.a.inputGroupRadiusAddon,addonBefore:"至",placeholder:"请输入",style:{width:"100%"}}))))),H.a.createElement(u.a,{md:6,sm:24,style:{float:"right"}},H.a.createElement("div",{className:q.a.submitButtons,style:{float:"right"}},H.a.createElement(S.a,{type:"primary",htmlType:"submit"},"查询"),H.a.createElement(S.a,{className:P.a.import,icon:"import",onClick:this.importClick,loading:i,disabled:i,style:{marginLeft:8}},"导出"),H.a.createElement(S.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this.props,t=e.Static.data,a=e.loading,n=this.state,i=n.modalVisible,r=n.detailID,l={handleModalVisible:this.handleModalVisible,detailID:r,modalSuccess:this.modalSuccess};return H.a.createElement(B.Fragment,null,Object(j.c)(U[0])?null:H.a.createElement(O.a,{to:"/exception/403"}),H.a.createElement(c.a,{bordered:!1},H.a.createElement("div",{className:q.a.tableList},H.a.createElement("div",{className:q.a.tableListForm},this.renderSimpleForm()),H.a.createElement(G.a,{tableAlert:!1,selectedRows:0,rowSelection:null,loading:a,data:t,size:"middle",columns:this.columns,onChange:this.handleStandardTableChange}))),i&&r?H.a.createElement(_,s()({},l,{modalVisible:i})):null)}}]),t}(B.PureComponent))||l)||l;t.default=te}}]);