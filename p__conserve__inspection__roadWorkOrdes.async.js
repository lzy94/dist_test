(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{dhjb:function(e,a,t){"use strict";t.r(a);var l,n,r,o=t("pVnL"),i=t.n(o),c=(t("IzEo"),t("bx4M")),s=(t("14J3"),t("BMrR")),d=(t("jCWc"),t("kPKH")),m=(t("5NDa"),t("5rEg")),u=t("MVZn"),p=t.n(u),f=(t("miYZ"),t("tsqr")),h=(t("P2fV"),t("NJEC")),E=(t("/zsF"),t("PArb")),g=(t("5Dmo"),t("3S7+")),y=(t("+L6B"),t("2/Rp")),b=t("lwsE"),v=t.n(b),k=t("W8MJ"),M=t.n(k),S=t("a1gu"),w=t.n(S),C=t("Nsbk"),V=t.n(C),I=t("7W2i"),N=t.n(I),O=(t("OaEy"),t("2fM7")),z=(t("y8nQ"),t("Vl3Y")),D=t("q1tI"),F=t.n(D),T=t("MuoO"),R=t("CkN6"),W=(t("2qtc"),t("kLXV")),L=(t("Mwp2"),t("VXEj")),x=(t("Telt"),t("Tckk")),B=(t("bP8k"),t("gFTJ")),Y=t("ZP6J"),A=t.n(Y),q=t("Py4S"),j=t.n(q),P=t("+n12"),U=t("z9xO"),H=t.n(U),J=t("wd/R"),X=t.n(J),Z=function(e){function a(){var e,t;v()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=w()(this,(e=V()(a)).call.apply(e,[this].concat(n)))).renderScore=function(e){for(var a=0,t=0;t<e.length;t++)a+=e[t].delScore;return a},t}return N()(a,e),M()(a,[{key:"render",value:function(){var e=this.props,a=e.modalVisible,t=e.handleModalVisible,l=e.detail,n=[l.roadWorkOrdes,l.roadConserveCompany,l.roadConserveExamine],r=n[0],o=n[1],i=n[2],c={fontSize:16,fontWeight:"bold",color:"#2A5298",float:"left"},s={float:"right",fontSize:12,color:"#80848D",fontWeight:"500"},d=F.a.createElement("div",{style:{overflow:"hidden"}},F.a.createElement("h3",{style:c},F.a.createElement("span",{className:"".concat(H.a.iconfont," ").concat(H.a["icon-gongsi"])})," 公司信息"),F.a.createElement("p",{style:s},"本月得分：",F.a.createElement("span",{style:{fontSize:18,color:"#F9271C"}},100-this.renderScore(i)))),m=F.a.createElement("div",{style:{overflow:"hidden"}},F.a.createElement("h3",{style:c},F.a.createElement("span",{className:"".concat(H.a.iconfont," ").concat(H.a["icon-renwu"])})," 养护任务"),F.a.createElement("p",{style:s},"状态：",F.a.createElement("span",{style:{fontSize:16,color:"#1C8FF9"}},1===r.state?"已派出":"已完成")));return F.a.createElement(W.a,{destroyOnClose:!0,title:"工单详情",className:"".concat(A.a.myModal," ").concat(A.a.modalbody),visible:a,width:700,onCancel:function(){return t()},footer:null},F.a.createElement("div",{className:A.a.detailMsg},F.a.createElement("div",{style:{padding:20}},F.a.createElement(B.a,{title:d,bordered:!0,size:"small",column:2},F.a.createElement(B.a.Item,{label:"公司名称"},o.companyName),F.a.createElement(B.a.Item,{label:"负责人"},o.companyHeader),F.a.createElement(B.a.Item,{label:"联系电话",span:2},o.companyTel),F.a.createElement(B.a.Item,{label:"签订内容",span:2},o.agreement)))),F.a.createElement("div",{className:A.a.detailMsg,style:{marginTop:10}},F.a.createElement("div",{style:{padding:20}},F.a.createElement(B.a,{title:m,bordered:!0,size:"small",column:2},F.a.createElement(B.a.Item,{label:"所在地点"},r.curingAddr),F.a.createElement(B.a.Item,{label:"负责人"},r.curinger),F.a.createElement(B.a.Item,{label:"开始时间"},X()(r.checkTime).format("YYYY-MM-DD")),F.a.createElement(B.a.Item,{label:"限定完成时间"},X()(r.endTime).format("YYYY-MM-DD")),F.a.createElement(B.a.Item,{label:"完成情况",span:2},r.completionStatus),F.a.createElement(B.a.Item,{label:"养护原因",span:2},r.curingContent),F.a.createElement(B.a.Item,{label:"工作内容",span:2},r.workContent)))),F.a.createElement("div",{className:A.a.detailMsg,style:{marginTop:10}},F.a.createElement("div",{style:{padding:20,overflow:"hidden"}},F.a.createElement("div",{style:{overflow:"hidden"}},F.a.createElement("h3",{style:c},F.a.createElement("span",{className:"".concat(H.a.iconfont," ").concat(H.a["icon-tupian"])})," 图片")),r.imgUrl?r.imgUrl.split(",").map(function(e,a){return F.a.createElement("div",{key:a,style:{overflow:"hidden",width:195,height:195,float:"left",marginRight:10}},F.a.createElement(j.a,{backdrop:"rgba(255,255,255,.3)",src:P.E+e,alt:"图片",style:{width:"100%",height:"195px"}}))}):null)),i.length?F.a.createElement("div",{className:A.a.detailMsg,style:{marginTop:10}},F.a.createElement("div",{style:{padding:20}},F.a.createElement("div",{style:{overflow:"hidden"}},F.a.createElement("h3",{style:p()({},c,{float:"none"})},F.a.createElement("span",{className:"".concat(H.a.iconfont," ").concat(H.a["icon-tubiao_fenshu"])},"本月绩效考核信息")),F.a.createElement("p",{style:s},"总扣分：",F.a.createElement("span",{style:{fontSize:18,color:"#F9271C"}},this.renderScore(i)))),F.a.createElement(L.a,{itemLayout:"horizontal",dataSource:i,renderItem:function(e){return F.a.createElement(L.a.Item,null,F.a.createElement(L.a.Item.Meta,{avatar:F.a.createElement(x.a,{shape:"square",size:60,src:P.E+e.evidence}),title:"罚款：".concat(e.fine,"   扣分：").concat(e.delScore),description:"扣分原因：".concat(e.reson)}))}}))):null)}}]),a}(D.PureComponent),Q=(t("DZo9"),t("8z0m")),K=(t("Pwec"),t("CtXQ")),_=(t("giR+"),t("fyUT")),G=z.a.Item,$=Object(T.connect)(function(e){return{RoadWorkOrdes:e.RoadWorkOrdes,loading:e.loading.models.RoadWorkOrdes}})(l=z.a.create()(l=function(e){function a(){var e,t;v()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=w()(this,(e=V()(a)).call.apply(e,[this].concat(n)))).state={fileList:[]},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",className:"upload-list-inline",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(P.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},onChange:t.uploadChange}},t.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(f.a.success("上传成功"),t.setState({fileList:e.fileList})):f.a.error(e.file.response.code.msg):"error"===e.file.status?f.a.error("上传失败"):"removed"===e.file.status&&t.setState({fileList:e.fileList})},t.save=function(){var e=t.props,a=e.form,l=e.dispatch,n=e.handleModalVisible,r=e.modalSuccess,o=e.detail;a.validateFields(function(e,a){if(!e){var t=p()({},a);t.evidence=t.evidence?t.evidence.file.response.filePath:"",t.companyId=o.id,t.companyName=o.companyName,l({type:"RoadWorkOrdes/addExamineInfoData",payload:t,callback:function(){f.a.success("评分成功成功"),n(),r()}})}})},t}return N()(a,e),M()(a,[{key:"render",value:function(){var e=this,a=this.props,t=a.modalVisible,l=a.handleModalVisible,n=a.form,r=a.loading,o=this.state.fileList;return F.a.createElement(W.a,{destroyOnClose:!0,title:"评分",className:A.a.formModal,visible:t,onCancel:function(){return l()},footer:[F.a.createElement(y.a,{key:"submit",type:"primary",loading:r,onClick:function(){return e.save()}},"确定")]},F.a.createElement("div",{className:A.a.formModalBody},F.a.createElement(G,{label:"扣分"},n.getFieldDecorator("delScore",{rules:[{required:!0,message:"请输入扣分分数"}]})(F.a.createElement(_.a,{style:{width:"100%"},placeholder:"请输入"}))),F.a.createElement(G,{label:"罚款"},n.getFieldDecorator("fine",{rules:[{required:!0,message:"请输入罚款数"}]})(F.a.createElement(_.a,{style:{width:"100%"},placeholder:"请输入"}))),F.a.createElement(G,{label:"取证照片"},n.getFieldDecorator("evidence",{rules:[{required:!0,message:"请上传取证照片！"}]})(F.a.createElement(Q.a,i()({},this.uploadConfig(),{defaultFileList:o}),o.length>0?null:F.a.createElement(y.a,null,F.a.createElement(K.a,{type:"upload"})," 请上传取证照片")))),F.a.createElement(G,{label:"原因"},n.getFieldDecorator("reson",{rules:[{required:!0,reson:"请输入原因"}]})(F.a.createElement(m.a.TextArea,{rows:4,placeholder:"请输入"})))))}}]),a}(D.PureComponent))||l)||l,ee=z.a.Item,ae=Object(T.connect)(function(e){return{RoadWorkOrdes:e.RoadWorkOrdes,loading:e.loading.models.RoadWorkOrdes}})(n=z.a.create()(n=function(e){function a(){var e,t;v()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=w()(this,(e=V()(a)).call.apply(e,[this].concat(n)))).state={scoreModalVisible:!1},t.scoreHandleModalVisible=function(e){t.setState({scoreModalVisible:!!e})},t.modalSuccess=function(){var e=t.props,a=e.modalSuccess,l=e.handleModalVisible;a(),l()},t.save=function(){var e=t.props,a=e.dispatch,l=e.detail;e.form.validateFields(function(e,n){if(!e){var r=p()({id:l.roadWorkOrdes.id},n);a({type:"RoadWorkOrdes/orderCompelete",payload:r,callback:function(){f.a.success("工单已完成"),t.scoreHandleModalVisible(!0)}})}})},t}return N()(a,e),M()(a,[{key:"render",value:function(){var e=this,a=this.state.scoreModalVisible,t=this.props,l=t.modalVisible,n=t.handleModalVisible,r=t.detail,o=t.loading,c=t.form,s=[r.roadWorkOrdes,r.roadConserveCompany,r.roadConserveExamine],d=s[0],u=s[1],p={detail:u,modalSuccess:this.modalSuccess,handleModalVisible:this.scoreHandleModalVisible},f={fontSize:16,fontWeight:"bold",color:"#2A5298",float:"left"},h=F.a.createElement("div",{style:{overflow:"hidden"}},F.a.createElement("h3",{style:f},F.a.createElement("span",{className:"".concat(H.a.iconfont," ").concat(H.a["icon-gongsi"])})," 公司信息")),E=F.a.createElement("div",{style:{overflow:"hidden"}},F.a.createElement("h3",{style:f},F.a.createElement("span",{className:"".concat(H.a.iconfont," ").concat(H.a["icon-renwu"])})," 养护任务"),F.a.createElement("p",{style:{float:"right",fontSize:12,color:"#80848D",fontWeight:"500"}},"状态：",F.a.createElement("span",{style:{fontSize:16,color:"#1C8FF9"}},1===d.state?"已派出":"已完成")));return F.a.createElement(D.Fragment,null,F.a.createElement(W.a,{destroyOnClose:!0,title:"工单详情",className:A.a.formModal,visible:l,width:700,onCancel:function(){return n()},footer:[F.a.createElement(y.a,{key:"back",onClick:function(){return n()}},"取消"),F.a.createElement(y.a,{loading:o,key:"submit",type:"primary",onClick:function(){return e.save()}},"完成")]},F.a.createElement("div",{className:A.a.detailMsg},F.a.createElement("div",{style:{padding:20}},F.a.createElement(B.a,{title:h,bordered:!0,size:"small",column:2},F.a.createElement(B.a.Item,{label:"公司名称"},u.companyName),F.a.createElement(B.a.Item,{label:"负责人"},u.companyHeader),F.a.createElement(B.a.Item,{label:"联系电话",span:2},u.companyTel),F.a.createElement(B.a.Item,{label:"签订内容",span:2},u.agreement)))),F.a.createElement("div",{className:A.a.detailMsg,style:{marginTop:10}},F.a.createElement("div",{style:{padding:20}},F.a.createElement(B.a,{title:E,bordered:!0,size:"small",column:2},F.a.createElement(B.a.Item,{label:"所在地点"},d.curingAddr),F.a.createElement(B.a.Item,{label:"负责人"},d.curinger),F.a.createElement(B.a.Item,{label:"开始时间"},X()(d.checkTime).format("YYYY-MM-DD")),F.a.createElement(B.a.Item,{label:"限定完成时间"},X()(d.endTime).format("YYYY-MM-DD")),F.a.createElement(B.a.Item,{label:"养护原因",span:2},d.curingContent),F.a.createElement(B.a.Item,{label:"工作内容",span:2},d.workContent)))),F.a.createElement("div",{className:A.a.detailMsg,style:{marginTop:10}},F.a.createElement("div",{style:{padding:20,overflow:"hidden"}},F.a.createElement("div",{style:{overflow:"hidden"}},F.a.createElement("h3",{style:f},F.a.createElement("span",{className:"".concat(H.a.iconfont," ").concat(H.a["icon-tupian"])})," 图片")),d.imgUrl?d.imgUrl.split(",").map(function(e,a){return F.a.createElement("div",{key:a,style:{overflow:"hidden",width:195,height:195,float:"left",marginRight:10}},F.a.createElement(j.a,{backdrop:"rgba(255,255,255,.3)",src:P.E+e,alt:"图片",style:{width:"100%",height:"195px"}}))}):null)),F.a.createElement("div",{className:A.a.detailMsg,style:{marginTop:10}},F.a.createElement("div",{style:{padding:20}},F.a.createElement(ee,{label:"完成情况",style:{marginBottom:0}},c.getFieldDecorator("completionStatus",{rules:[{required:!0,message:"请输入完成情况！"}]})(F.a.createElement(m.a.TextArea,{autosize:!0,placeholder:"请输入"})))))),a?F.a.createElement($,i()({},p,{modalVisible:a})):null)}}]),a}(D.PureComponent))||n)||n,te=t("9zHi"),le=t.n(te),ne=t("ns75"),re=t.n(ne),oe=z.a.Item,ie=O.a.Option,ce=Object(T.connect)(function(e){return{RoadWorkOrdes:e.RoadWorkOrdes,loading:e.loading.models.RoadWorkOrdes}})(r=z.a.create()(r=function(e){function a(){var e,t;v()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=w()(this,(e=V()(a)).call.apply(e,[this].concat(n)))).state={modalVisible:!1,updateModalVisible:!1,formValues:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"工单编号",dataIndex:"orderNo"},{title:"企业名称",dataIndex:"companyName"},{title:"养护地点",dataIndex:"curingAddr"},{title:"养护内容",dataIndex:"curingContent"},{title:"负责人",dataIndex:"curinger"},{title:"状态",dataIndex:"state",render:function(e){return 1===e?"已派出":2===e?"已完成":""}},{title:"操作",width:90,render:function(e,a){return F.a.createElement(D.Fragment,null,2===a.state?F.a.createElement(g.a,{placement:"left",title:"详情"},F.a.createElement(y.a,{onClick:function(){return t.getDetail(a.id)},type:"primary",shape:"circle",icon:"eye",size:"small"})):F.a.createElement(g.a,{placement:"left",title:"完成"},F.a.createElement(y.a,{onClick:function(){return t.edit(a.id)},type:"primary",shape:"circle",icon:"edit",size:"small"})),F.a.createElement(E.a,{type:"vertical"}),F.a.createElement(h.a,{title:1===a.state?"当前状态已派出是否删除数据?":"是否删除数据?",okType:1===a.state?"danger":"primary",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},F.a.createElement(g.a,{placement:"left",title:"删除"},F.a.createElement(y.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.dataDel=function(e){(0,t.props.dispatch)({type:"RoadWorkOrdes/remove",payload:{ids:e},callback:function(){f.a.success("删除成功");var e=t.state.pageBean;t.getList({pageBean:e})}})},t.edit=function(e){(0,t.props.dispatch)({type:"RoadWorkOrdes/detail",payload:e,callback:function(e){return t.setState({detail:e},function(){return t.handleUpdateModalVisible(!0)})}})},t.getDetail=function(e){(0,t.props.dispatch)({type:"RoadWorkOrdes/detail",payload:e,callback:function(e){return t.setState({detail:e},function(){return t.handleModalVisible(!0)})}})},t.getList=function(e){(0,t.props.dispatch)({type:"RoadWorkOrdes/fetch",payload:e})},t.handleStandardTableChange=function(e){var a=t.state.formValues,l={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:a};t.getList(l)},t.handleFormReset=function(){t.props.form.resetFields(),t.setState({formValues:[]});var e=t.state.pageBean;t.getList({pageBean:e})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var l=t.state.pageBean,n=p()({},a),r=Object.keys(n).map(function(e){return n[e]?{property:e,value:n[e],group:"main",operation:"state"===e?"EQUAL":"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:r}),t.getList({pageBean:l,querys:r})}})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e})},t.modalSuccess=function(){var e=t.state.pageBean;t.getList({pageBean:e})},t}return N()(a,e),M()(a,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return F.a.createElement(z.a,{onSubmit:this.handleSearch,layout:"inline"},F.a.createElement(s.a,{gutter:{md:8,lg:16,xl:16}},F.a.createElement(d.a,{md:6,sm:24},F.a.createElement(oe,null,e("companyName")(F.a.createElement(m.a,{addonBefore:"公司名称",placeholder:"请输入"})))),F.a.createElement(d.a,{md:6,sm:24},F.a.createElement("div",{className:re.a.inputMain},F.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"养护状态"),F.a.createElement(oe,{style:{flex:1}},e("state")(F.a.createElement(O.a,{placeholder:"请选择",style:{width:"100%"}},F.a.createElement(ie,{value:1},"已派出"),F.a.createElement(ie,{value:2},"已完成")))))),F.a.createElement(d.a,{md:8,sm:24},F.a.createElement("span",{className:le.a.submitButtons},F.a.createElement(y.a,{type:"primary",htmlType:"submit"},"查询"),F.a.createElement(y.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this.props,a=e.RoadWorkOrdes.data,t=e.loading,l=this.state,n=l.modalVisible,r=l.detail,o=l.updateModalVisible,s={detail:r,handleModalVisible:this.handleModalVisible},d={detail:r,modalSuccess:this.modalSuccess,handleModalVisible:this.handleUpdateModalVisible};return F.a.createElement(D.Fragment,null,F.a.createElement(c.a,{bordered:!1},F.a.createElement("div",{className:le.a.tableList},F.a.createElement("div",{className:le.a.tableListForm},this.renderSimpleForm()),F.a.createElement(R.a,{size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:t,data:a,columns:this.columns,onChange:this.handleStandardTableChange}))),n&&Object.keys(r).length?F.a.createElement(Z,i()({},s,{modalVisible:n})):null,o&&Object.keys(r).length?F.a.createElement(ae,i()({},d,{modalVisible:o})):null)}}]),a}(D.PureComponent))||r)||r;a.default=ce}}]);