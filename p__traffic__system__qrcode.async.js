(window.webpackJsonp=window.webpackJsonp||[]).push([[185],{"0xt2":function(e,t,a){"use strict";a.r(t);a("IzEo");var n,i=a("bx4M"),l=(a("miYZ"),a("tsqr")),r=a("lwsE"),o=a.n(r),s=a("W8MJ"),d=a.n(s),c=a("a1gu"),u=a.n(c),p=a("Nsbk"),f=a.n(p),h=a("7W2i"),m=a.n(h),g=(a("2qtc"),a("kLXV")),b=(a("5NDa"),a("5rEg")),y=(a("DZo9"),a("8z0m")),v=a("pVnL"),E=a.n(v),C=(a("+L6B"),a("2/Rp")),L=(a("Pwec"),a("CtXQ")),q=a("MVZn"),V=a.n(q),k=(a("y8nQ"),a("Vl3Y")),S=a("q1tI"),w=a.n(S),Q=a("MuoO"),A=a("+n12"),D=a("15hv"),M=a.n(D),j=a("ZP6J"),O=a.n(j),x=k.a.Item,z=k.a.create()(function(e){var t=e.form,a=e.fileList,n=e.visible,i=e.handleVisible,l=e.handleAdd,r=e.uploadChange,o=e.detail,s={name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",data:{type:9,xbType:""},headers:{Authorization:"Bearer ".concat(Object(A.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:A.D,onChange:r};return w.a.createElement(g.a,{destroyOnClose:!0,title:"上传二维码",className:O.a.formModal,visible:n,onOk:function(){t.validateFields(function(e,a){if(!e){var n=V()({},a);Object.keys(o).length&&(n.id=o.id),l(n,function(){return t.resetFields()})}})},onCancel:function(){return i()}},w.a.createElement(x,{label:"图片"},t.getFieldDecorator("qrCode",{initialValue:o.qrCode})(w.a.createElement(y.a,E()({},s,{defaultFileList:a}),a.length>0?null:w.a.createElement(C.a,null,w.a.createElement(L.a,{type:"upload"})," 图片")))),w.a.createElement(x,{label:"版本号"},t.getFieldDecorator("qrVersion",{initialValue:o.qrVersion})(w.a.createElement(b.a,{placeholder:"请输入"}))))}),F=Object(Q.connect)(function(e){return{QrcodeSystem:e.QrcodeSystem,loading:e.loading.models.QrcodeSystem}})(n=k.a.create()(n=function(e){function t(){var e,a;o()(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=u()(this,(e=f()(t)).call.apply(e,[this].concat(i)))).state={visible:!1,fileList:[]},a.getList=function(){(0,a.props.dispatch)({type:"QrcodeSystem/fetch",payload:{pageBean:{page:1,pageSize:1,showTotal:!0}},callback:function(){var e=a.props.QrcodeSystem.data;e.length&&a.setState({fileList:[{uid:"-1",name:"App 二维码",status:"done",url:A.E+e[0].qrCode,thumbUrl:A.E+e[0].qrCode}]})}})},a.handleVisible=function(e){a.setState({visible:!!e})},a.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(l.a.success("上传成功"),a.setState({fileList:e.fileList})):l.a.error(e.file.response.code.msg):"error"===e.file.status?l.a.error("上传失败"):"removed"===e.file.status&&a.setState({fileList:e.fileList})},a.handleAdd=function(e){var t=V()({},e);if("object"==typeof e.qrCode){var n=e.qrCode.file.response;t.qrCode=n?n.filePath:""}(0,a.props.dispatch)({type:"QrcodeSystem/saveData",payload:t,callback:function(){a.handleVisible(),a.getList()}})},a}return m()(t,e),d()(t,[{key:"componentDidMount",value:function(){this.getList()}},{key:"render",value:function(){var e=this,t=this.props.QrcodeSystem.data,a=this.state,n=a.visible,l=a.fileList,r=t.length?A.E+t[0].qrCode:M.a;return w.a.createElement(i.a,{bordered:!1,style:{height:"100%"}},w.a.createElement(C.a,{style:{marginBottom:10},type:"primary",onClick:function(){return e.handleVisible(!0)}},w.a.createElement(L.a,{type:"upload"})," 上传二维码"),w.a.createElement("br",null),w.a.createElement("img",{style:{maxWidth:"100%"},src:r,alt:""}),n&&w.a.createElement(z,{visible:n,fileList:l,detail:t.length?t[0]:{},handleAdd:this.handleAdd,uploadChange:this.uploadChange,handleVisible:this.handleVisible}))}}]),t}(S.PureComponent))||n)||n;t.default=F}}]);