(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{Gx1g:function(e,a,t){"use strict";t.r(a);var l,n,r,i,o,s,c,d=t("pVnL"),u=t.n(d),m=(t("IzEo"),t("bx4M")),p=(t("14J3"),t("BMrR")),g=(t("jCWc"),t("kPKH")),f=(t("5NDa"),t("5rEg")),h=(t("miYZ"),t("tsqr")),E=(t("2qtc"),t("kLXV")),y=(t("P2fV"),t("NJEC")),b=(t("/zsF"),t("PArb")),v=(t("5Dmo"),t("3S7+")),k=(t("+L6B"),t("2/Rp")),C=t("lwsE"),M=t.n(C),V=t("W8MJ"),D=t.n(V),w=t("a1gu"),S=t.n(w),F=t("Nsbk"),B=t.n(F),q=t("7W2i"),L=t.n(q),x=(t("y8nQ"),t("Vl3Y")),j=t("q1tI"),T=t.n(j),U=t("MuoO"),N=t("CkN6"),I=(t("DZo9"),t("8z0m")),O=(t("Pwec"),t("CtXQ")),R=(t("iQDF"),t("+eQT")),z=t("MVZn"),P=t.n(z),A=(t("OaEy"),t("2fM7")),Y=t("+n12"),J=t("YP4+"),H=t("ZP6J"),Q=t.n(H),X=x.a.Item,Z=A.a.Option,W=Object(U.connect)(function(e){return{BuildManagementlogs:e.BuildManagementlogs,loading:e.loading.models.BuildManagementlogs}})(l=x.a.create()((r=n=function(e){function a(){var e,t;M()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=S()(this,(e=B()(a)).call.apply(e,[this].concat(n)))).state={fileList:[],cateIndex:0},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",className:"upload-list-inline",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(Y.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:Y.D,onChange:t.uploadChange}},t.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(h.a.success("上传成功"),t.setState({fileList:e.fileList})):h.a.error(e.file.response.code.msg):"error"===e.file.status?h.a.error("上传失败"):"removed"===e.file.status&&t.setState({fileList:e.fileList})},t.save=function(){var e=t.props,a=e.dispatch,l=e.form,n=e.modalCallback,r=t.state.fileList;l.validateFields(function(e,l){if(!e)if(r.length){var i=P()({},l,{annexUrl:r.length?r.map(function(e){return e.response.filePath}).join():""});a({type:"BuildManagementlogs/add",payload:i,callback:function(){h.a.success("添加成功"),n(),t.cancelClick()}})}else h.a.error("请选择图片")})},t.cancelClick=function(){(0,t.props.handleModalVisible)()},t.cateChange=function(e,a){var l=a.props.index,n=t.props.form;t.setState({cateIndex:l}),n.setFieldsValue({detailedType:void 0})},t}return L()(a,e),D()(a,[{key:"render",value:function(){var e=this.props,a=e.loading,t=e.modalVisible,l=e.form,n=this.state,r=n.fileList,i=n.cateIndex;return T.a.createElement(E.a,{destroyOnClose:!0,title:"新建管理日志",className:Q.a.formModal,visible:t,onCancel:this.cancelClick,width:800,footer:[T.a.createElement(k.a,{key:"back",onClick:this.cancelClick},"取消"),T.a.createElement(k.a,{key:"submit",type:"primary",loading:a,onClick:this.save},"确定")]},T.a.createElement("div",{className:Q.a.formModalBody},T.a.createElement(p.a,{gutter:20},T.a.createElement(g.a,{span:12},T.a.createElement(X,{label:"项目名称"},l.getFieldDecorator("projectName",{rules:[{required:!0,message:"请输入项目名称！"}]})(T.a.createElement(f.a,{placeholder:"请输入"}))),T.a.createElement(X,{label:"巡查人"},l.getFieldDecorator("recorder",{rules:[{required:!0,message:"请输入巡查人！"}]})(T.a.createElement(f.a,{placeholder:"请输入"}))),T.a.createElement(X,{label:"巡查时间"},l.getFieldDecorator("recordTime",{rules:[{required:!0,message:"请选择巡查时间！"}]})(T.a.createElement(R.a,{style:{width:"100%"},placeholder:"请输入"}))),T.a.createElement(X,{label:"问题描述"},l.getFieldDecorator("situationDescription",{rules:[{required:!0,message:"请输入问题描述！"}]})(T.a.createElement(f.a.TextArea,{placeholder:"请输入"}))),T.a.createElement(X,{label:"整改要求"},l.getFieldDecorator("relatedSuggestions",{rules:[{required:!0,message:"请输入整改要求"}]})(T.a.createElement(f.a.TextArea,{placeholder:"请输入"})))),T.a.createElement(g.a,{span:12},T.a.createElement(X,{label:"问题分类"},l.getFieldDecorator("questionCategory",{initialValue:J.b[0],rules:[{required:!0,message:"请选择问题分类"}]})(T.a.createElement(A.a,{style:{width:"100%"},placeholder:"请选择",onChange:this.cateChange},J.b.map(function(e,a){return T.a.createElement(Z,{value:e,key:e,index:a},e)})))),T.a.createElement(X,{label:"具体类型"},l.getFieldDecorator("detailedType",{rules:[{required:!0,message:"请选择具体类型"}]})(T.a.createElement(A.a,{style:{width:"100%"},placeholder:"请选择"},J.c[i].map(function(e){return T.a.createElement(Z,{value:e,key:e},e)})))),T.a.createElement(X,{label:"责任单位"},l.getFieldDecorator("dutyUnit",{rules:[{required:!0,message:"请选择责任单位"}]})(T.a.createElement(A.a,{style:{width:"100%"},placeholder:"请选择"},J.d.map(function(e){return T.a.createElement(Z,{value:e,key:e},e)})))),T.a.createElement(X,{label:"整改情况"},l.getFieldDecorator("rectifySituation",{rules:[{required:!0,message:"请选择整改情况"}]})(T.a.createElement(A.a,{style:{width:"100%"},placeholder:"请选择"},J.e.map(function(e){return T.a.createElement(Z,{value:e,key:e},e)})))),T.a.createElement(X,{label:"附件"},l.getFieldDecorator("annexUrl",{rules:[{required:!0,message:"请上传图片"}]})(T.a.createElement(I.a,u()({},this.uploadConfig(),{defaultFileList:r}),T.a.createElement(k.a,null,T.a.createElement(O.a,{type:"upload"})," 请上传图片(jpg,jpeg,png)"))))))))}}]),a}(j.PureComponent),n.defaultProps={modalVisible:!1,handleModalVisible:function(){},modalCallback:function(){}},l=r))||l)||l,K=t("wd/R"),G=t.n(K),$=x.a.Item,_=A.a.Option,ee=Object(U.connect)(function(e){return{BuildManagementlogs:e.BuildManagementlogs,loading:e.loading.models.BuildManagementlogs}})(i=x.a.create()((s=o=function(e){function a(){var e,t;M()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=S()(this,(e=B()(a)).call.apply(e,[this].concat(n)))).state={fileList:[],detail:{},isSet:!1,cateIndex:0},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",className:"upload-list-inline",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(Y.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:Y.D,onChange:t.uploadChange}},t.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(h.a.success("上传成功"),t.setState({fileList:e.fileList})):h.a.error(e.file.response.code.msg):"error"===e.file.status?h.a.error("上传失败"):"removed"===e.file.status&&t.setState({fileList:e.fileList})},t.save=function(){var e=t.props,a=e.dispatch,l=e.form,n=e.modalCallback,r=t.state,i=r.fileList,o=r.detail;l.validateFields(function(e,l){if(!e)if(i.length){var r=P()({},o);l.annexUrl=i.map(function(e){return e.url?e.path:e.response.filePath}).join();for(var s=Object.keys(l),c=0;c<s.length;c+=1)r[s[c]]=l[s[c]];t.setState({detail:r}),a({type:"BuildManagementlogs/add",payload:r,callback:function(){h.a.success("编辑成功"),n(),t.cancelClick()}})}else h.a.error("请选择图片")})},t.cancelClick=function(){(0,t.props.handleModalVisible)()},t.cateChange=function(e,a){var l=a.props.index,n=t.props.form;t.setState({cateIndex:l}),n.setFieldsValue({detailedType:void 0})},t}return L()(a,e),D()(a,[{key:"render",value:function(){var e=this.props,a=e.loading,t=e.modalVisible,l=e.form,n=this.state,r=n.fileList,i=n.detail,o=n.cateIndex;return T.a.createElement(E.a,{destroyOnClose:!0,title:"编辑管理日志",className:Q.a.formModal,visible:t,onCancel:this.cancelClick,width:800,footer:[T.a.createElement(k.a,{key:"back",onClick:this.cancelClick},"取消"),T.a.createElement(k.a,{key:"submit",type:"primary",loading:a,onClick:this.save},"确定")]},T.a.createElement("div",{className:Q.a.formModalBody},T.a.createElement(p.a,{gutter:20},T.a.createElement(g.a,{span:12},T.a.createElement($,{label:"项目名称"},l.getFieldDecorator("projectName",{initialValue:i.projectName,rules:[{required:!0,message:"请输入项目名称！"}]})(T.a.createElement(f.a,{placeholder:"请输入"}))),T.a.createElement($,{label:"巡查人"},l.getFieldDecorator("recorder",{initialValue:i.recorder,rules:[{required:!0,message:"请输入巡查人！"}]})(T.a.createElement(f.a,{placeholder:"请输入"}))),T.a.createElement($,{label:"巡查时间"},l.getFieldDecorator("recordTime",{initialValue:G()(new Date(i.recordTime),"YYYY-MM-DD"),rules:[{required:!0,message:"请选择巡查时间！"}]})(T.a.createElement(R.a,{style:{width:"100%"},placeholder:"请输入"}))),T.a.createElement($,{label:"问题描述"},l.getFieldDecorator("situationDescription",{initialValue:i.situationDescription,rules:[{required:!0,message:"请输入问题描述！"}]})(T.a.createElement(f.a.TextArea,{placeholder:"请输入"}))),T.a.createElement($,{label:"整改要求"},l.getFieldDecorator("relatedSuggestions",{initialValue:i.relatedSuggestions,rules:[{required:!0,message:"请输入整改要求"}]})(T.a.createElement(f.a.TextArea,{placeholder:"请输入"})))),T.a.createElement(g.a,{span:12},T.a.createElement($,{label:"问题分类"},l.getFieldDecorator("questionCategory",{initialValue:i.questionCategory,rules:[{required:!0,message:"请选择问题分类"}]})(T.a.createElement(A.a,{style:{width:"100%"},placeholder:"请选择",onChange:this.cateChange},J.b.map(function(e,a){return T.a.createElement(_,{value:e,key:e,index:a},e)})))),T.a.createElement($,{label:"具体类型"},l.getFieldDecorator("detailedType",{initialValue:i.detailedType,rules:[{required:!0,message:"请选择具体类型"}]})(T.a.createElement(A.a,{style:{width:"100%"},placeholder:"请选择"},J.c[o].map(function(e){return T.a.createElement(_,{value:e,key:e},e)})))),T.a.createElement($,{label:"责任单位"},l.getFieldDecorator("dutyUnit",{initialValue:i.dutyUnit,rules:[{required:!0,message:"请选择责任单位"}]})(T.a.createElement(A.a,{style:{width:"100%"},placeholder:"请选择"},J.d.map(function(e){return T.a.createElement(_,{value:e,key:e},e)})))),T.a.createElement($,{label:"整改情况"},l.getFieldDecorator("rectifySituation",{initialValue:i.rectifySituation,rules:[{required:!0,message:"请选择整改情况"}]})(T.a.createElement(A.a,{style:{width:"100%"},placeholder:"请选择"},J.e.map(function(e){return T.a.createElement(_,{value:e,key:e},e)})))),T.a.createElement($,{label:"附件"},l.getFieldDecorator("annexUrl",{initialValue:i.annexUrl,rules:[{required:!0,message:"请上传图片"}]})(T.a.createElement(I.a,u()({},this.uploadConfig(),{defaultFileList:r}),T.a.createElement(k.a,null,T.a.createElement(O.a,{type:"upload"})," 请上传图片(jpg,jpeg,png)"))))))))}}],[{key:"getDerivedStateFromProps",value:function(e,a){var t=e.detail,l=a.isSet;return l?null:{isSet:!l,detail:t,cateIndex:J.b.includes(t.questionCategory)?J.b.indexOf(t.questionCategory):0,fileList:t.annexUrl?t.annexUrl.split(",").map(function(e,a){return{uid:a,name:"当前图片",status:"done",url:Y.E+e,path:e}}):[]}}}]),a}(j.PureComponent),o.defaultProps={modalVisible:!1,handleModalVisible:function(){},modalCallback:function(){}},i=s))||i)||i,ae=t("9zHi"),te=t.n(ae),le=x.a.Item,ne=Object(U.connect)(function(e){return{BuildManagementlogs:e.BuildManagementlogs,loading:e.loading.models.BuildManagementlogs}})(c=x.a.create()(c=function(e){function a(){var e,t;M()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=S()(this,(e=B()(a)).call.apply(e,[this].concat(n)))).state={modalVisible:!1,updateModalVisible:!1,selectedRows:[],formValues:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"项目名称",dataIndex:"projectName"},{title:"巡察人",dataIndex:"recorder"},{title:"巡察时间",dataIndex:"recordTime",render:function(e){return G()(e).format("YYYY-MM-DD")}},{title:"问题描述",dataIndex:"situationDescription"},{title:"整改要求",dataIndex:"relatedSuggestions"},{title:"操作",width:100,render:function(e,a){return T.a.createElement(j.Fragment,null,T.a.createElement(v.a,{placement:"left",title:"编辑"},T.a.createElement(k.a,{onClick:function(){return t.showDetailModal(a.id)},type:"primary",shape:"circle",icon:"file-search",size:"small"})),T.a.createElement(b.a,{type:"vertical"}),T.a.createElement(y.a,{title:"是否删除数据?",onConfirm:function(){return t.delUtil(a.id)},okText:"确定",cancelText:"取消"},T.a.createElement(v.a,{placement:"left",title:"删除"},T.a.createElement(k.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.batchDel=function(){E.a.confirm({title:"提示",content:"确定要删除数据吗？",okType:"danger",onOk:function(){var e=t.state.selectedRows;t.delUtil(e.map(function(e){return e.id}).join())}})},t.delUtil=function(e){(0,t.props.dispatch)({type:"BuildManagementlogs/remove",payload:{ids:e},callback:function(){h.a.success("删除成功");var e=t.state.pageBean;t.getList({pageBean:e}),t.setState({selectedRows:[]})}})},t.getList=function(e){(0,t.props.dispatch)({type:"BuildManagementlogs/fetch",payload:e})},t.showDetailModal=function(e){(0,t.props.dispatch)({type:"BuildManagementlogs/detail",payload:e,callback:function(e){t.setState({detail:e},function(){return t.handleUpdateModalVisible(!0)})}})},t.handleStandardTableChange=function(e){var a=t.state.formValues,l={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:a};t.getList(l)},t.handleFormReset=function(){var e=t.props.form,a=t.state.pageBean;e.resetFields(),t.setState({formValues:[],selectedRows:[]}),t.getList({pageBean:a})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.handleSearch=function(e){e.preventDefault();var a=t.props.form,l=t.state.pageBean;a.validateFields(function(e,a){if(!e){var n={recorder:a.jlr},r=Object.keys(n).map(function(e){return n[e]?{property:e,value:n[e],group:"main",operation:"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:r}),t.getList({pageBean:l,querys:r})}})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{}})},t.modalCallback=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",a=t.state,l=a.pageBean,n=a.formValues;return"add"===e?t.getList({pageBean:l}):t.getList({pageBean:l,querys:n})},t}return L()(a,e),D()(a,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return T.a.createElement(x.a,{onSubmit:this.handleSearch,layout:"inline"},T.a.createElement(p.a,{gutter:16},T.a.createElement(g.a,{md:5,sm:24},T.a.createElement(le,null,e("jlr")(T.a.createElement(f.a,{addonBefore:"记录人",placeholder:"请输入"})))),T.a.createElement(g.a,{md:5,sm:24},T.a.createElement("span",{className:te.a.submitButtons},T.a.createElement(k.a,{type:"primary",htmlType:"submit"},"查询"),T.a.createElement(k.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.BuildManagementlogs.data,l=a.loading,n=this.state,r=n.selectedRows,i=n.modalVisible,o=n.updateModalVisible,s=n.detail,c={modalCallback:this.modalCallback},d={handleModalVisible:this.handleModalVisible},p={detail:s,handleModalVisible:this.handleUpdateModalVisible};return T.a.createElement(j.Fragment,null,T.a.createElement(m.a,{bordered:!1},T.a.createElement("div",{className:te.a.tableList},T.a.createElement("div",{className:te.a.tableListForm},this.renderSimpleForm()),T.a.createElement("div",{className:te.a.tableListOperator},T.a.createElement(k.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"),r.length>0&&T.a.createElement(k.a,{type:"danger",onClick:this.batchDel},"批量删除")),T.a.createElement(N.a,{tableAlert:!0,selectedRows:r,loading:l,data:t,size:"middle",columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),i&&T.a.createElement(W,u()({},c,d,{modalVisible:i})),o&&Object.keys(s).length&&T.a.createElement(ee,u()({},c,p,{modalVisible:o})))}}]),a}(j.PureComponent))||c)||c;a.default=ne}}]);