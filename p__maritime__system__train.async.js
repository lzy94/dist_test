(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{NDd2:function(e,a,t){"use strict";t.r(a);t("IzEo");var l,n,r=t("bx4M"),i=t("MVZn"),s=t.n(i),o=(t("miYZ"),t("tsqr")),c=(t("P2fV"),t("NJEC")),d=(t("/zsF"),t("PArb")),m=(t("5Dmo"),t("3S7+")),u=t("lwsE"),p=t.n(u),h=t("W8MJ"),f=t.n(h),g=t("a1gu"),E=t.n(g),b=t("Nsbk"),y=t.n(b),V=t("7W2i"),v=t.n(V),w=(t("7Kak"),t("9yH6")),L=(t("2qtc"),t("kLXV")),M=(t("14J3"),t("BMrR")),C=(t("DZo9"),t("8z0m")),k=t("pVnL"),F=t.n(k),S=(t("Pwec"),t("CtXQ")),x=(t("iQDF"),t("+eQT")),T=(t("jCWc"),t("kPKH")),D=(t("5NDa"),t("5rEg")),B=(t("+L6B"),t("2/Rp")),N=(t("OaEy"),t("2fM7")),q=(t("y8nQ"),t("Vl3Y")),z=t("q1tI"),A=t.n(z),U=t("MuoO"),P=t("wd/R"),R=t.n(P),I=t("+n12"),O=t("CkN6"),j=t("9zHi"),H=t.n(j),_=t("ZP6J"),J=t.n(_),K=t("ns75"),Q=t.n(K),Y=q.a.Item,Z=N.a.Option,W=Object(U.connect)(function(e){return{MaritimePeople:e.MaritimePeople,loading:e.loading.models.MaritimePeople}})(l=q.a.create()(l=function(e){function a(){var e,t;p()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=E()(this,(e=y()(a)).call.apply(e,[this].concat(n)))).state={selectedRows:[],formValues:[],pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"姓名",dataIndex:"name"},{title:"身份证号码",dataIndex:"idcard",width:180},{title:"性别",dataIndex:"sex",width:80,render:function(e){return 1===e?"男":"女"}},{title:"职位",dataIndex:"post"},{title:"资格证编号",dataIndex:"certificateNo"},{title:"所属单位",dataIndex:"companyName"}],t.getList=function(e){(0,t.props.dispatch)({type:"MaritimePeople/fetch",payload:e})},t.handleStandardTableChange=function(e){var a=t.state.formValues,l={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:a};t.getList(l)},t.handleFormReset=function(){t.props.form.resetFields(),t.setState({formValues:[],selectedRows:[]}),t.getList({pageBean:t.state.pageBean})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var l=t.state.pageBean,n={post:a.zw,certificateNo:a.zgzh,companyName:a.ssdw,sex:a.xb},r=Object.keys(n).map(function(e){return n[e]?{property:e,value:n[e],group:"main",operation:"sex"===e?"EQUAL":"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:r}),t.getList({pageBean:l,querys:r})}})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.getParticipantsList=function(){var e=t.props,a=e.participantsList,l=e.handleModalVisible;a(t.state.selectedRows.map(function(e){return e.name})),l()},t}return v()(a,e),f()(a,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return A.a.createElement(q.a,{onSubmit:this.handleSearch,layout:"inline"},A.a.createElement(M.a,{gutter:{md:8,lg:16,xl:32}},A.a.createElement(T.a,{md:5,sm:24},A.a.createElement(Y,null,e("zw")(A.a.createElement(D.a,{addonBefore:"职位",placeholder:"请输入"})))),A.a.createElement(T.a,{md:5,sm:24},A.a.createElement(Y,null,e("zgzh")(A.a.createElement(D.a,{addonBefore:"资格证号",placeholder:"请输入"})))),A.a.createElement(T.a,{md:5,sm:24},A.a.createElement(Y,null,e("ssdw")(A.a.createElement(D.a,{addonBefore:"所属单位",placeholder:"请输入"})))),A.a.createElement(T.a,{md:5,sm:24},A.a.createElement("div",{className:Q.a.inputMain},A.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"性别"),A.a.createElement(Y,{style:{flex:1}},e("xb")(A.a.createElement(N.a,{placeholder:"请选择",style:{width:"100%"}},A.a.createElement(Z,{value:1},"男"),A.a.createElement(Z,{value:2},"女")))))),A.a.createElement(T.a,{md:4,sm:24},A.a.createElement("span",{className:H.a.submitButtons},A.a.createElement(B.a,{type:"primary",htmlType:"submit"},"查询"),A.a.createElement(B.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this.props,a=e.MaritimePeople.data,t=e.loading,l=e.handleModalVisible,n=e.modalVisible,i=this.state.selectedRows;return A.a.createElement(L.a,{destroyOnClose:!0,title:"选择港口",className:J.a.formModal,visible:n,width:1e3,onOk:this.getParticipantsList,onCancel:function(){return l()}},A.a.createElement(r.a,{bordered:!1},A.a.createElement("div",{className:H.a.tableList},A.a.createElement("div",{className:H.a.tableListForm},this.renderSimpleForm()),A.a.createElement(O.a,{rowKey:"id_",size:"middle",tableAlert:!1,selectedRows:i,loading:t,data:a,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))))}}]),a}(z.PureComponent))||l)||l,X=q.a.Item,G=N.a.Option,$=["未开始","已结束","取消"],ee=q.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleAdd,n=e.handleModalVisible,r=e.loading,i=e.fileList,s=e.uploadConfig,o=e.handlePeopleVisible,c=e.participants;return A.a.createElement(L.a,{destroyOnClose:!0,title:"添加培训信息",className:J.a.formModal,visible:a,width:700,onCancel:function(){return n()},footer:[A.a.createElement(B.a,{key:"back",onClick:function(){return n()}},"取消"),A.a.createElement(B.a,{key:"submit",type:"primary",loading:r,onClick:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})}},"确定")]},A.a.createElement("div",{className:J.a.formModalBody},A.a.createElement(M.a,{gutter:40},A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训主题"},t.getFieldDecorator("trainTitle",{rules:[{required:!0,message:"请输入培训主题！"}]})(A.a.createElement(D.a,{placeholder:"请输入"})))),A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训时间"},t.getFieldDecorator("trainTime",{rules:[{required:!0,message:"请选择培训时间！"}]})(A.a.createElement(x.a,{style:{width:"100%"},placeholder:"请选择",showTime:!0})))),A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训地点"},t.getFieldDecorator("trainAddr",{rules:[{required:!0,message:"请输入培训地点！"}]})(A.a.createElement(D.a,{placeholder:"请输入"})))),A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训内容"},t.getFieldDecorator("trainContent",{rules:[{required:!0,message:"请输入培训内容！"}]})(A.a.createElement(D.a.TextArea,{placeholder:"请输入"})))),A.a.createElement(T.a,{md:24,sm:24},A.a.createElement(X,{label:"参与人员"},t.getFieldDecorator("participants",{initialValue:c,rules:[{required:!0,message:"请选择参与人员！"}]})(A.a.createElement(D.a.TextArea,{readOnly:!0,placeholder:"请选择",onClick:function(){return o(!0)}})))),A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训附件名称"},t.getFieldDecorator("enclosureName",{rules:[{required:!0,message:"请输入培训附件名称！"}]})(A.a.createElement(D.a,{placeholder:"请输入"})))),A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训附件"},t.getFieldDecorator("enclosureUrl",{rules:[{required:!0,message:"请选择培训附件！"}]})(A.a.createElement(C.a,F()({},s(),{defaultFileList:i}),i.length>0?null:A.a.createElement(B.a,null,A.a.createElement(S.a,{type:"upload"})," 请上传培训附件（ pdf , doc, docx, zip）"))))))))}),ae=q.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleUpdate,n=e.handleModalVisible,r=e.loading,i=e.fileList,s=e.uploadConfig,o=e.handlePeopleVisible,c=e.participants,d=e.detail,m=e.stateValue,u=e.stateChange;return A.a.createElement(L.a,{destroyOnClose:!0,title:"编辑培训信息",className:J.a.formModal,visible:a,width:700,onCancel:function(){return n()},footer:[A.a.createElement(B.a,{key:"back",onClick:function(){return n()}},"取消"),A.a.createElement(B.a,{key:"submit",type:"primary",loading:r,onClick:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})}},"确定")]},A.a.createElement("div",{className:J.a.formModalBody},A.a.createElement(M.a,{gutter:40},A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训主题"},t.getFieldDecorator("trainTitle",{initialValue:d.trainTitle,rules:[{required:!0,message:"请输入培训主题！"}]})(A.a.createElement(D.a,{placeholder:"请输入"})))),A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训时间"},t.getFieldDecorator("trainTime",{initialValue:R()(d.trainTime),rules:[{required:!0,message:"请选择培训时间！"}]})(A.a.createElement(x.a,{style:{width:"100%"},placeholder:"请选择",showTime:!0})))),A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训地点"},t.getFieldDecorator("trainAddr",{initialValue:d.trainAddr,rules:[{required:!0,message:"请输入培训地点！"}]})(A.a.createElement(D.a,{placeholder:"请输入"})))),A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训内容"},t.getFieldDecorator("trainContent",{initialValue:d.trainContent,rules:[{required:!0,message:"请输入培训内容！"}]})(A.a.createElement(D.a.TextArea,{placeholder:"请输入"})))),A.a.createElement(T.a,{md:24,sm:24},A.a.createElement(X,{label:"参与人员"},t.getFieldDecorator("participants",{initialValue:c,rules:[{required:!0,message:"请选择参与人员！"}]})(A.a.createElement(D.a.TextArea,{readOnly:!0,placeholder:"请选择",onClick:function(){return o(!0)}})))),A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训附件名称"},t.getFieldDecorator("enclosureName",{initialValue:d.enclosureName,rules:[{required:!0,message:"请输入培训附件名称！"}]})(A.a.createElement(D.a,{placeholder:"请输入"})))),A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"培训附件"},t.getFieldDecorator("enclosureUrl",{initialValue:d.enclosureUrl,rules:[{required:!0,message:"请选择培训附件！"}]})(A.a.createElement(C.a,F()({},s(),{defaultFileList:i}),i.length>0?null:A.a.createElement(B.a,null,A.a.createElement(S.a,{type:"upload"})," 请上传培训附件（ pdf , doc, docx, zip）"))))),A.a.createElement(T.a,{md:12,sm:24},A.a.createElement(X,{label:"状态"},t.getFieldDecorator("state",{initialValue:d.state,rules:[{required:!0,message:"请选择状态！"}]})(A.a.createElement(w.a.Group,{onChange:u},$.map(function(e,a){return A.a.createElement(w.a,{value:a+1,key:a},e)})))))),3===m&&A.a.createElement(M.a,{gutter:40},A.a.createElement(T.a,{md:24},A.a.createElement(X,{label:"取消原因"},t.getFieldDecorator("cancleReason",{initialValue:d.cancleReason||""})(A.a.createElement(D.a.TextArea,{placeholder:"请输入"})))))))}),te=Object(U.connect)(function(e){return{MaritimeTrain:e.MaritimeTrain,loading:e.loading.models.MaritimeTrain}})(n=q.a.create()(n=function(e){function a(){var e,t;p()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=E()(this,(e=y()(a)).call.apply(e,[this].concat(n)))).state={modalVisible:!1,updateModalVisible:!1,peopleVisible:!1,participants:"",formValues:[],fileList:[],stateValue:0,detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"培训主题",dataIndex:"trainTitle"},{title:"培训内容",dataIndex:"trainContent",render:function(e){return e.length>10?A.a.createElement(m.a,{title:e},e.substring(0,10),"..."):e}},{title:"培训地点",dataIndex:"trainAddr"},{title:"培训时间",dataIndex:"trainTime",width:170,render:function(e){return R()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"参与人员",dataIndex:"participants"},{title:"培训附件",dataIndex:"enclosureUrl",render:function(e,a){return e?A.a.createElement("a",{href:I.q+a.enclosureUrl,download:a.enclosureName,target:"_blank"},a.enclosureName):""}},{title:"状态",dataIndex:"state",render:function(e){return $[e-1]}},{title:"操作",width:90,render:function(e,a){return A.a.createElement(z.Fragment,null,A.a.createElement(m.a,{placement:"left",title:"编辑"},A.a.createElement(B.a,{onClick:function(){return t.editData(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),A.a.createElement(d.a,{type:"vertical"}),A.a.createElement(c.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id_)},okText:"确定",cancelText:"取消"},A.a.createElement(m.a,{placement:"left",title:"删除"},A.a.createElement(B.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.getList=function(e){(0,t.props.dispatch)({type:"MaritimeTrain/fetch",payload:e})},t.dataDel=function(e){var a=t.props.dispatch,l=t.state.pageBean;a({type:"MaritimeTrain/remove",payload:{id:e},callback:function(){o.a.success("删除成功"),t.getList({pageBean:l})}})},t.editData=function(e){t.setState({detail:e,stateValue:e.state,participants:e.participants,fileList:e.enclosureUrl?[{uid:"1",name:"当前文件",status:"done",url:I.q+e.enclosureUrl,path:e.enclosureUrl}]:[]},function(){return t.handleUpdateModalVisible(!0)})},t.handleStandardTableChange=function(e){var a=t.state.formValues,l={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:a};t.getList(l)},t.handleFormReset=function(){var e=t.props.form,a=t.state.pageBean;e.resetFields(),t.setState({formValues:[]}),t.getList({pageBean:a})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var l=t.state.pageBean,n={state:a.status,participants:a.cyry,trainAddr:a.address},r=Object.keys(n).map(function(e){return n[e]?{property:e,value:n[e],group:"main",operation:"state"===e?"EQUAL":"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:r}),t.getList({pageBean:l,querys:r})}})},t.handlePeopleVisible=function(e){t.setState({peopleVisible:!!e})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e}),e||t.setState({participants:"",fileList:[]})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({participants:"",detail:{},fileList:[],stateValue:0})},t.handleAdd=function(e,a){var l=t.props.dispatch,n=t.state,r=n.fileList,i=n.participants,c=n.pageBean;if(!r.length)return o.a.error("请选择文件");var d=s()({},e);d.participants=i,d.enclosureUrl=r.length?r[0].response.filePath:"",d.state=1,l({type:"MaritimeTrain/add",payload:d,callback:function(){t.getList({pageBean:c}),o.a.success("添加成功"),t.handleModalVisible(),a()}})},t.handleUpdate=function(e,a){var l=t.props.dispatch,n=t.state,r=n.fileList,i=n.participants,c=n.pageBean,d=n.detail,m=n.stateValue;if(!r.length)return o.a.error("请选择文件");var u=Object.keys(e),p=s()({id_:d.id_},e);p.participants=i,"object"==typeof p.enclosureUrl&&(p.enclosureUrl=r[0].response.filePath);for(var h=0;h<u.length;h+=1)d[u[h]]=p[u[h]];3===m&&(p.cancleTime=new Date),t.setState({detail:p}),l({type:"MaritimeTrain/update",payload:p,callback:function(){t.getList({pageBean:c}),o.a.success("编辑成功"),t.handleUpdateModalVisible(),a()}})},t.stateChange=function(e){var a=e.target.value;t.setState({stateValue:a})},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".doc,.docx,.pdf,.zip",className:"upload-list-inline",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(I.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:I.p,onChange:t.uploadChange}},t.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(o.a.success("上传成功"),t.setState({fileList:e.fileList})):o.a.error(e.file.response.code.msg):"error"===e.file.status?o.a.error("上传失败"):"removed"===e.file.status&&t.setState({fileList:e.fileList})},t.participantsList=function(e){t.setState({participants:e.join()})},t}return v()(a,e),f()(a,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return A.a.createElement(q.a,{onSubmit:this.handleSearch,layout:"inline"},A.a.createElement(M.a,{gutter:{md:8,lg:16,xl:32}},A.a.createElement(T.a,{md:6,sm:24},A.a.createElement(X,null,e("address")(A.a.createElement(D.a,{addonBefore:"培训地点",placeholder:"请输入"})))),A.a.createElement(T.a,{md:6,sm:24},A.a.createElement("div",{className:Q.a.inputMain},A.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"状态"),A.a.createElement(X,{style:{flex:1}},e("status")(A.a.createElement(N.a,{placeholder:"请选择",style:{width:"100%"}},$.map(function(e,a){return A.a.createElement(G,{value:a+1,key:"".concat(a,"_status")},e)})))))),A.a.createElement(T.a,{md:6,sm:24},A.a.createElement(X,null,e("cyry")(A.a.createElement(D.a,{addonBefore:"参与人员",placeholder:"请输入"})))),A.a.createElement(T.a,{md:6,sm:24},A.a.createElement("span",{className:H.a.submitButtons},A.a.createElement(B.a,{type:"primary",htmlType:"submit"},"查询"),A.a.createElement(B.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.MaritimeTrain.data,l=a.loading,n=this.state,i=n.modalVisible,s=n.updateModalVisible,o=n.fileList,c=n.peopleVisible,d=n.participants,m=n.detail,u=n.stateValue,p={loading:l,fileList:o,participants:d,uploadConfig:this.uploadConfig,handlePeopleVisible:this.handlePeopleVisible},h={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},f={detail:m,stateValue:u,stateChange:this.stateChange,handleModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate};return A.a.createElement(z.Fragment,null,A.a.createElement(r.a,{bordered:!1},A.a.createElement("div",{className:H.a.tableList},A.a.createElement("div",{className:H.a.tableListForm},this.renderSimpleForm()),A.a.createElement("div",{className:H.a.tableListOperator},A.a.createElement(B.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建")),A.a.createElement(O.a,{rowKey:"id_",size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:l,data:t,columns:this.columns,onChange:this.handleStandardTableChange}))),A.a.createElement(ee,F()({},p,h,{modalVisible:i})),s&&Object.keys(m).length&&A.a.createElement(ae,F()({},p,f,{modalVisible:s})),c&&A.a.createElement(W,{participantsList:this.participantsList,handleModalVisible:this.handlePeopleVisible,modalVisible:c}))}}]),a}(z.PureComponent))||n)||n;a.default=te}}]);