(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{"6eQt":function(e,a,t){"use strict";t.r(a);t("IzEo");var n,s=t("bx4M"),l=(t("+L6B"),t("2/Rp")),o=(t("5NDa"),t("5rEg")),r=t("MVZn"),i=t.n(r),c=(t("miYZ"),t("tsqr")),d=t("lwsE"),p=t.n(d),u=t("W8MJ"),m=t.n(u),h=t("a1gu"),f=t.n(h),g=t("Nsbk"),v=t.n(g),b=t("7W2i"),M=t.n(b),y=(t("y8nQ"),t("Vl3Y")),k=t("q1tI"),D=t.n(k),E=t("MuoO"),N=t("DhmK"),V=t("PLMH"),S=t.n(V),C=Object(E.connect)(function(e){return{ConserveDataMessage:e.ConserveDataMessage,loading:e.loading.models.ConserveDataMessage}})(n=y.a.create()(n=function(e){function a(e){var t;return p()(this,a),(t=f()(this,v()(a).call(this,e))).state={modalVisible:!1,planId:""},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.selectData=function(e){t.props.form.setFieldsValue({planName:e.planName}),t.setState({planId:e.id_})},t.setInputSelection=function(e,a){var n=t.input.current.textAreaRef;n.focus(),void 0!==n.selectionStart&&(n.selectionStart=e,n.selectionEnd=a)},t.checkPhone=function(e){var a=!0;if(!e)return a;for(var n=/^1(?:70\d|(?:9[89]|8[0-24-9]|7[135-8]|66|5[0-35-9])\d|3(?:4[0-8]|[0-35-9]\d))\d{7}$/,s=e.split(","),l=0;l<s.length;l+=1)if(!n.test(s[l])){a=!1,c.a.error("".concat(s[l],"输入不正确"));var o=t.getValueLength(s,l);t.setInputSelection(o[0],o[1]);break}return a},t.getValueLength=function(e,a){var t=0,n=0;if(0===a)t=0,n=e[a].length;else{for(var s=0;s<a;s+=1)t+=e[s].length;n=(t+=a)+e[a].length}return[t,n]},t.getList=function(){(0,t.props.dispatch)({type:"ConserveDataMessage/fetch",payload:{pageBean:{page:1,pageSize:10,showTotal:!0}},callback:function(){var e=t.props,a=e.form,n=e.ConserveDataMessage.data,s=n.phoneNumbers,l=n.planName,o=n.planId;a.setFieldsValue({phoneNumbers:s,planName:l}),t.setState({planId:o})}})},t.send=function(){var e=t.props,a=e.form,n=e.dispatch,s=e.ConserveDataMessage.data;a.validateFields(function(e,a){if(!e){var l=t.state.planId,o=i()({},s,a,{planId:l});t.checkPhone(o.phoneNumbers)&&n({type:"ConserveDataMessage/dataSave",payload:o,callback:function(e){c.a.success(e.message),t.getList()}})}})},t.testSend=function(){var e=t.props,a=e.form,n=e.dispatch;a.validateFields(function(e,a){if(!e){var s={phones:a.phoneNumbers,content:a.planName};t.checkPhone(s.phones)&&n({type:"ConserveDataMessage/tSend",payload:s,callback:function(e){c.a.success(e.message),t.getList()}})}})},t.input=D.a.createRef(),t}return M()(a,e),m()(a,[{key:"componentDidMount",value:function(){this.getList()}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,a={heihgt:"100%"},t=this.state.modalVisible;return D.a.createElement(k.Fragment,null,D.a.createElement(s.a,{title:"水位，位移短信预警",bordered:!1,style:a,bodyStyle:a},D.a.createElement("div",{className:S.a.main},D.a.createElement(y.a,{layout:"vertical"},D.a.createElement(y.a.Item,{label:"预案"},e("planName",{rules:[{required:!0,message:"请选择预案"}]})(D.a.createElement(o.a,{readOnly:!0,placeholder:"请选择预案",onClick:this.handleModalVisible}))),D.a.createElement(y.a.Item,{label:"手机号码 多个用英文 ,  隔开"},e("phoneNumbers",{})(D.a.createElement(o.a.TextArea,{ref:this.input,placeholder:"手机号码 多个用 , 隔开"}))),D.a.createElement(l.a,{type:"primary",onClick:this.send},"保存")," ",D.a.createElement(l.a,{onClick:this.testSend},"测试发送")))),t&&D.a.createElement(N.a,{modalVisible:t,handleModalVisible:this.handleModalVisible,selectData:this.selectData}))}}]),a}(k.PureComponent))||n)||n;a.default=C},PLMH:function(e,a,t){e.exports={main:"antd-pro-pages-conserve-data-message-style-main"}}}]);