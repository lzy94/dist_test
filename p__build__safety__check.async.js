(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{piNu:function(e,t,a){"use strict";a.r(t);var n=a("pVnL"),l=a.n(n),i=(a("IzEo"),a("bx4M")),r=(a("14J3"),a("BMrR")),c=(a("jCWc"),a("kPKH")),s=(a("miYZ"),a("tsqr")),o=(a("2qtc"),a("kLXV")),d=(a("P2fV"),a("NJEC")),u=(a("/zsF"),a("PArb")),m=(a("5Dmo"),a("3S7+")),p=(a("+L6B"),a("2/Rp")),h=a("lwsE"),f=a.n(h),g=a("W8MJ"),y=a.n(g),k=a("a1gu"),C=a.n(k),b=a("Nsbk"),v=a.n(b),E=a("7W2i"),S=a.n(E),x=(a("OaEy"),a("2fM7")),M=(a("y8nQ"),a("Vl3Y")),V=a("q1tI"),F=a.n(V),N=a("MuoO"),B=a("CkN6"),I=a("MVZn"),w=a.n(I),j=(a("giR+"),a("fyUT")),D=(a("iQDF"),a("+eQT")),R=a("wd/R"),L=a.n(R),O=a("YP4+"),P=M.a.Item,T=x.a.Option;var q=M.a.create({mapPropsToFields:function(e){return function(e){for(var t=Object.keys(e),a={},n=0;n<t.length;n+=1)a[t[n]]=M.a.createFormField(w()({},e[t[n]],{value:"checkTime"===t[n]?L()(new Date(e[t[n]].value),"YYYY-MM-DD"):e[t[n]].value}));return a}(e.field)},onFieldsChange:function(e,t){e.onChange(t)}})(function(e){var t=e.form,a=e.cateIndex,n=e.setCateIndex;return F.a.createElement(V.Fragment,null,F.a.createElement(P,{label:"抽检类别"},t.getFieldDecorator("catogery",{rules:[{required:!0,message:"请选择抽检类别！"}]})(F.a.createElement(x.a,{placeholder:"请输入",style:{width:"100%"},onChange:function(e,a){t.setFieldsValue({projectName:void 0}),n(a.props.title)}},O.a.map(function(e,t){return F.a.createElement(T,{value:e,key:e,title:"".concat(t)},e)})))),F.a.createElement(P,{label:"抽检项目"},t.getFieldDecorator("projectName",{rules:[{required:!0,message:"请选择抽检项目！"}]})(F.a.createElement(x.a,{placeholder:"请输入",style:{width:"100%"}},O.f[a].map(function(e){return F.a.createElement(T,{value:e,key:e},e)})))),F.a.createElement(P,{label:"抽检时间"},t.getFieldDecorator("checkTime",{rules:[{required:!0,message:"请输入抽检时间！"}]})(F.a.createElement(D.a,{style:{width:"100%"}}))),F.a.createElement(P,{label:"合格数"},t.getFieldDecorator("passNum",{rules:[{required:!0,message:"请输入合格数！"}]})(F.a.createElement(j.a,{placeholder:"请输入",min:0,style:{width:"100%"}}))),F.a.createElement(P,{label:"检测数"},t.getFieldDecorator("checkNum",{rules:[{required:!0,message:"请输入检测数！"}]})(F.a.createElement(j.a,{placeholder:"请输入",min:0,style:{width:"100%"}}))))});q.defaultProps={field:{},cateIndex:0,onChange:function(){},setCateIndex:function(){}};var Y,z,U,H,J,A,Q,W=q,Z=a("ZP6J"),G=a.n(Z),K=Object(N.connect)(function(e){return{BuildSafetyCheck:e.BuildSafetyCheck,loading:e.loading.models.BuildSafetyCheck}})((U=z=function(e){function t(e){var a;return f()(this,t),(a=C()(this,v()(t).call(this,e))).state={cateIndex:0,field:{}},a.save=function(){a.MyForm.current.validateFields(function(e,t){if(!e)if(t.passNum>t.checkNum)s.a.error("检测数需大于等于合格数");else{var n=a.props,l=n.dispatch,i=n.modalCallback;l({type:"BuildSafetyCheck/add",payload:w()({},t,{passPercent:(t.passNum/(t.checkNum||1)*100).toFixed(1)}),callback:function(){s.a.success("添加成功"),i(),a.cancelClick()}})}})},a.cancelClick=function(){(0,a.props.handleModalVisible)()},a.setCateIndex=function(e){a.setState({cateIndex:e})},a.onChange=function(e){a.setState(function(t){var a=t.field;return{field:w()({},a,e)}})},a.MyForm=F.a.createRef(),a}return S()(t,e),y()(t,[{key:"render",value:function(){var e=this.props,t=e.loading,a=e.modalVisible,n=this.state,l=n.cateIndex,i=n.field;return F.a.createElement(o.a,{destroyOnClose:!0,title:"新建监督抽检",className:G.a.formModal,visible:a,onCancel:this.cancelClick,footer:[F.a.createElement(p.a,{key:"back",onClick:this.cancelClick},"取消"),F.a.createElement(p.a,{key:"submit",type:"primary",loading:t,onClick:this.save},"确定")]},F.a.createElement("div",{className:G.a.formModalBody},F.a.createElement(W,{field:i,ref:this.MyForm,cateIndex:l,setCateIndex:this.setCateIndex,onChange:this.onChange})))}}]),t}(V.PureComponent),z.defaultProps={modalVisible:!1,handleModalVisible:function(){},modalCallback:function(){}},Y=U))||Y,X=Object(N.connect)(function(e){return{BuildSafetyCheck:e.BuildSafetyCheck,loading:e.loading.models.BuildSafetyCheck}})((A=J=function(e){function t(e){var a;return f()(this,t),(a=C()(this,v()(t).call(this,e))).state={field:{},detail:{},cateIndex:0,isSet:!1},a.save=function(){a.MyForm.current.validateFields(function(e,t){if(!e)if(t.passNum>t.checkNum)s.a.error("检测数需大于等于合格数");else{var n=a.props,l=n.dispatch,i=n.modalCallback,r=a.state,c=r.field,o=r.detail,d=w()({},c,t,{passPercent:(t.passNum/(t.checkNum||1)*100).toFixed(1)});delete d.createBy,delete d.createTime;for(var u=w()({},o),m=Object.keys(t),p=0;p<m.length;p+=1)u[m[p]]={value:t[m[p]]};a.setState({detail:u}),l({type:"BuildSafetyCheck/add",payload:d,callback:function(){s.a.success("编辑成功"),i(),a.cancelClick()}})}})},a.cancelClick=function(){(0,a.props.handleModalVisible)()},a.setCateIndex=function(e){a.setState({cateIndex:e})},a.onChange=function(e){a.setState(function(t){var a=t.detail;return{detail:w()({},a,e)}})},a.MyForm=F.a.createRef(),a}return S()(t,e),y()(t,[{key:"render",value:function(){var e=this.props,t=e.loading,a=e.modalVisible,n=this.state,l=n.detail,i=n.cateIndex;return F.a.createElement(o.a,{destroyOnClose:!0,title:"编辑监督抽检",className:G.a.formModal,visible:a,onCancel:this.cancelClick,footer:[F.a.createElement(p.a,{key:"back",onClick:this.cancelClick},"取消"),F.a.createElement(p.a,{key:"submit",type:"primary",loading:t,onClick:this.save},"确定")]},F.a.createElement(W,{field:l,ref:this.MyForm,cateIndex:i,setCateIndex:this.setCateIndex,onChange:this.onChange}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.detail,n=t.isSet;if(!n){for(var l=Object.keys(a),i={},r=0;r<l.length;r+=1)i[l[r]]={value:a[l[r]]};return{isSet:!n,detail:i,field:a}}return null}}]),t}(V.PureComponent),J.defaultProps={modalVisible:!1,handleModalVisible:function(){},modalCallback:function(){}},H=A))||H,$=a("ns75"),_=a.n($),ee=a("9zHi"),te=a.n(ee),ae=M.a.Item,ne=x.a.Option,le=Object(N.connect)(function(e){return{BuildSafetyCheck:e.BuildSafetyCheck,loading:e.loading.models.BuildSafetyCheck}})(Q=M.a.create()(Q=function(e){function t(){var e,a;f()(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=C()(this,(e=v()(t)).call.apply(e,[this].concat(l)))).state={modalVisible:!1,updateModalVisible:!1,selectedRows:[],formValues:[],detail:{},projectIndex:0,pageBean:{page:1,pageSize:10,showTotal:!0}},a.columns=[{title:"抽检项目",dataIndex:"projectName"},{title:"抽检类别",dataIndex:"catogery"},{title:"抽检时间",dataIndex:"checkTime",render:function(e){return L()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"检测数",dataIndex:"checkNum"},{title:"合格数",dataIndex:"passNum"},{title:"合格率（%）",dataIndex:"passPercent"},{title:"操作",width:100,render:function(e,t){return F.a.createElement(V.Fragment,null,F.a.createElement(m.a,{placement:"left",title:"编辑"},F.a.createElement(p.a,{onClick:function(){return a.showDetailModal(t.id)},type:"primary",shape:"circle",icon:"file-search",size:"small"})),F.a.createElement(u.a,{type:"vertical"}),F.a.createElement(d.a,{title:"是否删除数据?",onConfirm:function(){return a.delUtil(t.id)},okText:"确定",cancelText:"取消"},F.a.createElement(m.a,{placement:"left",title:"删除"},F.a.createElement(p.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],a.batchDel=function(){o.a.confirm({title:"提示",content:"确定要删除数据吗？",okType:"danger",onOk:function(){var e=a.state.selectedRows;a.delUtil(e.map(function(e){return e.id}).join())}})},a.delUtil=function(e){(0,a.props.dispatch)({type:"BuildSafetyCheck/remove",payload:{ids:e},callback:function(){s.a.success("删除成功");var e=a.state.pageBean;a.getList({pageBean:e}),a.setState({selectedRows:[]})}})},a.getList=function(e){(0,a.props.dispatch)({type:"BuildSafetyCheck/fetch",payload:e})},a.showDetailModal=function(e){(0,a.props.dispatch)({type:"BuildSafetyCheck/detail",payload:e,callback:function(e){a.setState({detail:e},function(){return a.handleUpdateModalVisible(!0)})}})},a.handleStandardTableChange=function(e){var t=a.state.formValues,n={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:t};a.getList(n)},a.handleFormReset=function(){var e=a.props.form,t=a.state.pageBean;e.resetFields(),a.setState({formValues:[],selectedRows:[]}),a.getList({pageBean:t})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.handleSearch=function(e){e.preventDefault();var t=a.props.form,n=a.state.pageBean;t.validateFields(function(e,t){if(!e){var l={catogery:t.cjlb,projectName:t.cjxm},i=Object.keys(l).map(function(e){return l[e]?{property:e,value:l[e],group:"main",operation:"LIKE",relation:"AND"}:""}).filter(function(e){return e});a.setState({formValues:i}),a.getList({pageBean:n,querys:i})}})},a.handleModalVisible=function(e){a.setState({modalVisible:!!e})},a.handleUpdateModalVisible=function(e){a.setState({updateModalVisible:!!e}),e||a.setState({detail:{}})},a.modalCallback=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",t=a.state,n=t.pageBean,l=t.formValues;return"add"===e?a.getList({pageBean:n}):a.getList({pageBean:n,querys:l})},a.catogeryChange=function(e,t){var n=a.props.form,l=parseInt(t.props.title,10);n.setFieldsValue({cjxm:void 0}),a.setState({projectIndex:l})},a}return S()(t,e),y()(t,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.projectIndex;return F.a.createElement(M.a,{onSubmit:this.handleSearch,layout:"inline"},F.a.createElement(r.a,{gutter:16},F.a.createElement(c.a,{md:6,sm:24},F.a.createElement("div",{className:_.a.inputMain},F.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"抽检类别"),F.a.createElement(ae,{style:{flex:1}},e("cjlb")(F.a.createElement(x.a,{onChange:this.catogeryChange,className:_.a.inputGroupLeftRadius,placeholder:"请选择"},O.a.map(function(e,t){return F.a.createElement(ne,{value:e,key:e,title:"".concat(t)},e)})))))),F.a.createElement(c.a,{md:6,sm:24},F.a.createElement("div",{className:_.a.inputMain},F.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"抽检项目"),F.a.createElement(ae,{style:{flex:1}},e("cjxm")(F.a.createElement(x.a,{onChange:this.catogeryChange,className:_.a.inputGroupLeftRadius,placeholder:"请选择"},O.f[t].map(function(e,t){return F.a.createElement(ne,{value:e,key:e,title:"".concat(t)},e)})))))),F.a.createElement(c.a,{md:4,sm:24},F.a.createElement("span",{className:te.a.submitButtons},F.a.createElement(p.a,{type:"primary",htmlType:"submit"},"查询"),F.a.createElement(p.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,t=this.props,a=t.BuildSafetyCheck.data,n=t.loading,r=this.state,c=r.selectedRows,s=r.modalVisible,o=r.updateModalVisible,d=r.detail,u={modalCallback:this.modalCallback},m={handleModalVisible:this.handleModalVisible},h={detail:d,handleModalVisible:this.handleUpdateModalVisible};return F.a.createElement(V.Fragment,null,F.a.createElement(i.a,{bordered:!1},F.a.createElement("div",{className:te.a.tableList},F.a.createElement("div",{className:te.a.tableListForm},this.renderSimpleForm()),F.a.createElement("div",{className:te.a.tableListOperator},F.a.createElement(p.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"),c.length>0&&F.a.createElement(p.a,{type:"danger",onClick:this.batchDel},"批量删除")),F.a.createElement(B.a,{tableAlert:!0,selectedRows:c,loading:n,data:a,size:"middle",columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),s&&F.a.createElement(K,l()({},u,m,{modalVisible:s})),o&&Object.keys(d).length&&F.a.createElement(X,l()({},u,h,{modalVisible:o})))}}]),t}(V.PureComponent))||Q)||Q;t.default=le}}]);