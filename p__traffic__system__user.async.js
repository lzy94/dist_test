(window.webpackJsonp=window.webpackJsonp||[]).push([[188],{HPha:function(e,a,t){"use strict";t.r(a);t("IzEo");var l,r=t("bx4M"),n=(t("ozfa"),t("MJZm")),i=(t("miYZ"),t("tsqr")),s=(t("P2fV"),t("NJEC")),o=(t("5Dmo"),t("3S7+")),d=(t("/zsF"),t("PArb")),c=(t("BoS7"),t("Sdc0")),u=(t("Q9mQ"),t("diRs")),p=t("lwsE"),m=t.n(p),g=t("W8MJ"),h=t.n(g),f=t("a1gu"),y=t.n(f),E=t("Nsbk"),b=t.n(E),C=t("PJYZ"),S=t.n(C),I=t("7W2i"),v=t.n(I),k=t("MVZn"),V=t.n(k),F=(t("T2oS"),t("W9HT")),D=(t("14J3"),t("BMrR")),L=(t("sRBo"),t("kaz8")),w=(t("nRaC"),t("5RzL")),N=(t("O3gP"),t("lrIw")),O=(t("jCWc"),t("kPKH")),U=(t("DZo9"),t("8z0m")),T=t("pVnL"),B=t.n(T),x=(t("+L6B"),t("2/Rp")),j=(t("Pwec"),t("CtXQ")),M=(t("5NDa"),t("5rEg")),R=(t("2qtc"),t("kLXV")),q=(t("y8nQ"),t("Vl3Y")),A=(t("OaEy"),t("2fM7")),K=t("q1tI"),H=t.n(K),_=t("MuoO"),J=t("CkN6"),z=t("mf+E"),G=t("+n12"),P=t("9zHi"),Q=t.n(P),Z=t("ns75"),W=t.n(Z),X=t("dscJ"),Y=t.n(X),$=t("ZP6J"),ee=t.n($),ae=A.a.Option,te=q.a.Item,le=R.a.confirm,re=["/system/user","/system/user/adduser","/system/user/updateUser","/system/user/deleteUserByIds","/system/user/export","/conserve/data/user","/conserve/data/user/add","/conserve/data/user/update","/conserve/data/user/delete","/conserve/data/user/export","/maritime/data/user","/maritime/data/user/add","/maritime/data/user/update","/maritime/data/user/delete","/maritime/data/user/export","/transport/system/user","/transport/system/user/add","/transport/system/user/update","/transport/system/user/delete","/transport/system/user/export"],ne=[[],[]],ie=[],se=q.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleAdd,r=e.emailSuffixValue,n=e.handleModalVisible,i=e.emailInputChange,s=e.treeList,o=e.setRoleCode,d=(e.pinyin,e.loading),c=e.getFullName,u=e.treeSelectChange,p=e.siteList,m=e.fileList,g=e.uploadChange,h=e.departmentChange,f=e.departmentValue,y=e.departmentList,E={name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",data:{type:1,xbType:""},headers:{Authorization:"Bearer ".concat(Object(G.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:G.A,onChange:g};return H.a.createElement(R.a,{destroyOnClose:!0,title:"添加用户",className:ee.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})},onCancel:function(){return n()},width:800},H.a.createElement(F.a,{spinning:d,tip:"正在获取"},H.a.createElement("div",{className:ee.a.formModalBody},H.a.createElement(D.a,{gutter:40},H.a.createElement(O.a,{md:12,sm:24},H.a.createElement(te,{hasFeedback:!0,label:"名称"},t.getFieldDecorator("fullname",{rules:[{required:!0,message:"请输入用户名称"}]})(H.a.createElement(M.a,{placeholder:"请输入",onChange:c}))),H.a.createElement(te,{label:"登录账号"},t.getFieldDecorator("account",{rules:[{required:!0,message:"请获取登录账号！"}]})(H.a.createElement(M.a,{placeholder:"请输入",onFocus:function(){o(function(e){t.setFieldsValue({account:e})})}}))),H.a.createElement(te,{hasFeedback:!0,label:"密码"},t.getFieldDecorator("password",{rules:[{required:!0,min:6,message:"请输入账号密码！"}]})(H.a.createElement(M.a,{type:"password",placeholder:"请输入"}))),H.a.createElement(te,{hasFeedback:!0,label:"电话号码"},t.getFieldDecorator("mobile",{rules:[{required:!0,validator:G.h}]})(H.a.createElement(M.a,{placeholder:"请输入"}))),H.a.createElement(te,{hasFeedback:!0,label:"职务"},t.getFieldDecorator("position",{rules:[{required:!0,message:"请输入职务"}]})(H.a.createElement(M.a,{placeholder:"请输入"}))),H.a.createElement(te,{label:"执法证件号"},t.getFieldDecorator("lawCard",{rules:[{message:"请输入执法证件号！"}]})(H.a.createElement(M.a,{placeholder:"请输入"}))),H.a.createElement(te,{label:"执法证件图片"},t.getFieldDecorator("lawCardImg",{})(H.a.createElement(U.a,B()({},E,{defaultFileList:m}),m.length>0?null:H.a.createElement(x.a,null,H.a.createElement(j.a,{type:"upload"})," 执法证件图片"))))),H.a.createElement(O.a,{md:12,sm:24},H.a.createElement(te,{label:"证件号码"},t.getFieldDecorator("idCard",{rules:[{message:"请输入证件号码！"}]})(H.a.createElement(M.a,{placeholder:"请输入"}))),H.a.createElement(te,{label:"邮箱"},t.getFieldDecorator("email",{rules:[{type:"email",message:"请输入正确的邮箱"},{message:"请输入正确的邮箱！"}]})(H.a.createElement(N.a,{dataSource:r,style:{width:"100%"},onChange:i,placeholder:"请输入"}))),H.a.createElement(te,{hasFeedback:!0,label:"区域"},t.getFieldDecorator("organId",{rules:[{required:!0,message:"请选择区域！"}]})(H.a.createElement(w.a,{treeData:s,style:{width:"100%"},placeholder:"请选择",onChange:function(e){t.setFieldsValue({siteIds:[],staticSite:[]}),u(e)}}))),H.a.createElement(te,{label:"部门"},t.getFieldDecorator("department",{rules:[{required:!0,message:"请选择部门"}]})(H.a.createElement(L.a.Group,{onChange:h},ne[0].map(function(e,a){return H.a.createElement(L.a,{value:e,key:a},ne[1][a])})))),Object(G.C)()?H.a.createElement(K.Fragment,null,H.a.createElement(te,{label:"非现场站点"},t.getFieldDecorator("siteIds",{})(H.a.createElement(w.a,{placeholder:"请选择站点",treeCheckable:!0,treeData:p[0],style:{width:"100%"}}))),H.a.createElement(te,{label:"精简站"},t.getFieldDecorator("staticSite",{})(H.a.createElement(w.a,{placeholder:"请选择站点",treeCheckable:!0,treeData:p[1],style:{width:"100%"}})))):null,f&&H.a.createElement(te,{label:"子部门"},t.getFieldDecorator("departCode",{rules:[{message:"请选择子部门！"}]})(H.a.createElement(A.a,{style:{width:"100%"},placeholder:"请选择"},y.list.map(function(e){return H.a.createElement(ae,{value:e.id_,key:e.id_},e.departName)})))),H.a.createElement(te,{label:"地址"},t.getFieldDecorator("address",{rules:[{message:"请输入用户地址！"}]})(H.a.createElement(M.a.TextArea,{placeholder:"请输入"}))))))))}),oe=q.a.create()(function(e){var a=e.UpdateModalVisible,t=e.form,l=e.handleUpdate,r=e.emailSuffixValue,n=e.handleUpdateModalVisible,i=e.emailInputChange,s=e.treeSelectChange,o=e.treeList,d=e.fileList,c=e.editModalData,u=e.siteList,p=e.uploadChange,m=e.departmentChange,g=e.departmentValue,h=e.departmentList,f={name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",className:"upload-list-inline",data:{type:1,xbType:""},headers:{Authorization:"Bearer ".concat(Object(G.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:G.A,onChange:p},y=Object(G.b)(ie[2]),E=y?{}:{footer:null},b=y?{}:{border:0,color:"rgba(0, 0, 0, .7)"};return H.a.createElement(R.a,B()({destroyOnClose:!0,title:y?"编辑":"详情",visible:a,className:ee.a.formModal,onOk:function(){t.validateFields(function(e,a){e||(t.resetFields(),l(a))})},onCancel:function(){return n()}},E,{width:800}),H.a.createElement("div",{className:ee.a.formModalBody},H.a.createElement(D.a,{gutter:40},H.a.createElement(O.a,{md:12,sm:24},H.a.createElement(te,{hasFeedback:y,label:"名称"},t.getFieldDecorator("fullname",{initialValue:c.fullname,rules:[{required:!0,message:"请输入用户名称"}]})(H.a.createElement(M.a,{disabled:!y,style:b,placeholder:"请输入"}))),H.a.createElement(te,{label:"登录账号"},t.getFieldDecorator("account",{initialValue:c.account,rules:[{required:!0,message:"请输入登录账号！"}]})(H.a.createElement(M.a,{style:b,placeholder:"请输入",disabled:!0}))),H.a.createElement(te,{hasFeedback:y,label:"电话号码"},t.getFieldDecorator("mobile",{initialValue:c.mobile,rules:[{required:!0,validator:G.h}]})(H.a.createElement(M.a,{disabled:!y,style:b,placeholder:"请输入"}))),H.a.createElement(te,{label:"职务"},t.getFieldDecorator("position",{initialValue:c.position,rules:[{required:!0,message:"请输入职务"}]})(H.a.createElement(M.a,{disabled:!y,style:b,placeholder:"请输入"}))),H.a.createElement(te,{label:"执法证件号"},t.getFieldDecorator("lawCard",{initialValue:c.lawCard,rules:[{message:"请输入执法证件号！"}]})(H.a.createElement(M.a,{disabled:!y,style:b,placeholder:"请输入"}))),H.a.createElement(te,{label:"执法证件图片"},t.getFieldDecorator("lawCardImg",{initialValue:c.lawCardImg})(H.a.createElement(U.a,B()({},f,{defaultFileList:d}),y?d.length>0?null:H.a.createElement(x.a,null,H.a.createElement(j.a,{type:"upload"})," 执法证件图片"):null)))),H.a.createElement(O.a,{md:12,sm:24},H.a.createElement(te,{label:"证件号码"},t.getFieldDecorator("idCard",{initialValue:c.idCard,rules:[{message:"请输入证件号码！"}]})(H.a.createElement(M.a,{disabled:!y,style:b,placeholder:"请输入"}))),H.a.createElement(te,{label:"邮箱"},t.getFieldDecorator("email",{initialValue:c.email,rules:[{message:"请输入用户的邮箱！"}]})(H.a.createElement(N.a,{disabled:!y,dataSource:r,style:V()({width:"100%"},b),onChange:i,placeholder:"请输入"}))),H.a.createElement(te,{hasFeedback:y,label:"区域"},t.getFieldDecorator("organId",{initialValue:[c.organId],rules:[{required:!0,message:"请选择区域！"}]})(H.a.createElement(w.a,{disabled:!y,treeData:o,style:V()({width:"100%"},b),placeholder:"请输入",onChange:function(e){t.setFieldsValue({siteIds:[],staticSite:[]}),s(e)}}))),H.a.createElement(te,{label:"部门"},t.getFieldDecorator("department",{rules:[{required:!0,message:"请选择部门"}],initialValue:c.department?c.department.split(","):[]})(H.a.createElement(L.a.Group,{onChange:m},ne[0].map(function(e,a){return H.a.createElement(L.a,{value:e,key:a},ne[1][a])})))),Object(G.C)()?H.a.createElement(K.Fragment,null,H.a.createElement(te,{label:"非现场站点"},t.getFieldDecorator("siteIds",{initialValue:c.siteIds?c.siteIds.split(","):[]})(H.a.createElement(w.a,{disabled:!y,placeholder:"请选择站点",treeCheckable:!0,treeData:u[0],style:V()({width:"100%"},b)}))),H.a.createElement(te,{label:"精简站"},t.getFieldDecorator("staticSite",{initialValue:c.staticSite?c.staticSite.split(","):[]})(H.a.createElement(w.a,{disabled:!y,placeholder:"请选择站点",treeCheckable:!0,treeData:u[1],style:V()({width:"100%"},b)})))):null,g&&H.a.createElement(te,{label:"子部门"},t.getFieldDecorator("departCode",{initialValue:c.departCode,rules:[{message:"请选择子部门！"}]})(H.a.createElement(A.a,{style:{width:"100%"},placeholder:"请选择"},h.list.map(function(e){return H.a.createElement(ae,{value:e.id_,key:e.id_},e.departName)})))),H.a.createElement(te,{label:"地址"},t.getFieldDecorator("address",{initialValue:c.address,rules:[{message:"请输入用户地址！"}]})(H.a.createElement(M.a.TextArea,{disabled:!y,style:b,placeholder:"请输入"})))))))}),de=Object(_.connect)(function(e){var a=e.TransportSystemDepart,t=e.system,l=e.systemUser,r=e.user,n=e.loading;return{TransportSystemDepart:a,system:t,systemUser:l,currentUser:r.currentUser,loading:n.models.systemUser,systemLoading:n.models.system}})(l=q.a.create()(l=function(e){function a(e){var t;return m()(this,a),(t=y()(this,b()(a).call(this,e))).state={modalVisible:!1,UpdateModalVisible:!1,departmentValue:!1,selectedRows:[],formValues:[],treeFormValue:{},defaultFormValue:{property:"isDelete",value:"0",group:"main",operation:"NOT_EQUAL",relation:"AND"},emailSuffixValue:[],selectedKeys:[],editModalData:{},importLoading:!1,pinyin:"",fullName:"",expandCheckKeys:[],fileList:[],pageBean:{page:1,pageSize:7,showTotal:!0},deptSearch:{}},t.columns=[{title:"登录名",dataIndex:"account"},{title:"姓名",dataIndex:"fullname"},{title:"电话",dataIndex:"mobile"},{title:"机构",dataIndex:"organName"},{title:"执法证件号",dataIndex:"lawCard"},{title:"执法证件图片",dataIndex:"lawCardImg",render:function(e,a){return H.a.createElement(u.a,{content:H.a.createElement("img",{style:{width:"auto",height:300},src:G.B+a.lawCardImg,alt:"执法卡图片",onError:function(e){e.target.onerror=null,e.target.src=Y.a}}),trigger:"hover"},H.a.createElement("img",{style:{width:"auto",height:50},src:G.B+a.lawCardImg,alt:"执法卡图片",onError:function(e){e.target.onerror=null,e.target.src=Y.a}}))}},{title:"地址",dataIndex:"address"},{title:"操作",width:190,render:function(e,a){return H.a.createElement(K.Fragment,null,H.a.createElement(c.a,{checkedChildren:"启用",unCheckedChildren:"禁用",checked:1===a.status,onClick:function(){return t.switchClick(a)}}),H.a.createElement(d.a,{type:"vertical"}),H.a.createElement(o.a,{placement:"left",title:Object(G.b)(ie[2])?"编辑":"详情"},H.a.createElement(x.a,{onClick:function(){return t.editData(a)},type:"primary",shape:"circle",icon:Object(G.b)(ie[2])?"edit":"eye",size:"small"})),Object(G.b)(ie[3])?H.a.createElement(K.Fragment,null,H.a.createElement(d.a,{type:"vertical"}),H.a.createElement(s.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},H.a.createElement(o.a,{placement:"left",title:"删除"},H.a.createElement(x.a,{type:"danger",shape:"circle",icon:"delete",size:"small"})))):null)}}],t.getList=function(e){(0,t.props.dispatch)({type:"systemUser/fetch",payload:e})},t.getDepartmentList=function(){(0,t.props.dispatch)({type:"TransportSystemDepart/fetch",payload:{pageBean:{page:1,pageSize:100,showTotal:!0}}})},t.departmentChange=function(e){t.setState({departmentValue:e.indexOf("-4")>-1})},t.switchClick=function(e){var a=t.props,l=a.dispatch,r=a.currentUser,n=t.state,s=n.defaultFormValue,o=n.deptSearch,d=n.pageBean;1===e.status?l({type:"systemUser/forbidden",payload:{account:e.account},callback:function(){i.a.success("禁用成功");var e=[s];Object.keys(o).length&&e.push(o),e.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:d,querys:e})}}):l({type:"systemUser/activate",payload:{account:e.account},callback:function(){i.a.success("启用成功");var e=[s];Object.keys(o).length&&e.push(o),e.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:d,querys:e})}})},t.editData=function(e){(0,t.props.dispatch)({type:"systemUser/detailData",payload:{account:e.account},callback:function(e){t.handleUpdateModalVisible(!0);var a=e.department?e.department.split(","):[];t.setState({editModalData:e,departmentValue:a.indexOf("-4")>-1,fileList:e.lawCardImg?[{uid:"-1",name:"当前图片",status:"done",url:G.B+e.lawCardImg}]:[]}),t.getSite(e.organId)}})},t.handleStandardTableChange=function(e){var a=t.props.currentUser,l=t.state,r=l.formValues,n=l.defaultFormValue,i=l.treeFormValue,s=l.deptSearch,o=[];o.unshift(n),Object.keys(s).length&&o.push(s),"{}"!==JSON.stringify(i)?o.push(i):o.push({property:"organId",value:a.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"});var d={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:o.concat(r)};t.getList(d)},t.handleFormReset=function(){var e=t.props,a=e.form,l=e.currentUser,r=t.state,n=r.defaultFormValue,i=r.pageBean,s=r.deptSearch;a.resetFields(),t.setState({formValues:[],treeFormValue:{},selectedKeys:[]});var o=[n];Object.keys(s).length&&o.push(s),t.getList({pageBean:i,querys:[].concat(o,[{property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}])})},t.emailInputChange=function(e){t.setState({emailSuffixValue:Object(G.m)(e)})},t.delBatch=function(){var e=t.state.selectedRows;e&&le({title:"提示",content:"您确定要批量删除吗?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){t.delUtil("".concat(e.map(function(e){return e.id}).join(),","))},onCancel:function(){}})},t.delUtil=function(e){var a=t.props,l=a.dispatch,r=a.currentUser,n=t.state,s=n.defaultFormValue,o=n.deptSearch,d=n.pageBean;l({type:"systemUser/remove",payload:{ids:e},callback:function(){i.a.success("删除成功"),t.setState({selectedRows:[]});var e=[s];Object.keys(o).length&&e.push(o),e.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:d,querys:e})}})},t.activateBatch=function(){var e=t.props,a=e.dispatch,l=e.currentUser,r=t.state,n=r.selectedRows,s=r.defaultFormValue,o=r.deptSearch,d=r.pageBean;if(n){var c=S()(t);le({title:"提示",content:"您确定要批量启用吗?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){a({type:"systemUser/activate",payload:{account:n.map(function(e){return e.account}).join()},callback:function(){i.a.success("启用成功");var e=[s];Object.keys(o).length&&e.push(o),e.push({property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:d,querys:e}),c.setState({selectedRows:[]})}})},onCancel:function(){}})}},t.forbiddenBatch=function(){var e=t.props,a=e.dispatch,l=e.currentUser,r=t.state,n=r.selectedRows,s=r.defaultFormValue,o=r.pageBean,d=r.deptSearch;if(n){var c=S()(t);le({title:"提示",content:"您确定要批量删禁用吗?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){a({type:"systemUser/forbidden",payload:{account:n.map(function(e){return e.account}).join()},callback:function(){i.a.success("禁用成功");var e=[s];Object.keys(d).length&&e.push(d),e.push({property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:o,querys:e}),c.setState({selectedRows:[]})}})},onCancel:function(){}})}},t.importClick=function(){t.setState({importLoading:!0});var e=t.props.dispatch,a=t.state,l=a.formValues,r=a.treeFormValue,n=a.defaultFormValue,s=a.deptSearch,o=a.pageBean,d=[];d.unshift(n),Object.keys(s).length&&d.push(s),"{}"!==JSON.stringify(r)&&d.push(r),e({type:"systemUser/import",payload:{pageBean:o,querys:Array.from(new Set(d.concat(l)))},callback:function(e){404===e&&i.a.error("当前没有数据"),t.setState({importLoading:!1})}})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.handleSearch=function(e){e.preventDefault();var a=t.props,l=a.form,r=a.currentUser,n=t.state,i=n.treeFormValue,s=n.defaultFormValue,o=n.pageBean,d=n.deptSearch;l.validateFields(function(e,a){if(!e){var l=V()({},a),n=Object.keys(l).map(function(e){return l[e]?{property:e,value:l[e],group:"main",operation:"departCode"===e?"EQUAL":"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:n}),n.unshift(s),Object.keys(d).length&&n.push(d),"{}"!==JSON.stringify(i)?n.push(i):n.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:o,querys:n})}})},t.handleModalVisible=function(e){0,t.setState({modalVisible:!!e,fullName:""}),e||t.setState({pinyin:"",fileList:[],departmentValue:!1})},t.handleUpdateModalVisible=function(e){0,t.setState({UpdateModalVisible:!!e,fullName:""}),e||t.setState({editModalData:{},fileList:[],departmentValue:!1})},t.handleAdd=function(e,a){var l=t.props,r=l.dispatch,n=l.currentUser,s=t.state,o=s.defaultFormValue,d=s.pageBean,c=s.deptSearch;s.fileList;e.lawCardImg=e.lawCardImg?e.lawCardImg.file.response.filePath:"",e.siteIds=e.siteIds?e.siteIds.join():"",e.staticSite=e.staticSite?e.staticSite.join():"",e.department=e.department.join(),r({type:"systemUser/add",payload:e,callback:function(){i.a.success("添加成功"),t.handleModalVisible();var e=[o];Object.keys(c).length&&e.push(c),e.push({property:"organId",value:n.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:d,querys:e}),a&&a()}})},t.handleUpdate=function(e){var a=t.props,l=a.dispatch,r=a.currentUser,n=t.state,s=n.editModalData,o=n.defaultFormValue,d=n.deptSearch,c=n.pageBean,u=(n.fileList,JSON.parse(JSON.stringify(s))),p=Object.keys(e);if("object"==typeof e.organId&&(e.organId=e.organId[0]),"object"==typeof e.lawCardImg){var m=e.lawCardImg.file.response;e.lawCardImg=m?m.filePath:""}for(var g=0;g<p.length;g+=1)u[p[g]]=e[p[g]];Object(G.C)()&&(u.siteIds=e.siteIds?e.siteIds.join():"",u.staticSite=e.staticSite?e.staticSite.join():""),u.department=e.department.join(),t.setState({editModalData:u}),l({type:"systemUser/update",payload:u,callback:function(){i.a.success("编辑成功"),t.handleUpdateModalVisible();var e=[o];Object.keys(d).length&&e.push(d),e.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:c,querys:e})}})},t.setRoleCode=function(e){var a=t.state.fullName,l=t.props.dispatch;if(!a)return i.a.error("请先输入用户名称");l({type:"system/getPinyin",payload:{chinese:a,type:2},callback:function(a){t.setState({pinyin:a}),e&&e(a)}})},t.getFullName=function(e){t.setState({fullName:e.target.value})},t.treeSelectChange=function(e,a){var l=t.state.editModalData,r=JSON.parse(JSON.stringify(l));r.siteIds="",r.staticSite="",t.setState({editModalData:r}),t.getSite(e)},t.getSite=function(e){(0,t.props.dispatch)({type:"systemUser/getSite",payload:{pageBean:{page:1,pageSize:1e3,showTotal:!0},querys:[{property:"status",value:"0",group:"main",operation:"NOT_EQUAL",relation:"AND"},{property:"organId",value:e,group:"main",operation:"RIGHT_LIKE",relation:"AND"}]}})},t.onSelect=function(e){if(e[0]){t.setState({selectedKeys:e});var a=t.state,l=a.formValues,r=a.defaultFormValue,n=a.pageBean,i=a.deptSearch,s=[],o={property:"organId",value:e[0],group:"main",operation:"RIGHT_LIKE",relation:"AND"};t.setState({treeFormValue:o}),s.unshift(r),Object.keys(i).length&&s.push(i),s.push(o),s=s.concat(l),t.getList({pageBean:n,querys:s})}},t.expandCheck=function(e){t.setState({expandCheckKeys:e})},t.renderTreeNodes=function(e){return e.map(function(e){return e.children?H.a.createElement(n.a.TreeNode,{title:e.title,key:e.key,dataRef:e},t.renderTreeNodes(e.children)):H.a.createElement(n.a.TreeNode,e)})},t.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(i.a.success("上传成功"),t.setState({fileList:e.fileList})):i.a.error(e.file.response.code.msg):"error"===e.file.status?i.a.error("上传失败"):"removed"===e.file.status&&t.setState({fileList:e.fileList})},ne=Object(G.y)(),ie=Object(G.E)(re),t}return v()(a,e),h()(a,[{key:"componentDidMount",value:function(){var e=this.state,a=e.defaultFormValue,t=e.pageBean;0;var l=localStorage.getItem("organId"),r=JSON.parse(localStorage.getItem("mainMsg")||"{}"),n=r.department?r.department.split(","):[],i={property:"department",value:n.join(),group:"main",operation:"LIKE",relation:"AND"},s=[a];n.length<4&&(s.push(i),this.setState({deptSearch:i})),this.getList({pageBean:t,querys:[].concat(s,[{property:"organId",value:l,group:"main",operation:"RIGHT_LIKE",relation:"AND"}])}),this.getDepartmentList()}},{key:"componentWillUnmount",value:function(){0}},{key:"dataDel",value:function(e){this.delUtil(e)}},{key:"renderSimpleForm",value:function(){var e=this.props,a=e.form.getFieldDecorator,t=e.TransportSystemDepart.data;return H.a.createElement(q.a,{onSubmit:this.handleSearch,layout:"inline"},H.a.createElement(D.a,{gutter:8},H.a.createElement(O.a,{md:5,sm:24},H.a.createElement(te,null,a("account")(H.a.createElement(M.a,{addonBefore:"登录名",placeholder:"请输入"})))),H.a.createElement(O.a,{md:5,sm:24},H.a.createElement(te,null,a("fullname")(H.a.createElement(M.a,{addonBefore:"姓名",placeholder:"请输入"})))),H.a.createElement(O.a,{md:5,sm:24},H.a.createElement(te,null,a("mobile")(H.a.createElement(M.a,{addonBefore:"电话",placeholder:"请输入"})))),ne[0].indexOf("-4")>-1&&H.a.createElement(O.a,{md:5,sm:24},H.a.createElement("div",{className:W.a.inputMain},H.a.createElement("span",{style:{width:"70px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"子部门"),H.a.createElement(te,{style:{flex:1}},a("departCode")(H.a.createElement(A.a,{style:{width:"100%"},placeholder:"请选择"},t.list.map(function(e){return H.a.createElement(ae,{key:e.id_},e.departName)})))))),H.a.createElement(O.a,{md:4,sm:24},H.a.createElement("span",{className:Q.a.submitButtons},H.a.createElement(x.a,{type:"primary",htmlType:"submit"},"查询"),H.a.createElement(x.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.system.treeList,l=a.systemUser,i=l.data,s=l.siteList,o=a.TransportSystemDepart,d=a.loading,c=a.systemLoading,u=this.state,p=u.expandCheckKeys,m=u.selectedRows,g=u.modalVisible,h=u.UpdateModalVisible,f=u.editModalData,y=u.importLoading,E=u.pinyin,b=u.selectedKeys,C=u.emailSuffixValue,S=u.fileList,I=u.departmentValue,v={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible,emailSuffixValue:C,emailInputChange:this.emailInputChange,treeList:t,setRoleCode:this.setRoleCode,pinyin:E,getFullName:this.getFullName,siteList:s,fileList:S,loading:c,uploadChange:this.uploadChange,treeSelectChange:this.treeSelectChange,handleDepartVisible:this.handleDepartVisible,departmentChange:this.departmentChange,departmentValue:I,departmentList:o.data},k={handleUpdate:this.handleUpdate,handleUpdateModalVisible:this.handleUpdateModalVisible,emailSuffixValue:C,emailInputChange:this.emailInputChange,treeList:t,editModalData:f,siteList:s,fileList:S,uploadChange:this.uploadChange,treeSelectChange:this.treeSelectChange,departmentChange:this.departmentChange,departmentValue:I,departmentList:o.data},V={tableAlert:!0,selectedRows:m,size:"middle",loading:d,data:i,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange};return H.a.createElement(K.Fragment,null,Object(G.b)(ie[0])?null:H.a.createElement(z.a,{to:"/exception/403"}),H.a.createElement("div",{className:Q.a.tableMain},H.a.createElement(F.a,{spinning:c},H.a.createElement("div",{className:Q.a.treeLeft},H.a.createElement(n.a,{selectedKeys:b,showLine:!0,onSelect:this.onSelect,expandedKeys:p[0]?p:[t[0]?t[0].key:""],onExpand:this.expandCheck},this.renderTreeNodes(t)))),H.a.createElement("div",{className:Q.a.rightTable},H.a.createElement(r.a,{bordered:!1,style:{height:"100%"}},H.a.createElement("div",{className:Q.a.tableList},H.a.createElement("div",{className:Q.a.tableListForm},this.renderSimpleForm()),H.a.createElement("div",{className:Q.a.tableListOperator},H.a.createElement(x.a,{icon:"plus",style:{display:Object(G.b)(ie[1])?"inline":"none"},type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新增"),m.length>0&&H.a.createElement("span",null,Object(G.b)(ie[3])?H.a.createElement(x.a,{type:"danger",onClick:this.delBatch},"批量删除"):null,H.a.createElement(x.a,{onClick:this.activateBatch},"批量启用"),H.a.createElement(x.a,{onClick:this.forbiddenBatch},"批量禁用")),H.a.createElement(x.a,{className:W.a.import,icon:"import",onClick:this.importClick,loading:y,style:{float:"right"}},"导出"),H.a.createElement("div",{style:{clear:"both"}})),H.a.createElement(J.a,V))))),H.a.createElement(se,B()({},v,{modalVisible:g})),h&&"{}"!==JSON.stringify(f)?H.a.createElement(oe,B()({},k,{UpdateModalVisible:h})):null)}}]),a}(K.PureComponent))||l)||l;a.default=de}}]);