(window.webpackJsonp=window.webpackJsonp||[]).push([[195],{HPha:function(e,a,t){"use strict";t.r(a);t("IzEo");var l,r=t("bx4M"),n=(t("ozfa"),t("MJZm")),i=(t("miYZ"),t("tsqr")),s=(t("P2fV"),t("NJEC")),o=(t("5Dmo"),t("3S7+")),c=(t("/zsF"),t("PArb")),d=(t("BoS7"),t("Sdc0")),u=(t("Q9mQ"),t("diRs")),p=t("lwsE"),m=t.n(p),g=t("W8MJ"),h=t.n(g),f=t("a1gu"),y=t.n(f),E=t("Nsbk"),b=t.n(E),S=t("PJYZ"),I=t.n(S),C=t("7W2i"),v=t.n(C),F=t("MVZn"),w=t.n(F),L=(t("T2oS"),t("W9HT")),k=(t("14J3"),t("BMrR")),V=(t("sRBo"),t("kaz8")),D=(t("nRaC"),t("5RzL")),N=(t("O3gP"),t("lrIw")),U=(t("jCWc"),t("kPKH")),O=(t("DZo9"),t("8z0m")),T=t("pVnL"),j=t.n(T),B=(t("+L6B"),t("2/Rp")),M=(t("Pwec"),t("CtXQ")),x=(t("5NDa"),t("5rEg")),R=(t("2qtc"),t("kLXV")),q=(t("y8nQ"),t("Vl3Y")),A=(t("OaEy"),t("2fM7")),K=t("q1tI"),z=t.n(K),H=t("MuoO"),G=t("CkN6"),J=t("mf+E"),_=t("+n12"),P=t("9zHi"),Q=t.n(P),Z=t("ns75"),W=t.n(Z),X=t("dscJ"),Y=t.n(X),$=t("ZP6J"),ee=t.n($),ae=(A.a.Option,q.a.Item),te=R.a.confirm,le=["/system/user","/system/user/adduser","/system/user/updateUser","/system/user/deleteUserByIds","/system/user/export","/conserve/data/user","/conserve/data/user/add","/conserve/data/user/update","/conserve/data/user/delete","/conserve/data/user/export","/maritime/data/user","/maritime/data/user/add","/maritime/data/user/update","/maritime/data/user/delete","/maritime/data/user/export","/transport/system/user","/transport/system/user/add","/transport/system/user/update","/transport/system/user/delete","/transport/system/user/export"],re=[[],[]],ne=[],ie=q.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleAdd,r=e.emailSuffixValue,n=e.handleModalVisible,i=e.emailInputChange,s=e.treeList,o=e.setRoleCode,c=(e.pinyin,e.loading),d=e.getFullName,u=e.treeSelectChange,p=e.siteList,m=e.fileList,g=e.uploadChange,h=e.departmentChange,f=(e.departmentValue,e.departmentList,e.lawSignaFileList),y=e.lawSignaUploadChange,E={name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",data:{type:1,xbType:""},headers:{Authorization:"Bearer ".concat(Object(_.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:_.D,onChange:g};return z.a.createElement(R.a,{destroyOnClose:!0,title:"添加用户",className:ee.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})},onCancel:function(){return n()},width:800},z.a.createElement(L.a,{spinning:c,tip:"正在获取"},z.a.createElement("div",{className:ee.a.formModalBody},z.a.createElement(k.a,{gutter:40},z.a.createElement(U.a,{md:12,sm:24},z.a.createElement(ae,{hasFeedback:!0,label:"名称"},t.getFieldDecorator("fullname",{rules:[{required:!0,message:"请输入用户名称"}]})(z.a.createElement(x.a,{placeholder:"请输入",onChange:d}))),z.a.createElement(ae,{label:"登录账号"},t.getFieldDecorator("account",{rules:[{required:!0,message:"请获取登录账号！"}]})(z.a.createElement(x.a,{placeholder:"请输入",onFocus:function(){o(function(e){t.setFieldsValue({account:e})})}}))),z.a.createElement(ae,{hasFeedback:!0,label:"密码"},t.getFieldDecorator("password",{rules:[{required:!0,min:6,message:"请输入账号密码！"}]})(z.a.createElement(x.a,{type:"password",placeholder:"请输入"}))),z.a.createElement(ae,{hasFeedback:!0,label:"电话号码"},t.getFieldDecorator("mobile",{rules:[{required:!0,validator:_.j}]})(z.a.createElement(x.a,{placeholder:"请输入"}))),z.a.createElement(ae,{hasFeedback:!0,label:"职务"},t.getFieldDecorator("position",{rules:[{required:!0,message:"请输入职务"}]})(z.a.createElement(x.a,{placeholder:"请输入"}))),z.a.createElement(ae,{label:"执法证件号"},t.getFieldDecorator("lawCard",{rules:[{message:"请输入执法证件号！"}]})(z.a.createElement(x.a,{placeholder:"请输入"}))),z.a.createElement(ae,{label:"执法证件图片"},t.getFieldDecorator("lawCardImg")(z.a.createElement(O.a,j()({},E,{defaultFileList:m,onChange:g}),m.length>0?null:z.a.createElement(B.a,null,z.a.createElement(M.a,{type:"upload"})," 执法证件图片")))),z.a.createElement(ae,{label:"签名"},t.getFieldDecorator("lawSigna")(z.a.createElement(O.a,j()({},E,{defaultFileList:f,onChange:y}),f.length>0?null:z.a.createElement(B.a,null,z.a.createElement(M.a,{type:"upload"})," 签名"))))),z.a.createElement(U.a,{md:12,sm:24},z.a.createElement(ae,{label:"证件号码"},t.getFieldDecorator("idCard",{rules:[{message:"请输入证件号码！"}]})(z.a.createElement(x.a,{placeholder:"请输入"}))),z.a.createElement(ae,{label:"邮箱"},t.getFieldDecorator("email",{rules:[{type:"email",message:"请输入正确的邮箱"},{message:"请输入正确的邮箱！"}]})(z.a.createElement(N.a,{dataSource:r,style:{width:"100%"},onChange:i,placeholder:"请输入"}))),z.a.createElement(ae,{hasFeedback:!0,label:"区域"},t.getFieldDecorator("organId",{rules:[{required:!0,message:"请选择区域！"}]})(z.a.createElement(D.a,{treeData:s,style:{width:"100%"},placeholder:"请选择",onChange:function(e){t.setFieldsValue({siteIds:[],staticSite:[]}),u(e)}}))),z.a.createElement(ae,{label:"部门"},t.getFieldDecorator("department",{rules:[{required:!0,message:"请选择部门"}]})(z.a.createElement(V.a.Group,{onChange:h},re[0].map(function(e,a){return z.a.createElement(V.a,{value:e,key:a},re[1][a])})))),Object(_.G)()?z.a.createElement(K.Fragment,null,z.a.createElement(ae,{label:"非现场站点"},t.getFieldDecorator("siteIds",{})(z.a.createElement(D.a,{placeholder:"请选择站点",treeCheckable:!0,treeData:p[0],style:{width:"100%"}}))),z.a.createElement(ae,{label:"精简站"},t.getFieldDecorator("staticSite",{})(z.a.createElement(D.a,{placeholder:"请选择站点",treeCheckable:!0,treeData:p[1],style:{width:"100%"}})))):null,z.a.createElement(ae,{label:"地址"},t.getFieldDecorator("address",{rules:[{message:"请输入用户地址！"}]})(z.a.createElement(x.a.TextArea,{placeholder:"请输入"}))))))))}),se=q.a.create()(function(e){var a=e.UpdateModalVisible,t=e.form,l=e.handleUpdate,r=e.emailSuffixValue,n=e.handleUpdateModalVisible,i=e.emailInputChange,s=e.treeSelectChange,o=e.treeList,c=e.fileList,d=e.editModalData,u=e.siteList,p=(e.uploadChange,e.departmentChange),m=(e.departmentValue,e.departmentList,e.lawSignaFileList),g=e.lawSignaUploadChange,h={name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",className:"upload-list-inline",data:{type:1,xbType:""},headers:{Authorization:"Bearer ".concat(Object(_.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:_.D},f=Object(_.c)(ne[2]),y=f?{}:{footer:null},E=f?{}:{border:0,color:"rgba(0, 0, 0, .7)"};return z.a.createElement(R.a,j()({destroyOnClose:!0,title:f?"编辑":"详情",visible:a,className:ee.a.formModal,onOk:function(){t.validateFields(function(e,a){e||(t.resetFields(),l(a))})},onCancel:function(){return n()}},y,{width:800}),z.a.createElement("div",{className:ee.a.formModalBody},z.a.createElement(k.a,{gutter:40},z.a.createElement(U.a,{md:12,sm:24},z.a.createElement(ae,{hasFeedback:f,label:"名称"},t.getFieldDecorator("fullname",{initialValue:d.fullname,rules:[{required:!0,message:"请输入用户名称"}]})(z.a.createElement(x.a,{disabled:!f,style:E,placeholder:"请输入"}))),z.a.createElement(ae,{label:"登录账号"},t.getFieldDecorator("account",{initialValue:d.account,rules:[{required:!0,message:"请输入登录账号！"}]})(z.a.createElement(x.a,{style:E,placeholder:"请输入",disabled:!0}))),z.a.createElement(ae,{hasFeedback:f,label:"电话号码"},t.getFieldDecorator("mobile",{initialValue:d.mobile,rules:[{required:!0,validator:_.j}]})(z.a.createElement(x.a,{disabled:!f,style:E,placeholder:"请输入"}))),z.a.createElement(ae,{label:"职务"},t.getFieldDecorator("position",{initialValue:d.position,rules:[{required:!0,message:"请输入职务"}]})(z.a.createElement(x.a,{disabled:!f,style:E,placeholder:"请输入"}))),z.a.createElement(ae,{label:"执法证件号"},t.getFieldDecorator("lawCard",{initialValue:d.lawCard,rules:[{message:"请输入执法证件号！"}]})(z.a.createElement(x.a,{disabled:!f,style:E,placeholder:"请输入"}))),z.a.createElement(ae,{label:"执法证件图片"},t.getFieldDecorator("lawCardImg",{initialValue:d.lawCardImg})(z.a.createElement(O.a,j()({},h,{defaultFileList:c}),f&&(c.length>0?null:z.a.createElement(B.a,null,z.a.createElement(M.a,{type:"upload"})," 执法证件图片"))))),z.a.createElement(ae,{label:"签名"},t.getFieldDecorator("lawSigna",{initialValue:d.lawSigna})(z.a.createElement(O.a,j()({},h,{defaultFileList:m,onChange:g}),f&&(m.length>0?null:z.a.createElement(B.a,null,z.a.createElement(M.a,{type:"upload"})," 签名")))))),z.a.createElement(U.a,{md:12,sm:24},z.a.createElement(ae,{label:"证件号码"},t.getFieldDecorator("idCard",{initialValue:d.idCard,rules:[{message:"请输入证件号码！"}]})(z.a.createElement(x.a,{disabled:!f,style:E,placeholder:"请输入"}))),z.a.createElement(ae,{label:"邮箱"},t.getFieldDecorator("email",{initialValue:d.email,rules:[{message:"请输入用户的邮箱！"}]})(z.a.createElement(N.a,{disabled:!f,dataSource:r,style:w()({width:"100%"},E),onChange:i,placeholder:"请输入"}))),z.a.createElement(ae,{hasFeedback:f,label:"区域"},t.getFieldDecorator("organId",{initialValue:[d.organId],rules:[{required:!0,message:"请选择区域！"}]})(z.a.createElement(D.a,{disabled:!f,treeData:o,style:w()({width:"100%"},E),placeholder:"请输入",onChange:function(e){t.setFieldsValue({siteIds:[],staticSite:[]}),s(e)}}))),z.a.createElement(ae,{label:"部门"},t.getFieldDecorator("department",{rules:[{required:!0,message:"请选择部门"}],initialValue:d.department?d.department.split(","):[]})(z.a.createElement(V.a.Group,{onChange:p},re[0].map(function(e,a){return z.a.createElement(V.a,{value:e,key:a},re[1][a])})))),Object(_.G)()?z.a.createElement(K.Fragment,null,z.a.createElement(ae,{label:"非现场站点"},t.getFieldDecorator("siteIds",{initialValue:d.siteIds?d.siteIds.split(","):[]})(z.a.createElement(D.a,{disabled:!f,placeholder:"请选择站点",treeCheckable:!0,treeData:u[0],style:w()({width:"100%"},E)}))),z.a.createElement(ae,{label:"精简站"},t.getFieldDecorator("staticSite",{initialValue:d.staticSite?d.staticSite.split(","):[]})(z.a.createElement(D.a,{disabled:!f,placeholder:"请选择站点",treeCheckable:!0,treeData:u[1],style:w()({width:"100%"},E)})))):null,z.a.createElement(ae,{label:"地址"},t.getFieldDecorator("address",{initialValue:d.address,rules:[{message:"请输入用户地址！"}]})(z.a.createElement(x.a.TextArea,{disabled:!f,style:E,placeholder:"请输入"})))))))}),oe=Object(H.connect)(function(e){var a=e.TransportSystemDepart,t=e.system,l=e.systemUser,r=e.user,n=e.loading;return{TransportSystemDepart:a,system:t,systemUser:l,currentUser:r.currentUser,loading:n.models.systemUser,systemLoading:n.models.system}})(l=q.a.create()(l=function(e){function a(e){var t;return m()(this,a),(t=y()(this,b()(a).call(this,e))).state={modalVisible:!1,UpdateModalVisible:!1,departmentValue:!1,selectedRows:[],formValues:[],treeFormValue:{},defaultFormValue:{property:"isDelete",value:"0",group:"main",operation:"NOT_EQUAL",relation:"AND"},emailSuffixValue:[],selectedKeys:[],editModalData:{},importLoading:!1,pinyin:"",fullName:"",expandCheckKeys:[],fileList:[],lawSignaFileList:[],pageBean:{page:1,pageSize:7,showTotal:!0},deptSearch:{}},t.columns=[{title:"登录名",dataIndex:"account"},{title:"姓名",dataIndex:"fullname"},{title:"电话",dataIndex:"mobile"},{title:"机构",dataIndex:"organName"},{title:"执法证件号",dataIndex:"lawCard"},{title:"执法证件图片",dataIndex:"lawCardImg",render:function(e,a){return z.a.createElement(u.a,{content:z.a.createElement("img",{style:{width:"auto",height:300},src:_.E+a.lawCardImg,alt:"执法卡图片",onError:function(e){e.target.onerror=null,e.target.src=Y.a}}),trigger:"hover"},z.a.createElement("img",{style:{width:"auto",height:50},src:_.E+a.lawCardImg,alt:"执法卡图片",onError:function(e){e.target.onerror=null,e.target.src=Y.a}}))}},{title:"地址",dataIndex:"address"},{title:"操作",width:190,render:function(e,a){return z.a.createElement(K.Fragment,null,z.a.createElement(d.a,{checkedChildren:"启用",unCheckedChildren:"禁用",checked:1===a.status,onClick:function(){return t.switchClick(a)}}),z.a.createElement(c.a,{type:"vertical"}),z.a.createElement(o.a,{placement:"left",title:Object(_.c)(ne[2])?"编辑":"详情"},z.a.createElement(B.a,{onClick:function(){return t.editData(a)},type:"primary",shape:"circle",icon:Object(_.c)(ne[2])?"edit":"eye",size:"small"})),Object(_.c)(ne[3])?z.a.createElement(K.Fragment,null,z.a.createElement(c.a,{type:"vertical"}),z.a.createElement(s.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},z.a.createElement(o.a,{placement:"left",title:"删除"},z.a.createElement(B.a,{type:"danger",shape:"circle",icon:"delete",size:"small"})))):null)}}],t.getList=function(e){(0,t.props.dispatch)({type:"systemUser/fetch",payload:e})},t.getDepartmentList=function(){(0,t.props.dispatch)({type:"TransportSystemDepart/fetch",payload:{pageBean:{page:1,pageSize:100,showTotal:!0}}})},t.departmentChange=function(e){t.setState({departmentValue:e.indexOf("-4")>-1})},t.switchClick=function(e){var a=t.props,l=a.dispatch,r=a.currentUser,n=t.state,s=n.defaultFormValue,o=n.deptSearch,c=n.pageBean;1===e.status?l({type:"systemUser/forbidden",payload:{account:e.account},callback:function(){i.a.success("禁用成功");var e=[s];Object.keys(o).length&&e.push(o),e.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:c,querys:e})}}):l({type:"systemUser/activate",payload:{account:e.account},callback:function(){i.a.success("启用成功");var e=[s];Object.keys(o).length&&e.push(o),e.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:c,querys:e})}})},t.editData=function(e){(0,t.props.dispatch)({type:"systemUser/detailData",payload:{account:e.account},callback:function(e){t.handleUpdateModalVisible(!0);var a=e.department?e.department.split(","):[];t.setState({editModalData:e,departmentValue:a.indexOf("-4")>-1,fileList:e.lawCardImg?[{uid:"-1",name:"当前图片",status:"done",url:_.E+e.lawCardImg}]:[],lawSignaFileList:e.lawSigna?[{uid:"-2",name:"当前图片",status:"done",url:_.E+e.lawSigna}]:[]}),t.getSite(e.organId)}})},t.handleStandardTableChange=function(e){var a=t.props.currentUser,l=t.state,r=l.formValues,n=l.defaultFormValue,i=l.treeFormValue,s=l.deptSearch,o=[];o.unshift(n),Object.keys(s).length&&o.push(s),"{}"!==JSON.stringify(i)?o.push(i):o.push({property:"organId",value:a.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"});var c={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:o.concat(r)};t.getList(c)},t.handleFormReset=function(){var e=t.props,a=e.form,l=e.currentUser,r=t.state,n=r.defaultFormValue,i=r.pageBean,s=r.deptSearch;a.resetFields(),t.setState({formValues:[],treeFormValue:{},selectedKeys:[]});var o=[n];Object.keys(s).length&&o.push(s),t.getList({pageBean:i,querys:[].concat(o,[{property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}])})},t.emailInputChange=function(e){t.setState({emailSuffixValue:Object(_.p)(e)})},t.delBatch=function(){var e=t.state.selectedRows;e&&te({title:"提示",content:"您确定要批量删除吗?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){t.delUtil("".concat(e.map(function(e){return e.id}).join(),","))},onCancel:function(){}})},t.delUtil=function(e){var a=t.props,l=a.dispatch,r=a.currentUser,n=t.state,s=n.defaultFormValue,o=n.deptSearch,c=n.pageBean;l({type:"systemUser/remove",payload:{ids:e},callback:function(){i.a.success("删除成功"),t.setState({selectedRows:[]});var e=[s];Object.keys(o).length&&e.push(o),e.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:c,querys:e})}})},t.activateBatch=function(){var e=t.props,a=e.dispatch,l=e.currentUser,r=t.state,n=r.selectedRows,s=r.defaultFormValue,o=r.deptSearch,c=r.pageBean;if(n){var d=I()(t);te({title:"提示",content:"您确定要批量启用吗?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){a({type:"systemUser/activate",payload:{account:n.map(function(e){return e.account}).join()},callback:function(){i.a.success("启用成功");var e=[s];Object.keys(o).length&&e.push(o),e.push({property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:c,querys:e}),d.setState({selectedRows:[]})}})},onCancel:function(){}})}},t.forbiddenBatch=function(){var e=t.props,a=e.dispatch,l=e.currentUser,r=t.state,n=r.selectedRows,s=r.defaultFormValue,o=r.pageBean,c=r.deptSearch;if(n){var d=I()(t);te({title:"提示",content:"您确定要批量删禁用吗?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){a({type:"systemUser/forbidden",payload:{account:n.map(function(e){return e.account}).join()},callback:function(){i.a.success("禁用成功");var e=[s];Object.keys(c).length&&e.push(c),e.push({property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:o,querys:e}),d.setState({selectedRows:[]})}})},onCancel:function(){}})}},t.importClick=function(){t.setState({importLoading:!0});var e=t.props.dispatch,a=t.state,l=a.formValues,r=a.treeFormValue,n=a.defaultFormValue,s=a.deptSearch,o=a.pageBean,c=[];c.unshift(n),Object.keys(s).length&&c.push(s),"{}"!==JSON.stringify(r)&&c.push(r),e({type:"systemUser/import",payload:{pageBean:o,querys:Array.from(new Set(c.concat(l)))},callback:function(e){404===e&&i.a.error("当前没有数据"),t.setState({importLoading:!1})}})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.handleSearch=function(e){e.preventDefault();var a=t.props,l=a.form,r=a.currentUser,n=t.state,i=n.treeFormValue,s=n.defaultFormValue,o=n.pageBean,c=n.deptSearch;l.validateFields(function(e,a){if(!e){var l=w()({},a),n=Object.keys(l).map(function(e){return l[e]?{property:e,value:l[e],group:"main",operation:"departCode"===e?"EQUAL":"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:n}),n.unshift(s),Object.keys(c).length&&n.push(c),"{}"!==JSON.stringify(i)?n.push(i):n.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:o,querys:n})}})},t.handleModalVisible=function(e){0,t.setState({modalVisible:!!e,fullName:""}),e||t.setState({pinyin:"",fileList:[],lawSignaFileList:[],departmentValue:!1})},t.handleUpdateModalVisible=function(e){0,t.setState({UpdateModalVisible:!!e,fullName:""}),e||t.setState({editModalData:{},fileList:[],lawSignaFileList:[],departmentValue:!1})},t.handleAdd=function(e,a){var l=t.props,r=l.dispatch,n=l.currentUser,s=t.state,o=s.defaultFormValue,c=s.pageBean,d=s.deptSearch,u=(s.fileList,w()({},e));u.lawCardImg=e.lawCardImg?e.lawCardImg.file.response.filePath:"",u.lawSigna=e.lawSigna?e.lawSigna.file.response.filePath:"",u.siteIds=e.siteIds?e.siteIds.join():"",u.staticSite=e.staticSite?e.staticSite.join():"",u.department=e.department.join(),r({type:"systemUser/add",payload:u,callback:function(){i.a.success("添加成功"),t.handleModalVisible();var e=[o];Object.keys(d).length&&e.push(d),e.push({property:"organId",value:n.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:c,querys:e}),a&&a()}})},t.handleUpdate=function(e){var a=t.props,l=a.dispatch,r=a.currentUser,n=t.state,s=n.editModalData,o=n.defaultFormValue,c=n.deptSearch,d=n.pageBean,u=JSON.parse(JSON.stringify(s)),p=Object.keys(e);if("object"==typeof e.organId&&(e.organId=e.organId[0]),"object"==typeof e.lawCardImg){var m=e.lawCardImg.file.response;e.lawCardImg=m?m.filePath:""}if("object"==typeof e.lawSigna){var g=e.lawSigna.file.response;e.lawSigna=g?g.filePath:""}for(var h=0;h<p.length;h+=1)u[p[h]]=e[p[h]];Object(_.G)()&&(u.siteIds=e.siteIds?e.siteIds.join():"",u.staticSite=e.staticSite?e.staticSite.join():""),u.department=e.department.join(),t.setState({editModalData:u}),l({type:"systemUser/update",payload:u,callback:function(){i.a.success("编辑成功"),t.handleUpdateModalVisible();var e=[o];Object.keys(c).length&&e.push(c),e.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:d,querys:e})}})},t.setRoleCode=function(e){var a=t.state.fullName,l=t.props.dispatch;if(!a)return i.a.error("请先输入用户名称");l({type:"system/getPinyin",payload:{chinese:a,type:2},callback:function(a){t.setState({pinyin:a}),e&&e(a)}})},t.getFullName=function(e){t.setState({fullName:e.target.value})},t.treeSelectChange=function(e,a){var l=t.state.editModalData,r=JSON.parse(JSON.stringify(l));r.siteIds="",r.staticSite="",t.setState({editModalData:r}),t.getSite(e)},t.getSite=function(e){(0,t.props.dispatch)({type:"systemUser/getSite",payload:{pageBean:{page:1,pageSize:1e3,showTotal:!0},querys:[{property:"status",value:"0",group:"main",operation:"NOT_EQUAL",relation:"AND"},{property:"organId",value:e,group:"main",operation:"RIGHT_LIKE",relation:"AND"}]}})},t.onSelect=function(e){if(e[0]){t.setState({selectedKeys:e});var a=t.state,l=a.formValues,r=a.defaultFormValue,n=a.pageBean,i=a.deptSearch,s=[],o={property:"organId",value:e[0],group:"main",operation:"RIGHT_LIKE",relation:"AND"};t.setState({treeFormValue:o}),s.unshift(r),Object.keys(i).length&&s.push(i),s.push(o),s=s.concat(l),t.getList({pageBean:n,querys:s})}},t.expandCheck=function(e){t.setState({expandCheckKeys:e})},t.renderTreeNodes=function(e){return e.map(function(e){return e.children?z.a.createElement(n.a.TreeNode,{title:e.title,key:e.key,dataRef:e},t.renderTreeNodes(e.children)):z.a.createElement(n.a.TreeNode,e)})},t.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(i.a.success("上传成功"),t.setState({fileList:e.fileList})):i.a.error(e.file.response.code.msg):"error"===e.file.status?i.a.error("上传失败"):"removed"===e.file.status&&t.setState({fileList:e.fileList})},t.lawSignaUploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(i.a.success("上传成功"),t.setState({lawSignaFileList:e.fileList})):i.a.error(e.file.response.code.msg):"error"===e.file.status?i.a.error("上传失败"):"removed"===e.file.status&&t.setState({lawSignaFileList:e.fileList})},re=Object(_.B)(),ne=Object(_.I)(le),t}return v()(a,e),h()(a,[{key:"componentDidMount",value:function(){var e=this.state,a=e.defaultFormValue,t=e.pageBean;0;var l=localStorage.getItem("organId"),r=JSON.parse(localStorage.getItem("mainMsg")||"{}"),n=r.department?r.department.split(","):[],i={property:"department",value:n.join(),group:"main",operation:"LIKE",relation:"AND"},s=[a];n.length<4&&(s.push(i),this.setState({deptSearch:i})),this.getList({pageBean:t,querys:[].concat(s,[{property:"organId",value:l,group:"main",operation:"RIGHT_LIKE",relation:"AND"}])})}},{key:"componentWillUnmount",value:function(){0}},{key:"dataDel",value:function(e){this.delUtil(e)}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return z.a.createElement(q.a,{onSubmit:this.handleSearch,layout:"inline"},z.a.createElement(k.a,{gutter:8},z.a.createElement(U.a,{md:5,sm:24},z.a.createElement(ae,null,e("account")(z.a.createElement(x.a,{addonBefore:"登录名",placeholder:"请输入"})))),z.a.createElement(U.a,{md:5,sm:24},z.a.createElement(ae,null,e("fullname")(z.a.createElement(x.a,{addonBefore:"姓名",placeholder:"请输入"})))),z.a.createElement(U.a,{md:5,sm:24},z.a.createElement(ae,null,e("mobile")(z.a.createElement(x.a,{addonBefore:"电话",placeholder:"请输入"})))),z.a.createElement(U.a,{md:4,sm:24},z.a.createElement("span",{className:Q.a.submitButtons},z.a.createElement(B.a,{type:"primary",htmlType:"submit"},"查询"),z.a.createElement(B.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.system.treeList,l=a.systemUser,i=l.data,s=l.siteList,o=a.TransportSystemDepart,c=a.loading,d=a.systemLoading,u=this.state,p=u.expandCheckKeys,m=u.selectedRows,g=u.modalVisible,h=u.UpdateModalVisible,f=u.editModalData,y=u.importLoading,E=u.pinyin,b=u.selectedKeys,S=u.emailSuffixValue,I=u.fileList,C=u.departmentValue,v={lawSignaFileList:u.lawSignaFileList,lawSignaUploadChange:this.lawSignaUploadChange,departmentList:o.data,departmentValue:C,departmentChange:this.departmentChange,uploadChange:this.uploadChange,treeSelectChange:this.treeSelectChange,siteList:s,fileList:I,treeList:t,emailSuffixValue:S,emailInputChange:this.emailInputChange},F={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible,setRoleCode:this.setRoleCode,pinyin:E,getFullName:this.getFullName,loading:d,handleDepartVisible:this.handleDepartVisible},w={handleUpdate:this.handleUpdate,handleUpdateModalVisible:this.handleUpdateModalVisible,editModalData:f},k={tableAlert:!0,selectedRows:m,size:"middle",loading:c,data:i,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange};return z.a.createElement(K.Fragment,null,Object(_.c)(ne[0])?null:z.a.createElement(J.a,{to:"/exception/403"}),z.a.createElement("div",{className:Q.a.tableMain},z.a.createElement(L.a,{spinning:d},z.a.createElement("div",{className:Q.a.treeLeft},z.a.createElement(n.a,{selectedKeys:b,showLine:!0,onSelect:this.onSelect,expandedKeys:p[0]?p:[t[0]?t[0].key:""],onExpand:this.expandCheck},this.renderTreeNodes(t)))),z.a.createElement("div",{className:Q.a.rightTable},z.a.createElement(r.a,{bordered:!1,style:{height:"100%"}},z.a.createElement("div",{className:Q.a.tableList},z.a.createElement("div",{className:Q.a.tableListForm},this.renderSimpleForm()),z.a.createElement("div",{className:Q.a.tableListOperator},z.a.createElement(B.a,{icon:"plus",style:{display:Object(_.c)(ne[1])?"inline":"none"},type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新增"),m.length>0&&z.a.createElement("span",null,Object(_.c)(ne[3])?z.a.createElement(B.a,{type:"danger",onClick:this.delBatch},"批量删除"):null,z.a.createElement(B.a,{onClick:this.activateBatch},"批量启用"),z.a.createElement(B.a,{onClick:this.forbiddenBatch},"批量禁用")),z.a.createElement(B.a,{className:W.a.import,icon:"import",onClick:this.importClick,loading:y,style:{float:"right"}},"导出"),z.a.createElement("div",{style:{clear:"both"}})),z.a.createElement(G.a,k))))),z.a.createElement(ie,j()({},v,F,{modalVisible:g})),h&&"{}"!==JSON.stringify(f)?z.a.createElement(se,j()({},v,w,{UpdateModalVisible:h})):null)}}]),a}(K.PureComponent))||l)||l;a.default=oe}}]);