(window.webpackJsonp=window.webpackJsonp||[]).push([[126],{KARV:function(e,a,t){"use strict";t.r(a);var n,r=t("pVnL"),l=t.n(r),o=(t("IzEo"),t("bx4M")),s=(t("T2oS"),t("W9HT")),i=(t("14J3"),t("BMrR")),c=(t("jCWc"),t("kPKH")),d=(t("5NDa"),t("5rEg")),m=(t("ozfa"),t("MJZm")),p=(t("miYZ"),t("tsqr")),u=(t("5Dmo"),t("3S7+")),h=(t("+L6B"),t("2/Rp")),y=t("lwsE"),g=t.n(y),f=t("W8MJ"),E=t.n(f),b=t("a1gu"),I=t.n(b),S=t("Nsbk"),v=t.n(S),N=t("7W2i"),k=t.n(N),V=(t("2qtc"),t("kLXV")),w=(t("bP8k"),t("gFTJ")),M=(t("y8nQ"),t("Vl3Y")),T=t("q1tI"),C=t.n(T),L=t("MuoO"),x=t("mf+E"),B=t("CkN6"),R=t("+n12"),K=t("9zHi"),F=t.n(K),O=t("ZP6J"),J=t.n(O),U=M.a.Item,q=["/comquery/source"],D=M.a.create()(function(e){var a=e.modalVisible,t=e.handleModalVisible,n=e.treeList,r=e.detail,l="";return function e(a,t){for(var n=0;n<t.length;n++){if(a===t[n].value){l=t[n].title;break}e(a,t[n].children)}}(r.organId,n),C.a.createElement(V.a,{destroyOnClose:!0,title:"源头企业详情",className:J.a.myModal+" "+J.a.modalbody,visible:a,onCancel:function(){return t()},width:800,footer:null},C.a.createElement("div",{className:J.a.detailMsg},C.a.createElement("div",{style:{padding:20}},C.a.createElement(w.a,{bordered:!0,size:"small",column:2},C.a.createElement(w.a.Item,{label:"企业名称"},r.companyName),C.a.createElement(w.a.Item,{label:"企业编码"},r.siteCode),C.a.createElement(w.a.Item,{label:"企业联系人"},r.contactMan),C.a.createElement(w.a.Item,{label:"企业号码"},r.companyTel),C.a.createElement(w.a.Item,{label:"监管单位"},r.supervisionCompany),C.a.createElement(w.a.Item,{label:"监管责任人"},r.supervisionMan),C.a.createElement(w.a.Item,{label:"监管人电话"},r.supervisionTel),C.a.createElement(w.a.Item,{label:"年货运吞吐量"},r.throughput),C.a.createElement(w.a.Item,{label:"所在道路"},r.whereLoad),C.a.createElement(w.a.Item,{label:"经度"},r.longitude),C.a.createElement(w.a.Item,{label:"纬度"},r.latitude),C.a.createElement(w.a.Item,{label:"行政区域"},l),C.a.createElement(w.a.Item,{label:"企业地址"},r.address)))))}),z=Object(L.connect)(function(e){var a=e.system,t=e.Source,n=e.loading;return{system:a,Source:t,currentUser:e.user.currentUser,loading:n.models.Source,systemLoading:n.models.system}})(n=M.a.create()(n=function(e){function a(){var e,t;g()(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=I()(this,(e=v()(a)).call.apply(e,[this].concat(r)))).state={selectedRows:[],formValues:[],orangValue:"",updateModalVisible:!1,treeFormValue:{},selectedKeys:[],expandCheckKeys:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"企业编码",dataIndex:"siteCode"},{title:"企业名称",dataIndex:"companyName"},{title:"企业电话",dataIndex:"companyTel"},{title:"地址",dataIndex:"address"},{title:"联系人",dataIndex:"contactMan"},{title:"年货运吞吐量",dataIndex:"throughput"},{title:"监管责任单位",dataIndex:"supervisionCompany"},{title:"监管责任人",dataIndex:"supervisionMan"},{title:"监管电话",dataIndex:"supervisionTel"},{title:"操作",width:80,render:function(e,a){return C.a.createElement(T.Fragment,null,C.a.createElement(u.a,{placement:"left",title:"详情"},C.a.createElement(h.a,{onClick:function(){return t.showUpdateModal(a.id)},type:"primary",shape:"circle",icon:"eye",size:"small"})))}}],t.showUpdateModal=function(e){(0,t.props.dispatch)({type:"Source/detail",payload:e,callback:function(e){t.setState({detail:e}),t.handleUpdateModalVisible(!0)}})},t.handleStandardTableChange=function(e){var a=t.props,n=a.dispatch,r=a.currentUser,l=t.state,o=l.formValues,s=l.treeFormValue,i=[];"{}"!==JSON.stringify(s)?i.push(s):i.unshift({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),n({type:"Source/fetch",payload:{pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:i.concat(o)}})},t.handleFormReset=function(){var e=t.props,a=e.form,n=e.dispatch,r=e.currentUser,l=t.state.pageBean;a.resetFields(),t.setState({formValues:[],expandCheckKeys:[],selectedKeys:[]}),n({type:"Source/fetch",payload:{pageBean:l,querys:[{property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}]}})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.handleSearch=function(e){e.preventDefault();var a=t.props,n=a.dispatch,r=a.form,l=a.currentUser,o=t.state,s=o.pageBean,i=o.treeFormValue;r.validateFields(function(e,a){if(!e){var r=Object.keys(a).map(function(e){return a[e]?{property:e,value:a[e],group:"main",operation:"LIKE",relation:"OR"}:""}).filter(function(e){return e});t.setState({formValues:JSON.parse(JSON.stringify(r))}),"{}"!==JSON.stringify(i)?r.push(i):r.unshift({property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),n({type:"Source/fetch",payload:{pageBean:s,querys:r}})}})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e})},t.handleUpdate=function(e){var a=t.props.dispatch,n=t.state,r=n.pageBean,l=n.detail,o=JSON.parse(JSON.stringify(l)),s=Object.keys(e);e.organId=e.organId.join();for(var i=0;i<s.length;i+=1)o[s[i]]=e[s[i]];t.setState({detail:o}),a({type:"Source/update",payload:{update:o,query:{pageBean:r}},callback:function(){p.a.success("编辑成功"),t.handleModalVisible()}})},t.onSelect=function(e,a){if(e[0]){t.setState({selectedKeys:e});var n=t.props.dispatch,r=t.state,l=r.formValues,o=r.pageBean,s=[],i={property:"organId",value:e[0],group:"main",operation:"RIGHT_LIKE",relation:"AND"};t.setState({treeFormValue:i}),s.push(i),n({type:"Source/fetch",payload:{pageBean:o,querys:s=s.concat(l)}})}},t.expandCheck=function(e){t.setState({expandCheckKeys:e})},t.renderTreeNodes=function(e){return e.map(function(e){return e.children?C.a.createElement(m.a.TreeNode,{title:e.title,key:e.key,dataRef:e},t.renderTreeNodes(e.children)):C.a.createElement(m.a.TreeNode,e)})},t}return k()(a,e),E()(a,[{key:"componentDidMount",value:function(){Object(R.c)(q[0])&&(0,this.props.dispatch)({type:"Source/fetch",payload:{pageBean:this.state.pageBean,querys:[{property:"organId",value:localStorage.getItem("organId"),group:"main",operation:"RIGHT_LIKE",relation:"AND"}]}})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return C.a.createElement(M.a,{onSubmit:this.handleSearch,layout:"inline"},C.a.createElement(i.a,{gutter:16},C.a.createElement(c.a,{md:5,sm:12},C.a.createElement(U,null,e("siteCode")(C.a.createElement(d.a,{addonBefore:"企业编码"})))),C.a.createElement(c.a,{md:5,sm:12},C.a.createElement(U,null,e("companyName")(C.a.createElement(d.a,{addonBefore:"企业名称"})))),C.a.createElement(c.a,{md:5,sm:12},C.a.createElement(U,null,e("address")(C.a.createElement(d.a,{addonBefore:"地址"})))),C.a.createElement(c.a,{md:5,sm:12},C.a.createElement(U,null,e("throughput")(C.a.createElement(d.a,{addonBefore:"年货运吞吐量"})))),C.a.createElement(c.a,{md:4,sm:12},C.a.createElement("span",{className:F.a.submitButtons,style:{float:"right"}},C.a.createElement(h.a,{type:"primary",htmlType:"submit"},"查询"),C.a.createElement(h.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this.props,a=e.system.treeList,t=e.Source.data,n=e.loading,r=e.systemLoading,i=this.state,c=i.selectedRows,d=i.updateModalVisible,p=i.detail,u=i.expandCheckKeys,h=i.selectedKeys,y={handleUpdate:this.handleUpdate,handleModalVisible:this.handleUpdateModalVisible,treeList:a,detail:p};return C.a.createElement(T.Fragment,null,Object(R.c)(q[0])?null:C.a.createElement(x.a,{to:"/exception/403"}),C.a.createElement("div",{className:F.a.tableMain},C.a.createElement(s.a,{spinning:r},C.a.createElement("div",{className:F.a.treeLeft},C.a.createElement(m.a,{selectedKeys:h,showLine:!0,onSelect:this.onSelect,expandedKeys:u[0]?u:[a[0]?a[0].key:""],onExpand:this.expandCheck},this.renderTreeNodes(a)))),C.a.createElement("div",{className:F.a.rightTable},C.a.createElement(o.a,{bordered:!1,style:{height:"100%"}},C.a.createElement("div",{className:F.a.tableList},C.a.createElement("div",{className:F.a.tableListForm},this.renderSimpleForm()),C.a.createElement(B.a,{selectedRows:c,rowSelection:null,loading:n,data:t,size:"middle",tableAlert:!1,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))))),d&&"{}"!==JSON.stringify(p)?C.a.createElement(D,l()({},y,{modalVisible:d})):null)}}]),a}(T.PureComponent))||n)||n;a.default=z}}]);