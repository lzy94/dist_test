(window.webpackJsonp=window.webpackJsonp||[]).push([[149],{TWFv:function(e,a,t){"use strict";t.r(a);var r,l=t("pVnL"),n=t.n(l),o=(t("IzEo"),t("bx4M")),s=(t("T2oS"),t("W9HT")),i=(t("14J3"),t("BMrR")),d=(t("jCWc"),t("kPKH")),c=(t("5NDa"),t("5rEg")),m=(t("ozfa"),t("MJZm")),p=t("MVZn"),u=t.n(p),g=(t("miYZ"),t("tsqr")),h=t("RIqP"),y=t.n(h),f=(t("5Dmo"),t("3S7+")),E=(t("+L6B"),t("2/Rp")),I=(t("Q9mQ"),t("diRs")),b=t("lwsE"),S=t.n(b),v=t("W8MJ"),N=t.n(v),L=t("a1gu"),T=t.n(L),V=t("Nsbk"),w=t.n(V),U=t("7W2i"),k=t.n(U),D=(t("2qtc"),t("kLXV")),C=(t("bP8k"),t("gFTJ")),F=(t("y8nQ"),t("Vl3Y")),M=t("q1tI"),A=t.n(M),O=t("MuoO"),R=t("CkN6"),x=t("mf+E"),K=t("Py4S"),J=t.n(K),z=t("+n12"),B=t("9zHi"),q=t.n(B),H=t("ns75"),G=t.n(H),P=t("dscJ"),_=t.n(P),j=t("ZP6J"),Q=t.n(j),W=F.a.Item,Y=["/lawenfor/personnel","/lawenfor/personnel/proof"],Z=F.a.create()(function(e){var a=e.UpdateModalVisible,t=e.handleUpdateModalVisible,r=e.treeList,l=e.editModalData,n=e.siteList,o=e.logs,s=function(e,a){var t=[];if(!a)return"";for(var r=0;r<e.length;r++)for(var l=0;l<a.length;l++)if(e[r]===a[l].value){t.push(a[l].title);break}return t.join("，")},i=o[0]?o[0]:{};return A.a.createElement(D.a,{destroyOnClose:!0,title:"详情",className:Q.a.myModal+" "+Q.a.modalbody,visible:a,onCancel:function(){return t()},footer:null,width:"900px"},A.a.createElement("div",{className:Q.a.detailMsg},A.a.createElement("div",{style:{padding:20}},A.a.createElement(C.a,{bordered:!0,column:2,size:"small"},A.a.createElement(C.a.Item,{label:"名称"},l.fullname),A.a.createElement(C.a.Item,{label:"证件号码"},l.idCard),A.a.createElement(C.a.Item,{label:"登录账号"},l.account),A.a.createElement(C.a.Item,{label:"邮箱"},l.email),A.a.createElement(C.a.Item,{label:"电话号码"},l.mobile),A.a.createElement(C.a.Item,{label:"区域"},function e(a,t){var r="";if(!t)return"";for(var l=0;l<t.length;l++){if(a===t[l].value){r=t[l].title;break}"[]"!==JSON.stringify(t[l].children)&&(r=e(a,t[l].children))}return r}(l.organId,r)),A.a.createElement(C.a.Item,{label:"非现场站点"},s(l.siteIds.split(","),n[0])),A.a.createElement(C.a.Item,{label:"精简站"},s(l.staticSite.split(","),n[1])),A.a.createElement(C.a.Item,{label:"执法证件号"},l.lawCard),A.a.createElement(C.a.Item,{label:"执法证件图片"},A.a.createElement("div",{style:{overflow:"hidden",width:100,height:100}},A.a.createElement(J.a,{backdrop:"rgba(255,255,255,.3)",src:z.E+l.lawCardImg,alt:"执法证件图片",style:{height:"100px"}}))),A.a.createElement(C.a.Item,{label:"职务"}," ",l.position),A.a.createElement(C.a.Item,{label:"地址"},l.address)),A.a.createElement("div",{style:{marginTop:10}}," "),A.a.createElement(C.a,{bordered:!0,title:"执法数据",size:"small"},A.a.createElement(C.a.Item,{label:"执法总数",span:3}," ",i.TOTAL),A.a.createElement(C.a.Item,{label:"初审"}," ",i.PENDINGVERIFY),A.a.createElement(C.a.Item,{label:"复审"}," ",i.VERIFYPASS),A.a.createElement(C.a.Item,{label:"签批"}," ",i.SIGNINGPASS),A.a.createElement(C.a.Item,{label:"结案"}," ",i.ARCHIVEDATE),A.a.createElement(C.a.Item,{label:"免处罚"}," ",i.PENALTYDATE),A.a.createElement(C.a.Item,{label:"无效数据"}," ",i.INCALIDDATE)))))}),X=Object(O.connect)(function(e){var a=e.system,t=e.systemUser,r=e.user,l=e.loading;return{system:a,systemUser:t,currentUser:r.currentUser,loading:l.models.systemUser,systemLoading:l.models.system}})(r=F.a.create()(r=function(e){function a(){var e,t;S()(this,a);for(var r=arguments.length,l=new Array(r),n=0;n<r;n++)l[n]=arguments[n];return(t=T()(this,(e=w()(a)).call.apply(e,[this].concat(l)))).state={UpdateModalVisible:!1,formValues:[],logs:[],treeFormValue:{},defaultFormValue:[{property:"isDelete",value:"0",group:"main",operation:"NOT_EQUAL",relation:"AND"},{property:"lawCard",value:"",group:"main",operation:"NOTNULL",relation:"AND"}],selectedKeys:[],editModalData:{},importLoading:!1,expandCheckKeys:[]},t.columns=[{title:"姓名",dataIndex:"fullname"},{title:"电话",dataIndex:"mobile"},{title:"职务",dataIndex:"position"},{title:"执法证件号",dataIndex:"lawCard"},{title:"执法证件图片",dataIndex:"lawCardImg",render:function(e,a){return A.a.createElement(I.a,{content:A.a.createElement("img",{style:{width:"auto",height:300},src:z.E+a.lawCardImg,onError:function(e){e.target.onerror=null,e.target.src=_.a},alt:"执法卡图片"}),trigger:"hover"},A.a.createElement("img",{style:{width:"auto",height:50},src:z.E+a.lawCardImg,alt:"执法卡图片",onError:function(e){e.target.onerror=null,e.target.src=_.a}}))}},{title:"机构",dataIndex:"organName"},{title:"操作",width:"70px",render:function(e,a){return A.a.createElement(M.Fragment,null,A.a.createElement(f.a,{placement:"left",title:"详情"},A.a.createElement(E.a,{onClick:function(){return t.editData(a)},type:"primary",shape:"circle",icon:"eye",size:"small"})))}}],t.editData=function(e){(0,t.props.dispatch)({type:"systemUser/detailData",payload:{account:e.account},callback:function(e){t.handleUpdateModalVisible(!0),t.setState({editModalData:e}),t.getLogs(e.id),t.getSite(e.organId)}})},t.getLogs=function(e){(0,t.props.dispatch)({type:"systemUser/lawLogs",payload:{userId:e},callback:function(e){t.setState({logs:e})}})},t.handleStandardTableChange=function(e){var a=t.props,r=a.dispatch,l=a.currentUser,n=t.state,o=n.formValues,s=n.defaultFormValue,i=n.treeFormValue,d=s;"{}"!==JSON.stringify(i)?d.push(i):d.push({property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),r({type:"systemUser/fetch",payload:{pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:d.concat(o)}})},t.handleFormReset=function(){var e=t.props,a=e.form,r=e.dispatch,l=e.currentUser,n=t.state.defaultFormValue,o=JSON.parse(JSON.stringify(n));a.resetFields(),t.setState({formValues:[],treeFormValue:{},selectedKeys:[]}),o.push({property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),r({type:"systemUser/fetch",payload:{pageBean:{page:1,pageSize:10,showTotal:!0},querys:o}})},t.isOragId=function(e,a){for(var t=!1,r=y()(e),l=0;l<r.length;l+=1)if("organId"===r[l].property){t=!0,r.splice(l,1,a);break}return t||r.push(a),r},t.importClick=function(){t.setState({importLoading:!0});var e=t.props,a=e.dispatch,r=e.currentUser,l=t.state,n=l.formValues,o=l.treeFormValue,s=l.defaultFormValue,i=y()(s);"{}"!==JSON.stringify(o)?i.push(o):i.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),a({type:"systemUser/import",payload:{pageBean:{page:0,pageSize:10,showTotal:!0},querys:Array.from(new Set(i.concat(n)))},callback:function(e){404===e&&g.a.error("暂无数据"),t.setState({importLoading:!1})}})},t.handleSearch=function(e){e.preventDefault();var a=t.props,r=a.dispatch,l=a.form,n=a.currentUser,o=t.state,s=o.treeFormValue,i=o.defaultFormValue;l.validateFields(function(e,a){if(!e){var l=u()({},a),o=Object.keys(l).map(function(e){return l[e]?{property:e,value:l[e],group:"main",operation:"LIKE",relation:"OR"}:""}).filter(function(e){return e});t.setState({formValues:o}),"{}"!==JSON.stringify(s)?o.push(s):o.push({property:"organId",value:n.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),r({type:"systemUser/fetch",payload:{pageBean:{page:1,pageSize:10,showTotal:!0},querys:i.concat(o)}})}})},t.handleUpdateModalVisible=function(e){t.setState({UpdateModalVisible:!!e}),e||t.setState({editModalData:{}})},t.getSite=function(e){(0,t.props.dispatch)({type:"systemUser/getSite",payload:{pageBean:{page:1,pageSize:1e3,showTotal:!0},querys:[{property:"status",value:"0",group:"main",operation:"NOT_EQUAL",relation:"AND"},{property:"organId",value:e,group:"main",operation:"RIGHT_LIKE",relation:"OR"}]}})},t.onSelect=function(e){if(e[0]){t.setState({selectedKeys:e});var a=t.props.dispatch,r=t.state,l=r.formValues,n=r.defaultFormValue,o=y()(n),s={property:"organId",value:e[0],group:"main",operation:"RIGHT_LIKE",relation:"AND"};t.setState({treeFormValue:s}),o.push(s),a({type:"systemUser/fetch",payload:{pageBean:{page:1,pageSize:10,showTotal:!0},querys:o=o.concat(l)}})}},t.expandCheck=function(e){t.setState({expandCheckKeys:e})},t.renderTreeNodes=function(e){return e.map(function(e){return e.children?A.a.createElement(m.a.TreeNode,{title:e.title,key:e.key,dataRef:e},t.renderTreeNodes(e.children)):A.a.createElement(m.a.TreeNode,e)})},t}return k()(a,e),N()(a,[{key:"componentDidMount",value:function(){if(Object(z.c)(Y[0])){var e=this.props.dispatch,a=this.state.defaultFormValue,t=JSON.parse(JSON.stringify(a)),r=localStorage.getItem("organId");t.push({property:"organId",value:r,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),e({type:"systemUser/fetch",payload:{pageBean:{page:1,pageSize:10,showTotal:!0},querys:t}})}}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator,a=this.state.importLoading;return A.a.createElement(F.a,{onSubmit:this.handleSearch,layout:"inline"},A.a.createElement(i.a,{gutter:{md:8,lg:16,xl:16}},A.a.createElement(d.a,{md:6,sm:24},A.a.createElement(W,null,e("fullname")(A.a.createElement(c.a,{addonBefore:"姓名",placeholder:"请输入"})))),A.a.createElement(d.a,{md:6,sm:24},A.a.createElement(W,null,e("mobile")(A.a.createElement(c.a,{addonBefore:"电话",placeholder:"请输入"})))),A.a.createElement(d.a,{md:12,sm:24},A.a.createElement("span",{className:q.a.submitButtons,style:{float:"right"}},A.a.createElement(E.a,{type:"primary",htmlType:"submit"},"查询"),A.a.createElement(E.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置"),A.a.createElement(E.a,{className:G.a.import,icon:"import",onClick:this.importClick,loading:a,style:{marginLeft:8}},"导出")))))}},{key:"render",value:function(){var e=this.props,a=e.system.treeList,t=e.systemUser,r=t.data,l=t.siteList,i=e.loading,d=e.systemLoading,c=this.state,p=c.expandCheckKeys,u=c.UpdateModalVisible,g=c.editModalData,h=c.selectedKeys,y=c.logs,f={logs:y,treeList:a,editModalData:g,siteList:l,handleUpdateModalVisible:this.handleUpdateModalVisible},E={selectedRows:0,rowSelection:null,size:"middle",loading:i,data:r,logs:y,tableAlert:!1,columns:this.columns,onChange:this.handleStandardTableChange};return A.a.createElement(M.Fragment,null,Object(z.c)(Y[0])?null:A.a.createElement(x.a,{to:"/exception/403"}),A.a.createElement("div",{className:q.a.tableMain},A.a.createElement(s.a,{spinning:d},A.a.createElement("div",{className:q.a.treeLeft},A.a.createElement(m.a,{selectedKeys:h,showLine:!0,onSelect:this.onSelect,expandedKeys:p[0]?p:[a[0]?a[0].key:""],onExpand:this.expandCheck},this.renderTreeNodes(a)))),A.a.createElement("div",{className:q.a.rightTable},A.a.createElement(o.a,{bordered:!1,style:{height:"100%"}},A.a.createElement("div",{className:q.a.tableList},A.a.createElement("div",{className:q.a.tableListForm},this.renderSimpleForm()),A.a.createElement(R.a,E))))),u&&"{}"!==JSON.stringify(g)?A.a.createElement(Z,n()({},f,{UpdateModalVisible:u})):null)}}]),a}(M.PureComponent))||r)||r;a.default=X}}]);