(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{clxw:function(e,a,t){"use strict";t.r(a);var n,l,r,i=t("pVnL"),s=t.n(i),o=(t("IzEo"),t("bx4M")),c=(t("14J3"),t("BMrR")),d=(t("jCWc"),t("kPKH")),m=t("MVZn"),u=t.n(m),p=t("RIqP"),h=t.n(p),g=(t("+L6B"),t("2/Rp")),y=(t("5Dmo"),t("3S7+")),f=t("lwsE"),E=t.n(f),b=t("W8MJ"),v=t.n(b),w=t("a1gu"),M=t.n(w),C=t("Nsbk"),k=t.n(C),V=t("7W2i"),L=t.n(V),S=(t("OaEy"),t("2fM7")),N=(t("y8nQ"),t("Vl3Y")),I=t("q1tI"),x=t.n(I),D=t("MuoO"),T=t("wd/R"),O=t.n(T),P=t("CkN6"),j=(t("2qtc"),t("kLXV")),B=(t("DZo9"),t("8z0m")),F=(t("5NDa"),t("5rEg")),q=(t("iQDF"),t("+eQT")),z=(t("Pwec"),t("CtXQ")),A=(t("miYZ"),t("tsqr")),U=t("o0o1"),Y=t.n(U),H=t("yXPU"),Q=t.n(H),R=t("ZP6J"),_=t.n(R),J=t("lTPH"),K=t("+n12"),X=t("z1x1"),Z=t("DhmK"),W=N.a.Item,G=S.a.Option,$=[[],[]],ee=Object(D.connect)(function(e){return{system:e.system,Manpower:e.Manpower,loading:e.loading.models.Manpower}})(n=N.a.create()(n=function(e){function a(e){var t;return E()(this,a),(t=M()(this,k()(a).call(this,e))).state={departmentUserList:[],charger:"",fileList:[],address:"",lnglat:[],categoryName:"",pModalVisible:!1,planName:"",dealType:"",chargerId:"",previewImage:"",previewVisible:!1},t.handleChange=function(e){var a=e.fileList;return t.setState({fileList:a})},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture-card",accept:".jpg,.jpeg,.png",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(K.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:K.D,onChange:t.handleChange,onPreview:t.handlePreview}},t.handlePreview=function(){var e=Q()(Y.a.mark(function e(a){return Y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.url||a.preview){e.next=4;break}return e.next=3,Object(K.y)(a.originFileObj);case 3:a.preview=e.sent;case 4:t.setState({previewImage:a.url||a.preview}),t.handleCancel(!0);case 6:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}(),t.handleCancel=function(e){return t.setState({previewVisible:!!e})},t.categoryChange=function(e,a){t.setState({categoryName:a.props.children})},t.parentAddress=function(e,a){t.setState({address:e,lnglat:a})},t.getInputValue=function(e){return t.setState({address:e})},t.selectData=function(e){t.setState({planName:e.planName,dealType:e.dealType,chargerId:e.chargerId,charger:e.charger})},t.save=function(){var e=t.props,a=e.form,n=e.dispatch,l=e.modalSuccess;a.validateFields(function(e,a){if(!e){var r=u()({},a),i=t.state,s=i.charger,o=i.fileList,c=i.lnglat,d=i.categoryName,m=i.address,p=i.chargerId,h=i.dealType;if(o.length)if(m){r.dealType=h,r.charger=s,r.chargerId=p,r.categoryName=d,r.addr=m,r.longitude=c[0],r.latitudel=c[1],r.state=2;var g=o.map(function(e){return e.response.filePath});r.imgUrl=g.join(),n({type:"Manpower/add",payload:r,callback:function(){A.a.success("添加成功"),l(),t.cancelClick()}})}else A.a.error("请获取地址");else A.a.error("请选择图片")}})},t.handlePModalVisible=function(e){t.setState({pModalVisible:!!e})},t.cancelClick=function(){(0,t.props.handleModalVisible)(),t.setState({fileList:[]})},$=Object(J.o)(),t}return L()(a,e),v()(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,a=this.props,t=a.modalVisible,n=a.form,l=a.loading,r=a.cateList,i=this.state,o=i.fileList,m=i.planName,u=i.pModalVisible,p=i.previewVisible,h=i.previewImage,y=x.a.createElement("div",null,x.a.createElement(z.a,{type:"plus"}),x.a.createElement("div",{className:"ant-upload-text"},"请选择图片"));return x.a.createElement(I.Fragment,null,x.a.createElement(j.a,{destroyOnClose:!0,title:"新建人员调动",className:_.a.formModal,visible:t,onCancel:this.cancelClick,width:800,footer:[x.a.createElement(g.a,{key:"back",onClick:this.cancelClick},"取消"),x.a.createElement(g.a,{key:"submit",type:"primary",loading:l,onClick:this.save},"下发任务")]},x.a.createElement("div",{className:_.a.formModalBody},x.a.createElement("h3",null,"填写信息"),x.a.createElement(c.a,{gutter:40},x.a.createElement(d.a,{md:12,sm:24},x.a.createElement(W,{label:"对象"},n.getFieldDecorator("planObject",{rules:[{required:!0,message:"请选择对象！"}]})(x.a.createElement(S.a,{style:{width:"100%"},placeholder:"请选择"},$[1].map(function(e,a){return x.a.createElement(G,{key:$[0][a],value:$[0][a]},e)}))))),x.a.createElement(d.a,{md:12,sm:24},x.a.createElement(W,{label:"类型"},n.getFieldDecorator("categoryId",{rules:[{required:!0,message:"请选择类型！"}]})(x.a.createElement(S.a,{placeholder:"请选择",style:{width:"100%"},onChange:this.categoryChange},r.list.map(function(e){return x.a.createElement(G,{key:e.id_,value:e.id_},e.categoryName)}))))),x.a.createElement(d.a,{md:12,sm:24},x.a.createElement(W,{label:"时间"},n.getFieldDecorator("sendTime",{rules:[{required:!0,message:"请选择时间！"}]})(x.a.createElement(q.a,{showTime:!0,placeholder:"请选择",style:{width:"100%"}})))),x.a.createElement(d.a,{md:12,sm:24},x.a.createElement(W,{label:"等级"},n.getFieldDecorator("emergencyLevel",{rules:[{required:!0,message:"请选择等级！"}]})(x.a.createElement(S.a,{placeholder:"请选择",style:{width:"100%"}},J.u.map(function(e,a){return x.a.createElement(G,{key:a,value:a+1},e)}))))),x.a.createElement(d.a,{md:12,sm:24},x.a.createElement(W,{label:"预案"},n.getFieldDecorator("yuan",{initialValue:m,rules:[{required:!0,message:"请选择预案！"}]})(x.a.createElement(F.a,{readOnly:!0,placeholder:"请选择",onClick:function(){return e.handlePModalVisible(!0)}})))),x.a.createElement(d.a,{md:24,sm:24},x.a.createElement(X.a,{getInputValue:this.getInputValue,parentAddress:this.parentAddress})))),x.a.createElement("div",{className:_.a.formModalBody,style:{marginTop:10}},x.a.createElement("h3",null,"上传照片"),x.a.createElement("div",{className:"clearfix"},x.a.createElement(W,null,n.getFieldDecorator("imgUrl",{rules:[{required:!0,message:"请上传照片！"}]})(x.a.createElement(B.a,s()({},this.uploadConfig(),{fileList:o}),o.length>=3?null:y)))))),u?x.a.createElement(Z.a,{modalVisible:u,handleModalVisible:this.handlePModalVisible,selectData:this.selectData}):null,x.a.createElement(j.a,{visible:p,footer:null,onCancel:function(){return e.handleCancel(!1)}},x.a.createElement("img",{alt:"example",style:{width:"100%"},src:h})))}}]),a}(I.PureComponent))||n)||n,ae=(t("bP8k"),t("gFTJ")),te=t("Py4S"),ne=t.n(te),le=[[],[]],re=Object(D.connect)(function(e){return{system:e.system,Manpower:e.Manpower,loading:e.loading.models.system}})(l=N.a.create()(l=function(e){function a(e){var t;return E()(this,a),(t=M()(this,k()(a).call(this,e))).state={pageBean:{page:1,pageSize:5,showTotal:!0}},t.columns=[{title:"操作员",dataIndex:"createdBy"},{title:"反馈时间",dataIndex:"createdTime",render:function(e){return O()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"反馈内容",dataIndex:"feedbackContent"}],t.getList=function(e){(0,t.props.dispatch)({type:"system/contingencyControl",payload:e})},t.handleStandardTableChange=function(e){var a={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:[{property:"eventId",value:t.props.detail.id_,group:"main",operation:"EQUAL",relation:"AND"}]};t.getList(a)},t.modalClose=function(){var e=t.props,a=e.dispatch,n=e.handleModalVisible;a({type:"system/resetContingencyControl"}),n()},le=Object(J.o)(),t}return L()(a,e),v()(a,[{key:"componentDidMount",value:function(){var e=this.props.detail;this.getList({pageBean:this.state.pageBean,querys:[{property:"eventId",value:e.id_,group:"main",operation:"EQUAL",relation:"AND"}]})}},{key:"render",value:function(){var e=this,a=this.props,t=a.system.contingencyControlData,n=a.modalVisible,l=a.detail,r=a.loading;return x.a.createElement(j.a,{destroyOnClose:!0,title:"人员调动详情",className:_.a.formModal,visible:n,onCancel:function(){return e.modalClose()},width:800,footer:null},x.a.createElement("div",{className:_.a.detailMsg},x.a.createElement("div",{style:{padding:20}},x.a.createElement("h3",{style:{color:"#2A5298"}},x.a.createElement(z.a,{type:"profile",theme:"filled"}),"基本信息"),x.a.createElement(ae.a,{bordered:!0,size:"small",column:2},x.a.createElement(ae.a.Item,{label:"对象"},le[1][le[0].indexOf(l.planObject)]),x.a.createElement(ae.a.Item,{label:"类型"},l.categoryName),x.a.createElement(ae.a.Item,{label:"时间"},O()(l.sendTime).format("YYYY-MM-DD HH:mm:ss")),x.a.createElement(ae.a.Item,{label:"等级"},J.u[l.emergencyLevel-1]),x.a.createElement(ae.a.Item,{label:"位置"},l.addr),x.a.createElement(ae.a.Item,{label:"处置人员"},l.charger),x.a.createElement(ae.a.Item,{label:"处置方式"},l.dealType)))),x.a.createElement("div",{className:_.a.detailMsg,style:{marginTop:10}},x.a.createElement("div",{style:{padding:20,overflow:"hidden"}},x.a.createElement("h3",{style:{color:"#2A5298"}},x.a.createElement(z.a,{type:"picture",theme:"filled"})," 图片信息"),l.imgUrl?l.imgUrl.split(",").map(function(e,a){return x.a.createElement("div",{key:a,style:{overflow:"hidden",width:200,height:200,float:"left",marginRight:10}},x.a.createElement(ne.a,{backdrop:"rgba(255,255,255,.3)",src:K.E+e,alt:"图片",style:{width:"100%",height:"200px"}}))}):null)),t.list.length?x.a.createElement("div",{className:_.a.detailMsg,style:{marginTop:10}},x.a.createElement("div",{className:_.a.recordList,style:{padding:"20px"}},x.a.createElement("h3",{style:{color:"#2A5298"}},x.a.createElement(z.a,{type:"picture",theme:"filled"})," 反馈结果"),x.a.createElement(P.a,{rowKey:"id_",size:"small",selectedRows:0,rowSelection:null,loading:r,data:t,columns:this.columns,onChange:this.handleStandardTableChange}))):null)}}]),a}(I.PureComponent))||l)||l,ie=t("9zHi"),se=t.n(ie),oe=t("ns75"),ce=t.n(oe),de=N.a.Item,me=S.a.Option,ue=["新建","已派","处理中","已完成"],pe=[[],[]],he=Object(D.connect)(function(e){return{ListPlanCategory:e.ListPlanCategory,Manpower:e.Manpower,loading:e.loading.models.Manpower}})(r=N.a.create()(r=function(e){function a(e){var t;return E()(this,a),(t=M()(this,k()(a).call(this,e))).state={modalVisible:!1,updateModalVisible:!1,formValues:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0},defaultQuery:{}},t.columns=[{title:"负责人",dataIndex:"charger"},{title:"处理方式",dataIndex:"dealType",width:250,render:function(e){return e.length>15?x.a.createElement(y.a,{title:e},"".concat(e.substr(0,13),"...")):e}},{title:"对象",dataIndex:"planObject",render:function(e){return pe[1][pe[0].indexOf(e)]}},{title:"类型",dataIndex:"categoryName"},{title:"紧急程度",dataIndex:"emergencyLevel",render:function(e){return J.u[e-1]}},{title:"任务下达时间",dataIndex:"sendTime",width:170,render:function(e){return e&&O()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"状态",dataIndex:"state",render:function(e){return ue[e-1]}},{title:"操作",width:80,render:function(e,a){return x.a.createElement(I.Fragment,null,x.a.createElement(y.a,{placement:"left",title:"详情"},x.a.createElement(g.a,{onClick:function(){return t.editData(a.id_)},type:"primary",shape:"circle",icon:"eye",size:"small"})))}}],t.editData=function(e){(0,t.props.dispatch)({type:"Manpower/detail",payload:{id:e},callback:function(e){return t.setState({detail:e},function(){return t.handleUpdateModalVisible(!0)})}})},t.getCate=function(){(0,t.props.dispatch)({type:"ListPlanCategory/fetch",payload:{planObject:pe[0].join()}})},t.getList=function(e){(0,t.props.dispatch)({type:"Manpower/fetch",payload:e})},t.handleStandardTableChange=function(e){var a=t.state,n=a.formValues,l=a.defaultQuery,r={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:[l].concat(h()(n))};t.getList(r)},t.handleFormReset=function(){var e=t.props.form,a=t.state,n=a.pageBean,l=a.defaultQuery;e.resetFields(),t.setState({formValues:[]}),t.getList({pageBean:n,querys:[l]})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var n=t.state,l=n.pageBean,r=n.defaultQuery,i=u()({},a),s=Object.keys(i).map(function(e){return i[e]?{property:e,value:i[e],group:"main",operation:"EQUAL",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:s}),t.getList({pageBean:l,querys:[r].concat(h()(s))})}})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{}})},t.modalSuccess=function(){var e=t.state,a=e.pageBean,n=e.defaultQuery;t.getList({pageBean:a,querys:[n]})},pe=Object(J.o)(),t}return L()(a,e),v()(a,[{key:"componentDidMount",value:function(){var e={property:"planObject",value:pe[0],group:"main",operation:"IN",relation:"AND"};this.getList({pageBean:this.state.pageBean,querys:[e]}),this.setState({defaultQuery:e}),this.getCate()}},{key:"renderSimpleForm",value:function(){var e=this.props,a=e.form.getFieldDecorator,t=e.ListPlanCategory.data;return x.a.createElement(N.a,{onSubmit:this.handleSearch,layout:"inline"},x.a.createElement(c.a,{gutter:{md:8,lg:16,xl:16}},x.a.createElement(d.a,{md:6,sm:24},x.a.createElement("div",{className:ce.a.inputMain},x.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"类型"),x.a.createElement(de,{style:{flex:1}},a("categoryId")(x.a.createElement(S.a,{placeholder:"请选择",style:{width:"100%"}},t.list.map(function(e,a){return x.a.createElement(me,{key:a,value:e.id_},e.categoryName)})))))),x.a.createElement(d.a,{md:6,sm:24},x.a.createElement("div",{className:ce.a.inputMain},x.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"状态"),x.a.createElement(de,{style:{flex:1}},a("state")(x.a.createElement(S.a,{placeholder:"请选择",style:{width:"100%"}},ue.map(function(e,a){return x.a.createElement(me,{key:a,value:a+1},e)})))))),x.a.createElement(d.a,{md:6,sm:24},x.a.createElement("div",{className:ce.a.inputMain},x.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"等级"),x.a.createElement(de,{style:{flex:1}},a("emergencyLevel")(x.a.createElement(S.a,{placeholder:"请选择",style:{width:"100%"}},J.u.map(function(e,a){return x.a.createElement(me,{key:a,value:a+1},e)})))))),x.a.createElement(d.a,{md:6,sm:24},x.a.createElement("span",{className:se.a.submitButtons},x.a.createElement(g.a,{type:"primary",htmlType:"submit"},"查询"),x.a.createElement(g.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.ListPlanCategory.data,n=a.Manpower.dataList,l=a.loading,r=this.state,i=r.modalVisible,c=r.updateModalVisible,d=r.detail,m={cateList:t,modalSuccess:this.modalSuccess,handleModalVisible:this.handleModalVisible},u={cateList:t,detail:d,modalSuccess:this.modalSuccess,handleModalVisible:this.handleUpdateModalVisible};return x.a.createElement(I.Fragment,null,x.a.createElement(o.a,{bordered:!1},x.a.createElement("div",{className:se.a.tableList},x.a.createElement("div",{className:se.a.tableListForm},this.renderSimpleForm()),x.a.createElement("div",{className:se.a.tableListOperator},x.a.createElement(g.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建")),x.a.createElement(P.a,{rowKey:"id_",size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:l,data:n,columns:this.columns,onChange:this.handleStandardTableChange}))),x.a.createElement(ee,s()({},m,{modalVisible:i})),c&&Object.keys(d).length?x.a.createElement(re,s()({},u,{modalVisible:c})):null)}}]),a}(I.PureComponent))||r)||r;a.default=he}}]);