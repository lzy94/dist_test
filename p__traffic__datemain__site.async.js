(window.webpackJsonp=window.webpackJsonp||[]).push([[140],{FDAk:function(e,a,t){"use strict";t.r(a);t("IzEo");var l,n,r,i,d,s,o,c,m,u,p,h,b,E,f=t("bx4M"),g=(t("T2oS"),t("W9HT")),y=(t("ozfa"),t("MJZm")),v=(t("/zsF"),t("PArb")),F=(t("+BJd"),t("mr32")),V=(t("5Dmo"),t("3S7+")),D=t("lwsE"),k=t.n(D),w=t("W8MJ"),S=t.n(w),M=t("a1gu"),C=t.n(M),N=t("Nsbk"),I=t.n(N),q=t("7W2i"),L=t.n(q),T=t("MVZn"),O=t.n(T),x=(t("2qtc"),t("kLXV")),B=(t("DZo9"),t("8z0m")),U=t("pVnL"),j=t.n(U),A=(t("+L6B"),t("2/Rp")),R=(t("Pwec"),t("CtXQ")),Y=(t("14J3"),t("BMrR")),z=(t("7Kak"),t("9yH6")),P=(t("nRaC"),t("5RzL")),J=(t("5NDa"),t("5rEg")),Q=(t("miYZ"),t("tsqr")),G=(t("jCWc"),t("kPKH")),H=(t("giR+"),t("fyUT")),K=(t("iQDF"),t("+eQT")),_=(t("OaEy"),t("2fM7")),X=(t("y8nQ"),t("Vl3Y")),Z=t("q1tI"),W=t.n(Z),$=t("MuoO"),ee=t("wd/R"),ae=t.n(ee),te=t("CkN6"),le=t("mf+E"),ne=t("+n12"),re=(t("P2fV"),t("NJEC")),ie=t("9zHi"),de=t.n(ie),se=t("PJYZ"),oe=t.n(se),ce=t("ZP6J"),me=t.n(ce),ue=X.a.Item,pe=_.a.Option,he=["身份证","驾驶证","营运证","其他"],be=["未处理","转运","变卖"],Ee=X.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleAdd,n=e.handleModalVisible;return W.a.createElement(x.a,{destroyOnClose:!0,title:"添加货物",className:me.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||(t.resetFields(),l(a))})},width:800,onCancel:function(){return n()}},W.a.createElement("div",{className:me.a.formModalBody},W.a.createElement(Y.a,{gutter:40},W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"货物名称"},t.getFieldDecorator("goodsName",{rules:[{required:!0,message:"请输入货物名称！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"货物数量"},t.getFieldDecorator("goodsNum",{rules:[{required:!0,message:"请输入货物数量！"}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"单位"},t.getFieldDecorator("unit",{rules:[{required:!0,message:"请输入单位！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"卸货车车牌"},t.getFieldDecorator("unloadCar",{rules:[{required:!0,message:"请输入卸货车车牌！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"卸货时间"},t.getFieldDecorator("unloadDate",{rules:[{required:!0,message:"请选择卸货时间！"}]})(W.a.createElement(K.a,{style:{width:"100%"},showTime:!0,placeholder:"请选择"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"卸货人"},t.getFieldDecorator("unloadMan",{rules:[{required:!0,message:"请输入卸货人！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"卸货人联系方式"},t.getFieldDecorator("unloadTel",{rules:[{required:!0,validator:ne.j}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"证件类型"},t.getFieldDecorator("cardType",{rules:[{required:!0,message:"请选择证件类型！"}]})(W.a.createElement(_.a,{style:{width:"100%"},placeholder:"请选择"},he.map(function(e,a){return W.a.createElement(pe,{key:a,value:a+1},e)}))))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"卸货人证件号码"},t.getFieldDecorator("unloadManCardNo",{rules:[{required:!0,message:"请输入卸货人证件号码！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"货物处理状态"},t.getFieldDecorator("status",{rules:[{required:!0,message:"请选择货物处理状态！"}]})(W.a.createElement(_.a,{style:{width:"100%"},placeholder:"请选择"},be.map(function(e,a){return W.a.createElement(pe,{key:a,value:a+1},e)}))))))))}),fe=X.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleUpdate,n=e.handleModalVisible,r=e.detail;return W.a.createElement(x.a,{destroyOnClose:!0,title:"编辑货物",width:800,className:me.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||(t.resetFields(),l(a))})},onCancel:function(){return n()}},W.a.createElement("div",{className:me.a.formModalBody},W.a.createElement(Y.a,{gutter:40},W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"货物名称"},t.getFieldDecorator("goodsName",{initialValue:r.goodsName,rules:[{required:!0,message:"请输入货物名称！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"货物数量"},t.getFieldDecorator("goodsNum",{initialValue:r.goodsNum,rules:[{required:!0,message:"请输入货物数量！"}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"单位"},t.getFieldDecorator("unit",{initialValue:r.unit,rules:[{required:!0,message:"请输入单位！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"卸货车车牌"},t.getFieldDecorator("unloadCar",{initialValue:r.unloadCar,rules:[{required:!0,message:"请输入卸货车车牌！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"卸货时间"},t.getFieldDecorator("unloadDate",{initialValue:ae()(new Date(r.unloadDate),"YYYY-MM-DD HH:mm:ss"),rules:[{required:!0,message:"请选择卸货时间！"}]})(W.a.createElement(K.a,{style:{width:"100%"},showTime:!0,placeholder:"请选择"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"卸货人"},t.getFieldDecorator("unloadMan",{initialValue:r.unloadMan,rules:[{required:!0,message:"请输入卸货人！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"卸货人联系方式"},t.getFieldDecorator("unloadTel",{initialValue:r.unloadTel,rules:[{required:!0,validator:ne.j}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"证件类型"},t.getFieldDecorator("cardType",{initialValue:r.cardType,rules:[{required:!0,message:"请选择证件类型！"}]})(W.a.createElement(_.a,{style:{width:"100%"},placeholder:"请选择"},he.map(function(e,a){return W.a.createElement(pe,{key:a,value:a+1},e)}))))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"卸货人证件号码"},t.getFieldDecorator("unloadManCardNo",{initialValue:r.unloadManCardNo,rules:[{required:!0,message:"请输入卸货人证件号码！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ue,{hasFeedback:!0,label:"货物处理状态"},t.getFieldDecorator("status",{initialValue:r.status,rules:[{required:!0,message:"请选择货物处理状态！"}]})(W.a.createElement(_.a,{style:{width:"100%"},placeholder:"请选择"},be.map(function(e,a){return W.a.createElement(pe,{key:a,value:a+1},e)}))))))))}),ge=Object($.connect)(function(e){return{Site:e.Site,loading:e.loading.models.Site}})(l=X.a.create()((r=n=function(e){function a(){var e,t;k()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=C()(this,(e=I()(a)).call.apply(e,[this].concat(n)))).state={createModalVisible:!1,updateModalVisible:!1,detail:{},baseQuery:{},selectedRows:[],formValues:[],pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"货物名称",dataIndex:"goodsName"},{title:"货物数量",dataIndex:"goodsNum"},{title:"单位",dataIndex:"unit"},{title:"货物处理状态",dataIndex:"status",render:function(e){return be[parseInt(e)-1]}},{title:"卸货车车牌",dataIndex:"unloadCar"},{title:"卸货时间",dataIndex:"unloadDate",render:function(e){return ae()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"卸货人",dataIndex:"unloadMan"},{title:"卸货人联系方式",dataIndex:"unloadTel"},{title:"证件类型",dataIndex:"cardType",render:function(e){return he[parseInt(e)-1]}},{title:"卸货人证件号码",dataIndex:"unloadManCardNo"},{title:"操作",width:100,render:function(e,a){return W.a.createElement(Z.Fragment,null,W.a.createElement(V.a,{placement:"left",title:"编辑"},W.a.createElement(A.a,{onClick:function(){return t.showUpdateModal(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(re.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},W.a.createElement(V.a,{placement:"left",title:"删除"},W.a.createElement(A.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.dataDel=function(e){t.delUtil(e)},t.batchDel=function(){var e=t.state.selectedRows;if(e){var a=oe()(t);x.a.confirm({title:"批量删除",content:"您确定要批量删除吗?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){a.delUtil(e.map(function(e){return e.id}).join())},onCancel:function(){}})}},t.delUtil=function(e){(0,t.props.dispatch)({type:"Site/deleteGoods",payload:{ids:e},callback:function(){t.getList(),t.setState({selectedRow:[]})}})},t.showUpdateModal=function(e){t.setState({detail:e},function(){t.handleUpdateModalVisible(!0)})},t.getList=function(e){(0,t.props.dispatch)({type:"Site/getUnloadGoods",payload:e})},t.handleCreateModalVisible=function(e){t.setState({createModalVisible:!!e})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{}})},t.handleFormReset=function(){var e=t.props.form,a=t.state,l=a.pageBean,n=a.baseQuery;e.resetFields(),t.setState({formValues:[],selectedRows:[]}),t.getList({pageBean:l,querys:[n]})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var l=t.state,n=l.pageBean,r=l.baseQuery,i=O()({},a),d=Object.keys(i).map(function(e){return i[e]?{property:e,value:i[e],group:"main",operation:"LIKE",relation:"OR"}:""}).filter(function(e){return e});t.setState({formValues:d}),t.getList({pageBean:n,querys:[r].concat(d)})}})},t.handleAdd=function(e){var a=t.props,l=a.dispatch,n=a.unloadYardID,r=t.state,i=r.baseQuery,d=r.pageBean;e.yardId=n,l({type:"Site/addGoods",payload:e,callback:function(){Q.a.success("添加成功"),setTimeout(function(){t.getList({pageBean:d,querys:[i]}),t.handleCreateModalVisible()},500)}})},t.handleUpdate=function(e){var a=t.props.dispatch,l=t.state,n=l.detail,r=l.baseQuery,i=l.pageBean,d=l.formValues,s=JSON.parse(JSON.stringify(n)),o=Object.keys(e);for(var c in o)s[o[c]]=e[o[c]];t.setState({detail:s}),a({type:"Site/updateGoods",payload:s,callback:function(){Q.a.success("编辑成功"),setTimeout(function(){t.getList({pageBean:i,querys:[r].concat(d)}),t.handleUpdateModalVisible()},500)}})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.handleStandardTableChange=function(e,a,l){var n=t.state,r=n.formValues,i=n.baseQuery,d={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:[i].concat(r)};t.getList(d)},t}return L()(a,e),S()(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.unloadYardID;this.setState({baseQuery:{group:"main",hasInitValue:!1,operation:"EQUAL",property:"yardId",relation:"AND",value:a}},function(){var a=e.state,t=a.baseQuery,l=a.pageBean;e.getList({pageBean:l,querys:[t]})})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return W.a.createElement(X.a,{onSubmit:this.handleSearch,layout:"inline"},W.a.createElement(Y.a,{gutter:{md:8,lg:16,xl:32}},W.a.createElement(G.a,{md:5,sm:24},W.a.createElement(ue,null,e("goodsName")(W.a.createElement(J.a,{addonBefore:"货物名称"})))),W.a.createElement(G.a,{md:5,sm:24},W.a.createElement(ue,null,e("unloadCar")(W.a.createElement(J.a,{addonBefore:"卸货车车牌"})))),W.a.createElement(G.a,{md:5,sm:24},W.a.createElement(ue,null,e("unloadMan")(W.a.createElement(J.a,{addonBefore:"卸货人"})))),W.a.createElement(G.a,{md:3,sm:24},W.a.createElement("span",{className:de.a.submitButtons},W.a.createElement(A.a,{type:"primary",htmlType:"submit"},"查询"),W.a.createElement(A.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.Site.unloadGoods,l=a.modalVisible,n=a.handleModalVisible,r=a.loading,i=this.state,d=i.createModalVisible,s=i.updateModalVisible,o=i.detail,c=i.selectedRows,m={handleModalVisible:this.handleCreateModalVisible,handleAdd:this.handleAdd},u={handleModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate,detail:o};return W.a.createElement(Z.Fragment,null,W.a.createElement(x.a,{destroyOnClose:!0,title:"货物",visible:l,className:me.a.myModal+" "+me.a.modalbody,onCancel:function(){return n()},width:"80%",footer:null},W.a.createElement("div",{className:me.a.detailMsg},W.a.createElement("div",{style:{padding:20}},W.a.createElement("div",{className:de.a.tableList},W.a.createElement("div",{className:de.a.tableListForm},this.renderSimpleForm()),W.a.createElement("div",{className:de.a.tableListOperator},W.a.createElement(A.a,{icon:"plus",type:"primary",onClick:function(){return e.handleCreateModalVisible(!0)}},"新建"),c.length>0&&W.a.createElement("span",null,W.a.createElement(A.a,{type:"danger",onClick:function(){return e.batchDel()}},"批量删除"))),W.a.createElement(te.a,{tableAlert:!0,selectedRows:c,loading:r,size:"middle",data:t,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))))),l?W.a.createElement(Ee,j()({},m,{modalVisible:d})):null,s&&"{}"!==JSON.stringify(o)?W.a.createElement(fe,j()({},u,{modalVisible:s})):null)}}]),a}(Z.PureComponent),n.defaultProps={handleModalVisible:function(){}},l=r))||l)||l,ye=X.a.Item,ve=X.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleAdd,n=e.handleModalVisible;return W.a.createElement(x.a,{destroyOnClose:!0,title:"添加卸货场地",className:me.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||(t.resetFields(),l(a))})},onCancel:function(){return n()},width:800},W.a.createElement("div",{className:me.a.formModalBody},W.a.createElement(Y.a,{gutter:40},W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"场地名称"},t.getFieldDecorator("yardName",{rules:[{required:!0,message:"请输入场地名称！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"场地编号"},t.getFieldDecorator("yardCode",{rules:[{required:!0,message:"请输入场地编号！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"场地位置"},t.getFieldDecorator("yardAddr",{rules:[{required:!0,message:"请输入位置！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"面积/平方米"},t.getFieldDecorator("area",{rules:[{required:!0,message:"请输入面积/平方米！"}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"经度"},t.getFieldDecorator("longitude",{rules:[{required:!0,message:"请输入经度！"}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"纬度"},t.getFieldDecorator("latitude",{rules:[{required:!0,message:"请输入纬度！"}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"状态"},t.getFieldDecorator("status",{initialValue:1,rules:[{required:!0,message:"请选择状态！"}]})(W.a.createElement(z.a.Group,{style:{width:"100%"}},W.a.createElement(z.a,{value:1},"正常"),W.a.createElement(z.a,{value:0},"禁用"))))))))}),Fe=X.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleUpdate,n=e.handleModalVisible,r=e.detail;return W.a.createElement(x.a,{destroyOnClose:!0,title:"编辑卸货场地",className:me.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||(t.resetFields(),l(a))})},onCancel:function(){return n()},width:800},W.a.createElement("div",{className:me.a.formModalBody},W.a.createElement(Y.a,{gutter:40},W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"场地名称"},t.getFieldDecorator("yardName",{initialValue:r.yardName,rules:[{required:!0,message:"请输入场地名称！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"场地编号"},t.getFieldDecorator("yardCode",{initialValue:r.yardCode,rules:[{required:!0,message:"请输入场地编号！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"场地位置"},t.getFieldDecorator("yardAddr",{initialValue:r.yardAddr,rules:[{required:!0,message:"请输入位置！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"面积/平方米"},t.getFieldDecorator("area",{initialValue:r.area,rules:[{required:!0,message:"请输入面积/平方米！"}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"经度"},t.getFieldDecorator("longitude",{initialValue:r.longitude,rules:[{required:!0,message:"请输入经度！"}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"纬度"},t.getFieldDecorator("latitude",{initialValue:r.latitude,rules:[{required:!0,message:"请输入纬度！"}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(ye,{hasFeedback:!0,label:"状态"},t.getFieldDecorator("status",{initialValue:r.status,rules:[{required:!0,message:"请选择状态！"}]})(W.a.createElement(z.a.Group,{style:{width:"100%"}},W.a.createElement(z.a,{value:1},"正常"),W.a.createElement(z.a,{value:0},"禁用"))))))))}),Ve=Object($.connect)(function(e){return{Site:e.Site,loading:e.loading.models.Site}})(i=X.a.create()((s=d=function(e){function a(){var e,t;k()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=C()(this,(e=I()(a)).call.apply(e,[this].concat(n)))).state={createModalVisible:!1,updateModalVisible:!1,goodsModalVisible:!1,unloadYardID:0,detail:{}},t.columns=[{title:"场地名称",dataIndex:"yardName"},{title:"场地编号",dataIndex:"yardCode"},{title:"面积/平方米",dataIndex:"area"},{title:"经度",dataIndex:"longitude"},{title:"纬度",dataIndex:"latitude"},{title:"场地位置",dataIndex:"yardAddr"},{title:"操作",width:130,render:function(e,a){return W.a.createElement(Z.Fragment,null,W.a.createElement(V.a,{placement:"left",title:"编辑"},W.a.createElement(A.a,{onClick:function(){return t.showUpdateModal(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(V.a,{placement:"left",title:"货物列表"},W.a.createElement(A.a,{onClick:function(){return t.showGoodsModal(a.id)},type:"primary",shape:"circle",icon:"table",size:"small"})),W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(re.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},W.a.createElement(V.a,{placement:"left",title:"删除"},W.a.createElement(A.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.dataDel=function(e){(0,t.props.dispatch)({type:"Site/deleteUnloadYard",payload:{id:e},callback:function(){t.getList()}})},t.showGoodsModal=function(e){t.setState({unloadYardID:e}),t.handleGoodsModalVisible(!0)},t.showUpdateModal=function(e){t.setState({detail:e},function(){t.handleUpdateModalVisible(!0)})},t.getList=function(){var e=t.props;(0,e.dispatch)({type:"Site/getUnloadYards",payload:{siteId:e.siteID}})},t.handleCreateModalVisible=function(e){t.setState({createModalVisible:!!e})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{}})},t.handleGoodsModalVisible=function(e){t.setState({goodsModalVisible:!!e})},t.handleAdd=function(e){var a=t.props,l=a.dispatch,n=a.siteID;e.siteId=n,e.status=1,l({type:"Site/addUnloadYard",payload:e,callback:function(){Q.a.success("添加成功"),setTimeout(function(){t.getList(),t.handleCreateModalVisible()},500)}})},t.handleUpdate=function(e){var a=t.props.dispatch,l=t.state.detail,n=JSON.parse(JSON.stringify(l)),r=Object.keys(e);for(var i in r)n[r[i]]=e[r[i]];t.setState({detail:n}),a({type:"Site/updateUnloadYard",payload:n,callback:function(){Q.a.success("编辑成功"),setTimeout(function(){t.getList(),t.handleUpdateModalVisible()},500)}})},t}return L()(a,e),S()(a,[{key:"componentDidMount",value:function(){this.getList()}},{key:"render",value:function(){var e=this,a=this.props,t=a.Site.unloadYardsData,l=a.modalVisible,n=a.handleModalVisible,r=a.loading,i=this.state,d=i.createModalVisible,s=i.updateModalVisible,o=i.detail,c=i.goodsModalVisible,m=i.unloadYardID,u={handleModalVisible:this.handleCreateModalVisible,handleAdd:this.handleAdd},p={handleModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate,detail:o},h={handleModalVisible:this.handleGoodsModalVisible,modalVisible:c,unloadYardID:m};return W.a.createElement(Z.Fragment,null,W.a.createElement(x.a,{destroyOnClose:!0,title:"卸货场地",visible:l,className:me.a.myModal+" "+me.a.modalbody,onCancel:function(){return n()},width:1100,footer:null},W.a.createElement("div",{className:me.a.detailMsg},W.a.createElement("div",{style:{padding:20}},W.a.createElement("div",{className:de.a.tableList},W.a.createElement("div",{className:de.a.tableListOperator},W.a.createElement(A.a,{icon:"plus",type:"primary",onClick:function(){return e.handleCreateModalVisible(!0)}},"新建")),W.a.createElement(te.a,{selectedRows:0,rowSelection:null,loading:r,size:"middle",data:t,columns:this.columns}))))),l?W.a.createElement(ve,j()({},u,{modalVisible:d})):null,s&&"{}"!==JSON.stringify(o)?W.a.createElement(Fe,j()({},p,{modalVisible:s})):null,c?W.a.createElement(ge,j()({},h,{modalVisible:c})):null)}}]),a}(Z.PureComponent),d.defaultProps={handleModalVisible:function(){}},i=s))||i)||i,De=X.a.Item,ke=X.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleAdd,n=e.handleModalVisible,r=e.fileList,i=e.fileChange,d={name:"files",action:"/result/api/file/v1/fileUpload",accept:".pdf,.doc,.docx",listType:"picture",data:{type:2,xbType:""},headers:{Authorization:"Bearer ".concat(Object(ne.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},onChange:i,beforeUpload:ne.q};return W.a.createElement(x.a,{destroyOnClose:!0,title:"建设资料上传",className:me.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})},onCancel:function(){return n()}},W.a.createElement("div",{className:me.a.formModalBody},W.a.createElement(De,{hasFeedback:!0,label:"文件名称"},t.getFieldDecorator("fileName",{rules:[{required:!0,message:"请输入文件名称！"}]})(W.a.createElement(J.a,{placeholder:"请输入"}))),W.a.createElement(De,{label:"文件上传"},t.getFieldDecorator("filePath",{rules:[{required:!0,message:"请选择文件！"}]})(W.a.createElement(B.a,d,r.length>=1?null:W.a.createElement(A.a,null,W.a.createElement(R.a,{type:"upload"})," 选择文件（请上传 ‘pdf’ 及 ‘doc’ 文件）"))))))}),we=Object($.connect)(function(e){var a=e.Site,t=e.loading;return{Site:a,File:e.File,loading:t.models.Site}})(o=X.a.create()((m=c=function(e){function a(){var e,t;k()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=C()(this,(e=I()(a)).call.apply(e,[this].concat(n)))).state={createModalVisible:!1,downLoaing:!1,uploadLoad:!1,fileId:"",baseQuery:{},selectedRows:[],formValues:[],fileList:[],pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"文件名称",dataIndex:"fileName"},{title:"文件路径",dataIndex:"filePath"},{title:"操作",width:140,render:function(e,a){return W.a.createElement(Z.Fragment,null,W.a.createElement(V.a,{placement:"left",title:"查看"},W.a.createElement(A.a,{onClick:function(){return t.openPDF(a)},type:"primary",shape:"circle",icon:"eye",size:"small"})),W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(V.a,{placement:"left",title:"下载"},W.a.createElement(A.a,{onClick:function(){return t.downLoadFile(a)},type:"primary",shape:"circle",icon:"download",size:"small"})),W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(re.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},W.a.createElement(V.a,{placement:"left",title:"删除"},W.a.createElement(A.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.downLoadFile=function(e){var a=t.props.dispatch;t.setState({downLoaing:!0}),a({type:"File/downLoad",payload:{id:e.fileId,fileName:e.fileName,extensionName:"."+e.filePath.split(".")[1]},callback:function(){t.setState({downLoaing:!1})}})},t.dataDel=function(e){t.delUtil(e)},t.batchDel=function(){var e=t.state.selectedRows;if(e){var a=oe()(t);x.a.confirm({title:"批量删除",content:"您确定要批量删除吗?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){a.delUtil(e.map(function(e){return e.id}).join())},onCancel:function(){}})}},t.delUtil=function(e){(0,t.props.dispatch)({type:"Site/deleteSysSiteBuildMsg",payload:{ids:e},callback:function(){t.getList(),t.setState({selectedRows:[]})}})},t.openPDF=function(e){t.setState({downLoaing:!0});var a=e.filePath.split(".")[1],l=t.props.dispatch;"pdf"===a?(t.setState({downLoaing:!1}),window.open(ne.t+e.filePath,"_blank")):l({type:"File/preview",payload:{fileId:e.fileId},callback:function(e){if(e){var a=e.pdfUrl.split("/"),n=a[a.length-1];l({type:"File/preview_",payload:n,callback:function(e){if(t.setState({downLoaing:!1}),200!==e.code)return Q.a.error("文件读取失败！");window.open(ne.J+e.data,"_blank")}})}}})},t.getList=function(e){(0,t.props.dispatch)({type:"Site/getSysSiteBuild",payload:e})},t.handleCreateModalVisible=function(e){t.setState({createModalVisible:!!e}),e||t.setState({fileList:[]})},t.handleFormReset=function(){var e=t.props.form,a=t.state,l=a.pageBean,n=a.baseQuery;e.resetFields(),t.setState({formValues:[],selectedRows:[]}),t.getList({pageBean:l,querys:[n]})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var l=t.state,n=l.pageBean,r=l.baseQuery,i=O()({},a),d=Object.keys(i).map(function(e){return i[e]?{property:e,value:i[e],group:"main",operation:"LIKE",relation:"OR"}:""}).filter(function(e){return e});t.setState({formValues:d}),t.getList({pageBean:n,querys:[r].concat(d)})}})},t.handleAdd=function(e,a){var l=t.props,n=l.dispatch,r=l.siteCode,i=t.state,d=i.baseQuery,s=i.pageBean,o=i.fileId;if(!i.fileList.length)return Q.a.error("请选择文件");e.siteCode=r;var c=e.filePath.file.response;e.filePath=c?c.filePath:"",e.fileId=o,n({type:"Site/addSysSiteBuildMsg",payload:e,callback:function(){Q.a.success("添加成功"),a&&a(),setTimeout(function(){t.getList({pageBean:s,querys:[d]}),t.handleCreateModalVisible()},500)}})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.fileChange=function(e){"uploading"!==e.file.status?"done"===e.file.status?200===e.file.response.code?(Q.a.success("上传成功"),t.setState({fileList:e.fileList,uploadLoad:!1,fileId:e.file.response.fileId})):(Q.a.error("上传失败"),t.setState({uploadLoad:!1})):"error"===e.file.status?(Q.a.error("上传失败"),t.setState({uploadLoad:!1})):"removed"===e.file.status&&t.setState({fileList:e.fileList}):t.setState({uploadLoad:!0})},t.handleStandardTableChange=function(e,a,l){var n=t.state,r=n.formValues,i=n.baseQuery,d={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:[i].concat(r)};t.getList(d)},t}return L()(a,e),S()(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.siteCode;this.setState({baseQuery:{group:"main",hasInitValue:!1,operation:"EQUAL",property:"siteCode",relation:"AND",value:a}},function(){var a=e.state,t=a.baseQuery,l=a.pageBean;e.getList({pageBean:l,querys:[t]})})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return W.a.createElement(X.a,{onSubmit:this.handleSearch,layout:"inline"},W.a.createElement(Y.a,{gutter:{md:8,lg:16,xl:16}},W.a.createElement(G.a,{md:10,sm:24},W.a.createElement(De,null,e("fileName")(W.a.createElement(J.a,{addonBefore:"站点建设资料名称"})))),W.a.createElement(G.a,{md:3,sm:24},W.a.createElement("span",{className:de.a.submitButtons},W.a.createElement(A.a,{type:"primary",htmlType:"submit"},"查询"),W.a.createElement(A.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.Site.sysSiteBuild,l=a.modalVisible,n=a.handleModalVisible,r=a.loading,i=this.state,d=i.createModalVisible,s=i.selectedRows,o=i.fileList,c=i.uploadLoad,m=i.downLoaing,u={handleModalVisible:this.handleCreateModalVisible,handleAdd:this.handleAdd,fileList:o,fileChange:this.fileChange,uploadLoad:c};return W.a.createElement(Z.Fragment,null,W.a.createElement(x.a,{destroyOnClose:!0,title:"站点建设信息",visible:l,className:me.a.myModal+" "+me.a.modalbody,onCancel:function(){return n()},width:800,footer:null},W.a.createElement(g.a,{spinning:m},W.a.createElement("div",{className:me.a.detailMsg},W.a.createElement("div",{style:{padding:20}},W.a.createElement("div",{className:de.a.tableList},W.a.createElement("div",{className:de.a.tableListForm},this.renderSimpleForm()),W.a.createElement("div",{className:de.a.tableListOperator},W.a.createElement(A.a,{icon:"plus",type:"primary",onClick:function(){return e.handleCreateModalVisible(!0)}},"新建"),s.length>0&&W.a.createElement("span",null,W.a.createElement(A.a,{type:"danger",onClick:function(){return e.batchDel()}},"批量删除"))),W.a.createElement(te.a,{selectedRows:s,loading:r,size:"middle",data:t,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange})))))),l?W.a.createElement(ke,j()({},u,{modalVisible:d})):null)}}]),a}(Z.PureComponent),c.defaultProps={handleModalVisible:function(){}},o=m))||o)||o,Se={page:1,pageSize:10,showTotal:!0},Me=X.a.Item,Ce=X.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.loading,n=e.handleAdd,r=e.handleModalVisible,i=e.detail,d=e.propData;return W.a.createElement(x.a,{destroyOnClose:!0,title:"新建",className:me.a.formModal,visible:a,onCancel:function(){return r()},footer:[W.a.createElement(A.a,{key:"back",onClick:function(){return r()}},"取消"),W.a.createElement(A.a,{key:"submit",type:"primary",loading:l,onClick:function(){t.validateFields(function(e,a){e||n(a,function(){return t.resetFields()})})}},"确定")]},W.a.createElement("div",{className:me.a.formModalBody},W.a.createElement(Me,{hasFeedback:!0,label:"设备编号"},t.getFieldDecorator("equipmentNum",{rules:[{required:!0,message:"请输入设备编号！"}],initialValue:i.equipmentNum||d.equipmentNum})(W.a.createElement(J.a,{placeholder:"请输入"}))),W.a.createElement(Me,{hasFeedback:!0,label:"车道号"},t.getFieldDecorator("laneID",{rules:[{required:!0,message:"请输入车道号！"}],initialValue:i.laneID||void 0})(W.a.createElement(H.a,{style:{width:"100%"},min:0,placeholder:"请输入"})))))}),Ne=Object($.connect)(function(e){return{FsEquipment:e.FsEquipment,loading:e.loading.models.FsEquipment}})(u=X.a.create()(u=function(e){function a(){var e,t;k()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=C()(this,(e=I()(a)).call.apply(e,[this].concat(n)))).baseQuery={},t.state={visible:!1,detail:{}},t.columns=[{title:"车道",dataIndex:"laneID"},{title:"设备编号",dataIndex:"equipmentNum"},{title:"操作",width:90,render:function(e,a){return W.a.createElement(W.a.Fragment,null,W.a.createElement(V.a,{placement:"left",title:"编辑"},W.a.createElement(A.a,{onClick:function(){return t.showDetail(a.id)},type:"primary",shape:"circle",icon:"edit",size:"small"})),W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(re.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},W.a.createElement(V.a,{placement:"left",title:"删除"},W.a.createElement(A.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.showDetail=function(e){(0,t.props.dispatch)({type:"FsEquipment/detail",payload:e,callback:function(e){t.setState({detail:e},function(){return t.handleVisible(!0)})}})},t.handleVisible=function(e){t.setState({visible:!!e}),e||t.setState({detail:{}})},t.dataDel=function(e){t.delUtil(e)},t.delUtil=function(e){(0,t.props.dispatch)({type:"FsEquipment/remove",payload:e,callback:function(){t.getList({pageBean:Se,querys:[t.baseQuery]})}})},t.getList=function(e){(0,t.props.dispatch)({type:"FsEquipment/fetch",payload:e})},t.handleStandardTableChange=function(e){t.getList({pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:[t.baseQuery]})},t.handleAdd=function(e,a){var l=t.props,n=l.data.siteCode,r=l.dispatch,i=t.state.detail.id,d=O()({},e,{siteID:n});i&&(d.id=i),r({type:"FsEquipment/auData",payload:d,callback:function(){a(),Q.a.success("操作成功"),t.handleVisible(),t.getList({pageBean:Se,querys:[t.baseQuery]})}})},t}return L()(a,e),S()(a,[{key:"componentDidMount",value:function(){var e=this.props.data.siteCode;this.baseQuery={group:"main",hasInitValue:!1,operation:"EQUAL",property:'"SiteID"',relation:"AND",value:e},this.getList({pageBean:Se,querys:[this.baseQuery]})}},{key:"render",value:function(){var e=this,a=this.props,t=a.modalVisible,l=a.handleModalVisible,n=a.loading,r=a.FsEquipment.data,i=this.state,d=i.visible,s=i.detail;return W.a.createElement(x.a,{destroyOnClose:!0,title:"车道",visible:t,onCancel:function(){return l()},width:900,className:"".concat(me.a.myModal," ").concat(me.a.modalbody),footer:null},W.a.createElement("div",{className:me.a.detailMsg},W.a.createElement("div",{style:{padding:20}},W.a.createElement("div",{className:de.a.tableList},W.a.createElement("div",{className:de.a.tableListOperator},W.a.createElement(A.a,{icon:"plus",type:"primary",onClick:function(){return e.handleVisible(!0)}},"新建")),W.a.createElement(te.a,{selectedRows:0,rowSelection:null,tableAlert:!1,loading:n,size:"middle",data:r,columns:this.columns,onChange:this.handleStandardTableChange})))),d&&W.a.createElement(Ce,{handleModalVisible:this.handleVisible,modalVisible:d,detail:s,propData:this.props.data,loading:n,handleAdd:this.handleAdd}))}}]),a}(Z.PureComponent))||u)||u,Ie=(t("BoS7"),t("Sdc0")),qe=X.a.Item,Le=X.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleAdd,n=e.handleModalVisible;return W.a.createElement(x.a,{destroyOnClose:!0,title:"添加流媒体通道",className:me.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})},onCancel:function(){return n()}},W.a.createElement("div",{className:me.a.formModalBody},W.a.createElement(qe,{hasFeedback:!0,label:"名称"},t.getFieldDecorator("mediaName",{rules:[{required:!0,message:"请输入名称！"}]})(W.a.createElement(J.a,{placeholder:"请输入"}))),W.a.createElement(qe,{hasFeedback:!0,label:"车道号"},t.getFieldDecorator("lanNo",{rules:[{required:!0,message:"请输入车道号！"}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"}))),W.a.createElement(qe,{hasFeedback:!0,label:"流媒体通道号"},t.getFieldDecorator("mediaNo",{rules:[{required:!0,message:"请输入流媒体通道号！"}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"}))),W.a.createElement(qe,{hasFeedback:!0,label:"方向"},t.getFieldDecorator("direction",{initialValue:1,rules:[{required:!0,message:"请选择方向！"}]})(W.a.createElement(z.a.Group,{style:{width:"100%"}},W.a.createElement(z.a,{value:1},"进城方向"),W.a.createElement(z.a,{value:0},"出城方向")))),W.a.createElement(qe,{label:"是否展示"},t.getFieldDecorator("switch",{initialValue:!0,rules:[{required:!0,message:"请选择！"}]})(W.a.createElement(Ie.a,{checkedChildren:"展示",unCheckedChildren:"隐藏",defaultChecked:!0})))))}),Te=Object($.connect)(function(e){return{Site:e.Site,loading:e.loading.models.Site}})(p=X.a.create()((b=h=function(e){function a(){var e,t;k()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=C()(this,(e=I()(a)).call.apply(e,[this].concat(n)))).state={addModalVisible:!1},t.columns=[{title:"名称",dataIndex:"mediaName"},{title:"通道号",dataIndex:"mediaNo"},{title:"车道号",dataIndex:"lanNo"},{title:"方向",dataIndex:"direction",render:function(e){return e?"进城方向":"出城方向"}},{title:"是否展示",dataIndex:"isShow",render:function(e){return e?"隐藏":"展示"}},{title:"操作",width:70,render:function(e,a){return W.a.createElement(Z.Fragment,null,W.a.createElement(re.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},W.a.createElement(V.a,{placement:"left",title:"删除"},W.a.createElement(A.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.getList=function(){var e=t.props;(0,e.dispatch)({type:"Site/getMedia",payload:{siteCode:e.siteCode}})},t.dataDel=function(e){(0,t.props.dispatch)({type:"Site/deleteMedia",payload:{id:e},callback:function(){t.getList(),Q.a.success("删除成功")}})},t.handAddModalVisible=function(e){t.setState({addModalVisible:!!e})},t.handleAdd=function(e,a){var l=t.props,n=l.dispatch,r=l.siteCode;n({type:"Site/addMedia",payload:O()({},e,{siteCode:r,isShow:e.switch?0:1}),callback:function(){Q.a.success("添加成功"),t.getList(),a(),t.handAddModalVisible()}})},t}return L()(a,e),S()(a,[{key:"componentDidMount",value:function(){this.getList()}},{key:"render",value:function(){var e=this,a=this.props,t=a.Site.modiaData,l=a.modalVisible,n=a.handleModalVisible,r=a.siteName,i=a.loading,d=this.state.addModalVisible,s={handleAdd:this.handleAdd,handleModalVisible:this.handAddModalVisible};return W.a.createElement(Z.Fragment,null,W.a.createElement(x.a,{destroyOnClose:!0,title:r+"\t\t\t流媒体通道",visible:l,onCancel:function(){return n()},width:900,className:me.a.myModal+" "+me.a.modalbody,footer:null},W.a.createElement("div",{className:me.a.detailMsg},W.a.createElement("div",{style:{padding:20}},W.a.createElement("div",{className:de.a.tableList},W.a.createElement("div",{className:de.a.tableListOperator},W.a.createElement(A.a,{icon:"plus",type:"primary",onClick:function(){return e.handAddModalVisible(!0)}},"新建")),W.a.createElement(te.a,{selectedRows:0,rowSelection:null,loading:i,size:"middle",pagination:!1,data:t,columns:this.columns}))))),W.a.createElement(Le,j()({},s,{modalVisible:d})))}}]),a}(Z.PureComponent),h.defaultProps={handleModalVisible:function(){}},p=b))||p)||p,Oe=t("o0o1"),xe=t.n(Oe),Be=t("yXPU"),Ue=t.n(Be),je=t("t3Un");function Ae(e){return Re.apply(this,arguments)}function Re(){return(Re=Ue()(xe.a.mark(function e(a){return xe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(je.a)("/traffic-v1/api/siteJdbc/get/".concat(a)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ye(e){return ze.apply(this,arguments)}function ze(){return(ze=Ue()(xe.a.mark(function e(a){return xe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(je.a)("/traffic-v1/api/siteJdbc/add",{method:"POST",data:a}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Pe(e){return Je.apply(this,arguments)}function Je(){return(Je=Ue()(xe.a.mark(function e(a){return xe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(je.a)("/traffic-v1/api/siteJdbc/del/".concat(a),{method:"DELETE"}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Qe(e){return Ge.apply(this,arguments)}function Ge(){return(Ge=Ue()(xe.a.mark(function e(a){return xe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(je.a)("/traffic-v1/api/siteJdbc/update",{method:"PUT",data:a}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var He,Ke=X.a.Item,_e=_.a.Option,Xe=["oracle","mysql","sqlServer"],Ze=X.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.loading,n=e.propData,r=void 0===n?{}:n,i=e.handleAdd,d=e.handleModalVisible;return W.a.createElement(x.a,{destroyOnClose:!0,title:Object.keys(r).length?"编辑":"新建",className:me.a.formModal,visible:a,onCancel:function(){return d()},footer:[W.a.createElement(A.a,{key:"back",onClick:function(){return d()}},"取消"),W.a.createElement(A.a,{key:"submit",type:"primary",loading:l,onClick:function(){t.validateFields(function(e,a){e||i(a,function(){return t.resetFields()})})}},"确定")]},W.a.createElement("div",{className:me.a.formModalBody},W.a.createElement(Ke,{hasFeedback:!0,label:"数据库类型"},t.getFieldDecorator("jdbcType",{rules:[{required:!0,message:"请选择数据库类型！"}],initialValue:r.jdbcType||void 0})(W.a.createElement(_.a,{placeholder:"请选择",style:{width:"100%"}},Xe.map(function(e,a){return W.a.createElement(_e,{value:a+1},e)})))),W.a.createElement(Ke,{hasFeedback:!0,label:"IP"},t.getFieldDecorator("jdbcIp",{rules:[{required:!0,message:"请输入数据库IP！"}],initialValue:r.jdbcIp||void 0})(W.a.createElement(J.a,{placeholder:"请输入"}))),W.a.createElement(Ke,{hasFeedback:!0,label:"端口"},t.getFieldDecorator("jdbcPort",{rules:[{required:!0,message:"请输入数据库端口！"}],initialValue:r.jdbcPort||void 0})(W.a.createElement(H.a,{placeholder:"请输入",style:{width:"100%"}}))),W.a.createElement(Ke,{hasFeedback:!0,label:"数据库库名或服务名称"},t.getFieldDecorator("jdbcDb",{rules:[{required:!0,message:"请输入数据库库名或服务名称！"}],initialValue:r.jdbcDb||void 0})(W.a.createElement(J.a,{placeholder:"请输入",style:{width:"100%"}}))),W.a.createElement(Ke,{hasFeedback:!0,label:"表名"},t.getFieldDecorator("jdbcTableName",{rules:[{required:!0,message:"请输入数据库表名！"}],initialValue:r.jdbcTableName||void 0})(W.a.createElement(J.a,{placeholder:"请输入",style:{width:"100%"}}))),W.a.createElement(Ke,{hasFeedback:!0,label:"用户名"},t.getFieldDecorator("jdbcUserName",{rules:[{required:!0,message:"请输入数据用户名！"}],initialValue:r.jdbcUserName||void 0})(W.a.createElement(J.a,{placeholder:"请输入",style:{width:"100%"}}))),W.a.createElement(Ke,{hasFeedback:!0,label:"密码"},t.getFieldDecorator("jdbcPwd",{rules:[{required:!0,message:"请输入数据库密码！"}],initialValue:r.jdbcPwd||void 0})(W.a.createElement(J.a,{placeholder:"请输入",style:{width:"100%"}})))))}),We=X.a.create()(E=function(e){function a(){var e,t;k()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=C()(this,(e=I()(a)).call.apply(e,[this].concat(n)))).state={visible:!1,detail:{},loading:!1,data:{list:[],pagination:{}}},t.columns=[{title:"数据库类型",dataIndex:"jdbcType",render:function(e){return Xe[e-1]}},{title:"IP",dataIndex:"jdbcIp"},{title:"端口",dataIndex:"jdbcPort"},{title:"库名",dataIndex:"jdbcDb"},{title:"表名称",dataIndex:"jdbcTableName"},{title:"用户名",dataIndex:"jdbcUserName"},{title:"操作",width:90,render:function(e,a){return W.a.createElement(W.a.Fragment,null,W.a.createElement(V.a,{placement:"left",title:"编辑"},W.a.createElement(A.a,{onClick:function(){return t.showDetail(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(re.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},W.a.createElement(V.a,{placement:"left",title:"删除"},W.a.createElement(A.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.showDetail=function(e){t.setState({detail:e},function(){return t.handleVisible(!0)})},t.handleVisible=function(e){t.setState({visible:!!e}),e||t.setState({detail:{}})},t.dataDel=function(){var e=Ue()(xe.a.mark(function e(a){var l;return xe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Pe(a);case 3:l=e.sent,200===Object(ne.u)(l)&&t.modalEvent("删除成功"),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}},e,null,[[0,8]])}));return function(a){return e.apply(this,arguments)}}(),t.getData=Ue()(xe.a.mark(function e(){var a,l;return xe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props.siteCode,t.setState({loading:!0}),e.prev=2,e.next=5,Ae(a);case 5:l=e.sent,200===Object(ne.u)(l)&&t.setState({data:{list:l.data?[l.data]:[]}}),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:t.setState({loading:!1});case 13:case"end":return e.stop()}},e,null,[[2,10]])})),t.handleAdd=function(){var e=Ue()(xe.a.mark(function e(a,l){var n,r,i,d,s;return xe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.setState({loading:!0}),n=t.props.siteCode,r=O()({},a,{siteCode:n}),i=t.state.detail,e.prev=4,!Object.keys(i).length){e.next=14;break}return r.id=i.id,e.next=9,Qe(r);case 9:d=e.sent,200===Object(ne.u)(d)&&(t.modalEvent("编辑成功"),l()),e.next=19;break;case 14:return e.next=16,Ye(r);case 16:s=e.sent,200===Object(ne.u)(s)&&(t.modalEvent("添加成功"),l());case 19:e.next=23;break;case 21:e.prev=21,e.t0=e.catch(4);case 23:t.setState({loading:!1});case 24:case"end":return e.stop()}},e,null,[[4,21]])}));return function(a,t){return e.apply(this,arguments)}}(),t.modalEvent=function(e){Q.a.success(e),t.handleVisible(),t.getData()},t}return L()(a,e),S()(a,[{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){var e=this,a=this.props,t=a.modalVisible,l=a.handleModalVisible,n=this.state,r=n.visible,i=n.data,d=n.loading,s=n.detail;return W.a.createElement(x.a,{destroyOnClose:!0,title:"数据源",visible:t,onCancel:function(){return l()},width:1e3,className:"".concat(me.a.myModal," ").concat(me.a.modalbody),footer:null},W.a.createElement("div",{className:me.a.detailMsg},W.a.createElement("div",{style:{padding:20}},W.a.createElement("div",{className:de.a.tableList},!i.list.length&&W.a.createElement("div",{className:de.a.tableListOperator},W.a.createElement(A.a,{icon:"plus",type:"primary",onClick:function(){return e.handleVisible(!0)}},"新建")),W.a.createElement(te.a,{selectedRows:0,rowSelection:null,tableAlert:!1,loading:d,size:"middle",data:i,columns:this.columns,pagination:!1})))),r&&W.a.createElement(Ze,{handleModalVisible:this.handleVisible,modalVisible:r,loading:d,propData:s,handleAdd:this.handleAdd}))}}]),a}(Z.PureComponent))||E,$e=t("ns75"),ea=t.n($e),aa=X.a.Item,ta=_.a.Option,la=K.a.RangePicker,na=["/datemain/site","/datemain/site/addSite","/datemain/site/updateSite","/datemain/site/deleteSite","/system/sysSiteBuild/list","/system/unloadYard/list","/system/mediaConf/list"],ra=["报废","在用","检修"],ia=["red","green","yellow"],da=X.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleAdd,n=e.handleModalVisible,r=e.siteType,i=e.siteTypeChange,d=e.treeList,s=W.a.createElement(Z.Fragment,null,W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"最小速度(km)"},t.getFieldDecorator("lowSpeed",{})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"最高速度(km)"},t.getFieldDecorator("highSpeed",{})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入",min:0})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"超载预警(%)"},t.getFieldDecorator("warningLoadRate",{})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入",min:0})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"超速预警(%)"},t.getFieldDecorator("warningSpeedRate",{})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入",min:0})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"执法方式"},t.getFieldDecorator("lawEnforceType",{initialValue:1,rules:[{required:!0,message:"请选择执法方式!"}]})(W.a.createElement(_.a,{style:{width:"100%"},placeholder:"请选择"},W.a.createElement(_.a.Option,{value:1},"动态执法"),W.a.createElement(_.a.Option,{value:2},"动静结合执法")))))),o={name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",data:{type:2,xbType:""},headers:{Authorization:"Bearer ".concat(Object(ne.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},onChange:function(e){e.file.status,"done"===e.file.status?Q.a.success("".concat(e.file.name," 上传成功")):"error"===e.file.status&&Q.a.error("".concat(e.file.name," 上传失败"))}};return W.a.createElement(x.a,{destroyOnClose:!0,title:"新建站点",className:me.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})},onCancel:function(){return n()},width:800},W.a.createElement("div",{className:me.a.formModalBody},W.a.createElement(Y.a,{gutter:40},W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"站点类型"},t.getFieldDecorator("siteType",{initialValue:r,rules:[{required:!0,message:"请选择站点类型！"}]})(W.a.createElement(_.a,{style:{width:"100%"},placeholder:"请选择",onChange:i},W.a.createElement(ta,{value:"1"},"动态检测站点"),W.a.createElement(ta,{value:"2"},"静态检测站"))))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"站点号"},t.getFieldDecorator("siteCode",{rules:[{required:!0,message:"请输入站点号！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"站点名称"},t.getFieldDecorator("siteName",{rules:[{required:!0,message:"请输入站点名称！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"区域"},t.getFieldDecorator("organId",{rules:[{required:!0,message:"请选择区域！"}]})(W.a.createElement(P.a,{treeData:d,style:{width:"100%"},placeholder:"请选择"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"地址"},t.getFieldDecorator("address",{rules:[{required:!0,message:"请输入地址！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"经度"},t.getFieldDecorator("longitude",{rules:[{required:!0,validator:ne.i}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"纬度"},t.getFieldDecorator("latitude",{rules:[{required:!0,validator:ne.f}]})(W.a.createElement(H.a,{style:{width:"100%"},placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"设备编号"},t.getFieldDecorator("equipmentNum")(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"站点IP"},t.getFieldDecorator("siteIP")(W.a.createElement(J.a,{placeholder:"请输入"})))),"1"===r?s:null,W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"站点负责人"},t.getFieldDecorator("siteReponsible",{rules:[{required:!0,message:"请输入站点负责人！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"电话"},t.getFieldDecorator("reponsibleTel",{rules:[{required:!0,validator:ne.j}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"建造公司"},t.getFieldDecorator("builderCompany",{rules:[{required:!0,message:"请输入建造公司！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"建造负责人"},t.getFieldDecorator("builderReponsible",{rules:[{required:!0,message:"请输入建造负责人！"}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"建造负责人电话"},t.getFieldDecorator("builderTel",{rules:[{required:!0,validator:ne.j}]})(W.a.createElement(J.a,{placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"建造时间"},t.getFieldDecorator("time",{rules:[{required:!0,message:"请选择建造时间！"}]})(W.a.createElement(la,{style:{width:"100%"}})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"进城方向名称"},t.getFieldDecorator("forwardDirection",{})(W.a.createElement(J.a,{placeholder:"进城方向"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"出城方向名称"},t.getFieldDecorator("reverseDirection",{})(W.a.createElement(J.a,{placeholder:"出城方向"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"状态"},t.getFieldDecorator("status",{initialValue:"1",rules:[{required:!0,message:"请选择状态"}]})(W.a.createElement(z.a.Group,{style:{width:"100%"}},ra.map(function(e,a){return W.a.createElement(z.a,{key:e,value:"".concat(a)},e)}))))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"视频延时时间"},t.getFieldDecorator("videoTime",{rules:[{required:!0,message:"请输入视频延时时间"}]})(W.a.createElement(H.a,{placeholder:"时间可为负数",style:{width:"100%"}})))),"2"===r&&W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"流媒体通道号"},t.getFieldDecorator("mediaNo")(W.a.createElement(H.a,{placeholder:"请输入",style:{width:"100%"},min:0}))))),W.a.createElement(Y.a,{gutter:40},W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"站点图片"},t.getFieldDecorator("siteImg",{})(W.a.createElement(B.a,j()({multiple:!0},o),W.a.createElement(A.a,null,W.a.createElement(R.a,{type:"upload"})," 上传站点图片"))))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"下次检定时间"},t.getFieldDecorator("verificationDate",{rules:[{required:!0,message:"请选择下次检定时间"}]})(W.a.createElement(K.a,{style:{width:"100%"}})))))))}),sa=X.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleUpdate,n=e.handleModalVisible,r=e.detail,i=e.siteType,d=e.treeList,s=e.siteTypeChange,o=e.loading,c=Object(ne.c)(na[2]),m=c?{footer:[W.a.createElement(A.a,{key:"back",onClick:function(){return n()}},"取消"),W.a.createElement(A.a,{key:"submit",type:"primary",loading:o,onClick:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})}},"确定")]}:{footer:null},u=c?{}:{border:0,color:"rgba(0,0,0,.7)"},p=W.a.createElement(Z.Fragment,null,W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"最小速度(km)"},t.getFieldDecorator("lowSpeed",{initialValue:r.lowSpeed})(W.a.createElement(H.a,{disabled:!c,style:O()({width:"100%"},u),placeholder:"请输入",min:0})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"最高速度(km)"},t.getFieldDecorator("highSpeed",{initialValue:r.highSpeed})(W.a.createElement(H.a,{disabled:!c,style:O()({width:"100%"},u),placeholder:"请输入",min:0})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"超载预警(%)"},t.getFieldDecorator("warningLoadRate",{initialValue:r.warningLoadRate})(W.a.createElement(H.a,{disabled:!c,style:O()({width:"100%"},u),placeholder:"请输入",min:0})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"超速预警(%)"},t.getFieldDecorator("warningSpeedRate",{initialValue:r.warningSpeedRate})(W.a.createElement(H.a,{disabled:!c,style:O()({width:"100%"},u),placeholder:"请输入",min:0})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"执法方式"},t.getFieldDecorator("lawEnforceType",{initialValue:r.lawEnforceType,rules:[{required:!0,message:"请选择执法方式!"}]})(W.a.createElement(_.a,{disabled:!c,style:O()({width:"100%"},u),placeholder:"请选择"},W.a.createElement(_.a.Option,{value:1},"动态执法"),W.a.createElement(_.a.Option,{value:2},"动静结合执法")))))),h={name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture",accept:".jpg,.jpeg,.png",defaultFileList:r.siteImg?r.siteImg.split(",").map(function(e,a){return{uid:a,name:e,status:"done",url:ne.E+e,thumbUrl:ne.E+e,filePath:e}}):[],data:{type:2,xbType:""},headers:{Authorization:"Bearer ".concat(Object(ne.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},onChange:function(e){e.file.status,"done"===e.file.status?200===e.file.response.code?Q.a.success("".concat(e.file.name," 图片上传成功")):Q.a.error("".concat(e.file.name," 上传失败")):"error"===e.file.status&&Q.a.error("".concat(e.file.name," 上传失败"))}};return W.a.createElement(x.a,j()({destroyOnClose:!0,title:c?"更新站点":"站点详情",visible:a,className:me.a.formModal,onCancel:function(){return n()},width:"900px"},m),W.a.createElement("div",{className:me.a.formModalBody},W.a.createElement(Y.a,{gutter:40},W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:c,label:"站点类型"},t.getFieldDecorator("siteType",{initialValue:i,rules:[{required:!0,message:"请选择站点类型！"}]})(W.a.createElement(_.a,{disabled:!c,style:O()({width:"100%"},u),placeholder:"请选择",onChange:s},W.a.createElement(ta,{value:"1"},"动态检测站"),W.a.createElement(ta,{value:"2"},"静态检测站"))))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:c,label:"站点号"},t.getFieldDecorator("siteCode",{initialValue:r.siteCode,rules:[{required:!0,message:"请输入站点号！"}]})(W.a.createElement(J.a,{disabled:!0,style:u})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:c,label:"站点名称"},t.getFieldDecorator("siteName",{initialValue:r.siteName,rules:[{required:!0,message:"请输入站点名称！"}]})(W.a.createElement(J.a,{disabled:!c,style:u,placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:c,label:"区域"},t.getFieldDecorator("organId",{initialValue:r.organId,rules:[{required:!0,message:"请选择区域！"}]})(W.a.createElement(P.a,{disabled:!c,treeData:d,style:O()({width:"100%"},u),placeholder:"请选择"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:c,label:"地址"},t.getFieldDecorator("address",{initialValue:r.address,rules:[{required:!0,message:"请输入地址！"}]})(W.a.createElement(J.a,{disabled:!c,style:u,placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"经度"},t.getFieldDecorator("longitude",{initialValue:r.longitude,rules:[{required:!0,validator:ne.i}]})(W.a.createElement(H.a,{disabled:!c,style:O()({width:"100%"},u),placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"纬度"},t.getFieldDecorator("latitude",{initialValue:r.latitude,rules:[{required:!0,validator:ne.f}]})(W.a.createElement(H.a,{disabled:!c,style:O()({width:"100%"},u),placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"设备编号"},t.getFieldDecorator("equipmentNum",{initialValue:r.equipmentNum})(W.a.createElement(J.a,{disabled:!c,style:u,placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"站点IP"},t.getFieldDecorator("siteIP",{initialValue:r.siteIP})(W.a.createElement(J.a,{disabled:!c,style:u,placeholder:"请输入"})))),"1"===i?p:null,W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:c,label:"站点负责人"},t.getFieldDecorator("siteReponsible",{initialValue:r.siteReponsible,rules:[{required:!0,message:"请输入站点负责人！"}]})(W.a.createElement(J.a,{disabled:!c,style:u,placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:c,label:"电话"},t.getFieldDecorator("reponsibleTel",{initialValue:r.reponsibleTel,rules:[{required:!0,validator:ne.j}]})(W.a.createElement(J.a,{disabled:!c,style:u,placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:c,label:"建造公司"},t.getFieldDecorator("builderCompany",{initialValue:r.builderCompany,rules:[{required:!0,message:"请输入建造公司！"}]})(W.a.createElement(J.a,{disabled:!c,style:u,placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:c,label:"建造负责人"},t.getFieldDecorator("builderReponsible",{initialValue:r.builderReponsible,rules:[{required:!0,message:"请输入建造负责人！"}]})(W.a.createElement(J.a,{disabled:!c,style:u,placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:c,label:"建造负责人电话"},t.getFieldDecorator("builderTel",{initialValue:r.builderTel,rules:[{required:!0,validator:ne.j}]})(W.a.createElement(J.a,{disabled:!c,style:u,placeholder:"请输入"})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:c,label:"建造时间"},t.getFieldDecorator("time",{initialValue:[ae()(new Date(r.builderDate),"YYYY-MM-DD"),ae()(new Date(r.completeDate),"YYYY-MM-DD")],rules:[{required:!0,message:"请选择建造时间！"}]})(W.a.createElement(la,{disabled:!c,format:"YYYY-MM-DD",style:O()({},u,{width:"100%"})})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"进城方向名称"},t.getFieldDecorator("forwardDirection",{initialValue:r.forwardDirection})(W.a.createElement(J.a,{disabled:!c,style:u})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"出城方向名称"},t.getFieldDecorator("reverseDirection",{initialValue:r.reverseDirection})(W.a.createElement(J.a,{disabled:!c,style:u})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"状态"},t.getFieldDecorator("status",{initialValue:r.status})(W.a.createElement(z.a.Group,{disabled:!c,style:O()({width:"100%"},u)},ra.map(function(e,a){return W.a.createElement(z.a,{key:e,value:"".concat(a)},e)}))))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"视频延时时间"},t.getFieldDecorator("videoTime",{initialValue:r.videoTime,rules:[{required:!0,message:"请输入视频延时时间"}]})(W.a.createElement(H.a,{disabled:!c,placeholder:"时间可为负数",style:O()({width:"100%"},u)})))),"2"===i&&W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{hasFeedback:!0,label:"流媒体通道号"},t.getFieldDecorator("mediaNo",{initialValue:r.mediaNo})(W.a.createElement(H.a,{disabled:!c,placeholder:"请输入",style:O()({width:"100%"},u),min:0})))),W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"下次检定时间"},t.getFieldDecorator("verificationDate",{initialValue:ae()(new Date(r.verificationDate),"YYYY-MM-DD HH:mm:ss"),rules:[{required:!0,message:"请选择下次检定时间"}]})(W.a.createElement(K.a,{disabled:!c,style:O()({width:"100%"},u)}))))),W.a.createElement(Y.a,{gutter:40},W.a.createElement(G.a,{md:12,sm:24},W.a.createElement(aa,{label:"站点图片"},t.getFieldDecorator("siteImg",{initialValue:r.siteImg})(W.a.createElement(B.a,j()({multiple:!0},h),c?W.a.createElement(A.a,null,W.a.createElement(R.a,{type:"upload"})," 上传站点图片"):null)))))))}),oa=Object($.connect)(function(e){var a=e.system,t=e.Site,l=e.loading;return{system:a,Site:t,currentUser:e.user.currentUser,loading:l.models.Site,systemLoading:l.models.system}})(He=X.a.create()(He=function(e){function a(){var e,t;k()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return(t=C()(this,(e=I()(a)).call.apply(e,[this].concat(n)))).state={fsVisible:!1,modalVisible:!1,modiaVisible:!1,dbVisible:!1,updateModalVisible:!1,unloadYardVisible:!1,sysSiteBuildVisible:!1,siteType:"1",siteID:0,siteCode:"",siteName:"",selectedKeys:[],formValues:[],expandCheckKeys:[],treeFormValue:{},detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"站点号",dataIndex:"siteCode"},{title:"站点名称",dataIndex:"siteName",render:function(e){return e.length>12?W.a.createElement(V.a,{title:e},"".concat(e.substring(0,12),"...")):e}},{title:"站点负责人",dataIndex:"siteReponsible"},{title:"站点类型",dataIndex:"siteType",render:function(e){return"1"===e?"动态检测站点":"静态检测站"}},{title:"地址",dataIndex:"address",render:function(e){return e.length>12?W.a.createElement(V.a,{title:e},"".concat(e.substring(0,12),"...")):e}},{title:"状态",dataIndex:"status",render:function(e){return W.a.createElement(F.a,{color:ia[e]},ra[e])}},{title:"操作",width:210,render:function(e,a){return W.a.createElement(W.a.Fragment,null,Object(ne.c)(na[2])?W.a.createElement(V.a,{placement:"left",title:"设置"},W.a.createElement(A.a,{onClick:function(){return t.showUpdateModal(a.siteCode)},type:"primary",shape:"circle",icon:"setting",size:"small"})):W.a.createElement(V.a,{placement:"left",title:"详情"},W.a.createElement(A.a,{onClick:function(){return t.showUpdateModal(a.siteCode)},type:"primary",shape:"circle",icon:"eye",size:"small"})),W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(V.a,{placement:"left",title:"配置车道"},W.a.createElement(A.a,{onClick:function(){return t.showFsModal(a.siteCode)},type:"primary",shape:"circle",icon:"ordered-list",size:"small"})),"2"===a.siteType?Object(ne.c)(na[5])&&W.a.createElement(W.a.Fragment,null,W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(V.a,{placement:"left",title:"卸货场景"},W.a.createElement(A.a,{onClick:function(){return t.showUnloadYardModal(a.id)},type:"primary",shape:"circle",icon:"gold",size:"small"}))):W.a.createElement(W.a.Fragment,null,W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(V.a,{placement:"left",title:"数据源"},W.a.createElement(A.a,{onClick:function(){t.setState({siteCode:a.siteCode},function(){return t.handleDBVisible(!0)})},type:"primary",shape:"circle",icon:"database",size:"small"})),Object(ne.c)(na[4])&&W.a.createElement(W.a.Fragment,null,W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(V.a,{placement:"left",title:"站点建设详情"},W.a.createElement(A.a,{onClick:function(){return t.showSysSiteBuildModal(a.siteCode)},type:"primary",shape:"circle",icon:"file-search",size:"small"}))),Object(ne.c)(na[6])?W.a.createElement(W.a.Fragment,null,W.a.createElement(v.a,{type:"vertical"}),W.a.createElement(V.a,{placement:"left",title:"流媒体通道"},W.a.createElement(A.a,{onClick:function(){return t.showModiaModal(a)},type:"primary",shape:"circle",icon:"video-camera",size:"small"}))):null))}}],t.showModiaModal=function(e){t.setState({siteCode:e.siteCode,siteName:e.siteName},function(){t.handModiaVisible(!0)})},t.showUnloadYardModal=function(e){t.setState({siteID:e},function(){t.handleUnloadYardVisible(!0)})},t.showSysSiteBuildModal=function(e){t.setState({siteCode:e},function(){t.handleSysSiteBuildVisible(!0)})},t.siteTypeChange=function(e){t.setState({siteType:e})},t.getDetail=function(e,a){(0,t.props.dispatch)({type:"Site/detail",payload:{siteCode:e},callback:function(e){return a(e)}})},t.showUpdateModal=function(e){t.getDetail(e,function(e){t.setState({siteType:e.siteType,detail:e}),t.handleUpdateModalVisible(!0)})},t.showFsModal=function(e){t.getDetail(e,function(e){t.setState({detail:e},function(){return t.handleFsVisible(!0)})})},t.getList=function(e){(0,t.props.dispatch)({type:"Site/fetch",payload:e})},t.handleStandardTableChange=function(e){var a=t.props.currentUser,l=t.state,n=l.formValues,r=l.treeFormValue,i=[];"{}"!==JSON.stringify(r)?i.push(r):i.unshift({property:"organId",value:a.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),t.getList({pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:i.concat(n)})},t.handleFormReset=function(){var e=t.props,a=e.form,l=e.currentUser,n=t.state.pageBean;a.resetFields(),t.setState({formValues:[],treeFormValue:{},selectedKeys:[]}),t.getList({pageBean:n,querys:[{property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}]})},t.handleSearch=function(e){e.preventDefault();var a=t.props,l=a.form,n=a.currentUser,r=t.state,i=r.treeFormValue,d=r.pageBean;l.validateFields(function(e,a){if(!e){var l=O()({},a),r=Object.keys(l).map(function(e){return l[e]?{property:e,value:l[e],group:"main",operation:"static"===e?"EQUAL":"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:JSON.parse(JSON.stringify(r))}),"{}"!==JSON.stringify(i)?r.push(i):r.push({group:"main",operation:"RIGHT_LIKE",property:"organId",relation:"AND",value:n.organId}),t.getList({pageBean:d,querys:r})}})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e})},t.handleFsVisible=function(e){t.setState({fsVisible:!!e}),e||t.setState({detail:{}})},t.handModiaVisible=function(e){t.setState({modiaVisible:!!e}),e||t.setState({siteCode:""})},t.handleDBVisible=function(e){t.setState({dbVisible:!!e})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({siteType:"1",detail:{}})},t.handleSysSiteBuildVisible=function(e){t.setState({sysSiteBuildVisible:!!e}),e||t.setState({siteCode:""})},t.handleUnloadYardVisible=function(e){t.setState({unloadYardVisible:!!e}),e||t.setState({siteID:0})},t.handleAdd=function(e,a){var l=t.props,n=l.dispatch,r=l.currentUser,i=t.state,d=i.pageBean,s=i.formValues,o=i.treeFormValue,c=O()({},e);c.builderDate=e.time[0].format(),c.completeDate=e.time[1].format(),c.verificationDate=e.verificationDate.format("YYYY-MM-DD"),c.forwardDirection=e.forwardDirection||"进城方向",c.reverseDirection=e.reverseDirection||"出城方向",delete c.time,c.siteImg&&(c.siteImg=e.siteImg.fileList.map(function(e){return e.response.filePath}).join()),"2"===c.siteType&&delete c.lawEnforceType,n({type:"Site/add",payload:c,callback:function(){Q.a.success("添加成功"),t.handleModalVisible();var e=Object.assign([],s);"{}"!==JSON.stringify(o)?e.push(o):e.push({group:"main",operation:"RIGHT_LIKE",property:"organId",relation:"AND",value:r.organId}),t.getList({pageBean:d,querys:e}),a()}})},t.handleUpdate=function(e,a){var l=t.props,n=l.dispatch,r=l.currentUser,i=t.state,d=i.pageBean,s=i.detail,o=i.formValues,c=i.treeFormValue,m=O()({},e);m.builderDate=e.time[0].format(),m.completeDate=e.time[1].format(),m.verificationDate=e.verificationDate.format("YYYY-MM-DD"),m.forwardDirection=e.forwardDirection||"进城方向",m.reverseDirection=e.reverseDirection||"出城方向",delete m.time;for(var u=JSON.parse(JSON.stringify(s)),p=Object.keys(m),h=0;h<p.length;h+=1)u[p[h]]=m[p[h]];"object"==typeof u.siteImg&&(u.siteImg=u.siteImg.fileList.map(function(e){return e.response?e.response.filePath:e.filePath}).join()),t.setState({detail:u}),n({type:"Site/update",payload:u,callback:function(){Q.a.success("更新成功"),t.handleUpdateModalVisible(),a&&a();var e=Object.assign([],o);"{}"!==JSON.stringify(c)?e.push(c):e.push({group:"main",operation:"RIGHT_LIKE",property:"organId",relation:"AND",value:r.organId}),t.getList({pageBean:d,querys:e})}})},t.onSelect=function(e){if(e[0]){t.setState({selectedKeys:e});var a=t.state,l=a.formValues,n=a.pageBean,r=[],i={property:"organId",value:e[0],group:"main",operation:"RIGHT_LIKE",relation:"AND"};t.setState({treeFormValue:i}),r.push(i),r=r.concat(l),t.getList({pageBean:n,querys:r})}},t.expandCheck=function(e){t.setState({expandCheckKeys:e})},t.renderTreeNodes=function(e){return e.map(function(e){return e.children?W.a.createElement(y.a.TreeNode,{title:e.title,key:e.key,dataRef:e},t.renderTreeNodes(e.children)):W.a.createElement(y.a.TreeNode,e)})},t}return L()(a,e),S()(a,[{key:"componentDidMount",value:function(){if(Object(ne.c)(na[0])){var e=this.state.pageBean,a=localStorage.getItem("organId");this.getList({pageBean:e,querys:[{property:"organId",value:a,group:"main",operation:"RIGHT_LIKE",relation:"AND"}]})}}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return W.a.createElement(X.a,{onSubmit:this.handleSearch,layout:"inline"},W.a.createElement(Y.a,{gutter:{md:8,lg:16,xl:16}},W.a.createElement(G.a,{md:5,sm:24},W.a.createElement(aa,null,e("siteCode")(W.a.createElement(J.a,{addonBefore:"站点号",placeholder:"请输入"})))),W.a.createElement(G.a,{md:5,sm:24},W.a.createElement(aa,null,e("siteName")(W.a.createElement(J.a,{addonBefore:"站点名称",placeholder:"请输入"})))),W.a.createElement(G.a,{md:5,sm:24},W.a.createElement("div",{className:ea.a.inputMain},W.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"站点类型"),W.a.createElement(aa,{style:{flex:1}},e("siteType")(W.a.createElement(_.a,{placeholder:"请选择",className:ea.a.inputGroupLeftRadius},W.a.createElement(ta,{value:"1"},"非现场站点"),W.a.createElement(ta,{value:"2"},"精简站")))))),W.a.createElement(G.a,{md:5,sm:24},W.a.createElement(aa,null,e("status")(W.a.createElement(z.a.Group,null,ra.map(function(e,a){return W.a.createElement(z.a,{key:a,value:"".concat(a)},e)}))))),W.a.createElement(G.a,{md:4,sm:24},W.a.createElement("span",{className:de.a.submitButtons,style:{float:"right"}},W.a.createElement(A.a,{type:"primary",htmlType:"submit"},"查询"),W.a.createElement(A.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.system.treeList,l=a.Site.data,n=a.loading,r=a.systemLoading,i=this.state,d=i.detail,s=i.modalVisible,o=i.updateModalVisible,c=i.modiaVisible,m=i.siteType,u=i.expandCheckKeys,p=i.selectedKeys,h=i.unloadYardVisible,b=i.siteID,E=i.siteCode,v=i.siteName,F=i.fsVisible,V=i.sysSiteBuildVisible,D=i.dbVisible,k={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible,siteType:m,treeList:t,siteTypeChange:this.siteTypeChange},w={handleUpdate:this.handleUpdate,handleModalVisible:this.handleUpdateModalVisible,siteTypeChange:this.siteTypeChange,detail:d,siteType:m,treeList:t,loading:n},S={siteID:b,handleModalVisible:this.handleUnloadYardVisible},M={siteCode:E,siteName:v,handleModalVisible:this.handModiaVisible},C={siteCode:E,handleModalVisible:this.handleSysSiteBuildVisible},N={loading:n,size:"middle",data:l,tableAlert:!1,columns:this.columns,onChange:this.handleStandardTableChange};return W.a.createElement(Z.Fragment,null,Object(ne.c)(na[0])?null:W.a.createElement(le.a,{to:"/exception/403"}),W.a.createElement("div",{className:de.a.tableMain},W.a.createElement(g.a,{spinning:r},W.a.createElement("div",{className:de.a.treeLeft},W.a.createElement(y.a,{selectedKeys:p,showLine:!0,onSelect:this.onSelect,expandedKeys:u[0]?u:[t[0]?t[0].key:""],onExpand:this.expandCheck},this.renderTreeNodes(t)))),W.a.createElement("div",{className:de.a.rightTable},W.a.createElement(f.a,{bordered:!1,style:{height:"100%"}},W.a.createElement("div",{className:de.a.tableList},W.a.createElement("div",{className:de.a.tableListForm},this.renderSimpleForm()),W.a.createElement("div",{className:de.a.tableListOperator},Object(ne.c)(na[1])?W.a.createElement(A.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"):null),W.a.createElement(te.a,j()({selectedRows:0,rowSelection:null},N)))))),W.a.createElement(da,j()({},k,{modalVisible:s})),o&&"{}"!==JSON.stringify(d)?W.a.createElement(sa,j()({},w,{modalVisible:o})):null,h&&b?W.a.createElement(Ve,j()({},S,{modalVisible:h})):null,V&&E?W.a.createElement(we,j()({},C,{modalVisible:V})):null,c&&E?W.a.createElement(Te,j()({},M,{modalVisible:c})):null,F&&Object.keys(d).length&&W.a.createElement(Ne,{data:d,modalVisible:F,handleModalVisible:this.handleFsVisible}),D&&W.a.createElement(We,{siteCode:E,modalVisible:D,handleModalVisible:this.handleDBVisible}))}}]),a}(Z.PureComponent))||He)||He;a.default=oa}}]);