(window.webpackJsonp=window.webpackJsonp||[]).push([[105],{"7FQj":function(e,a,t){"use strict";t.r(a);var n,l=t("pVnL"),i=t.n(l),r=(t("IzEo"),t("bx4M")),o=(t("miYZ"),t("tsqr")),s=(t("P2fV"),t("NJEC")),d=(t("/zsF"),t("PArb")),m=(t("5Dmo"),t("3S7+")),c=t("lwsE"),u=t.n(c),p=t("W8MJ"),g=t.n(p),h=t("a1gu"),E=t.n(h),f=t("Nsbk"),b=t.n(f),y=t("7W2i"),V=t.n(y),N=(t("2qtc"),t("kLXV")),M=(t("14J3"),t("BMrR")),C=(t("giR+"),t("fyUT")),k=(t("nRaC"),t("5RzL")),S=(t("jCWc"),t("kPKH")),v=(t("5NDa"),t("5rEg")),D=(t("+L6B"),t("2/Rp")),w=(t("y8nQ"),t("Vl3Y")),F=t("q1tI"),L=t.n(F),P=t("MuoO"),B=t("CkN6"),A=t("1TjV"),q=t("9zHi"),x=t.n(q),I=t("ZP6J"),O=t.n(I),z=t("z1x1"),H=t("ns75"),U=t.n(H),j=w.a.Item,R=w.a.create()(function(e){var a=e.modalVisible,t=e.form,n=e.handleAdd,l=e.handleModalVisible,i=e.treeList,r=e.parentAddress,o=e.treeSelectChange,s=e.handleMonitorVisible,d=e.minitors,m=e.loading,c=function(){t.validateFields(function(e,a){e||n(a,function(){return t.resetFields()})})};return L.a.createElement(N.a,{destroyOnClose:!0,title:"添加点位",className:O.a.formModal,visible:a,onOk:c,width:700,onCancel:function(){return l()},footer:[L.a.createElement(D.a,{key:"back",onClick:function(){return l()}},"取消"),L.a.createElement(D.a,{key:"submit",type:"primary",loading:m,onClick:c},"确定")]},L.a.createElement("div",{className:O.a.formModalBody},L.a.createElement(M.a,{gutter:40},L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"点位编号"},t.getFieldDecorator("ponitCode",{rules:[{required:!0,message:"请输入点位编号！"}]})(L.a.createElement(v.a,{placeholder:"请输入"})))),L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"点位名称"},t.getFieldDecorator("ponitName",{rules:[{required:!0,message:"请输入点位名称！"}]})(L.a.createElement(v.a,{placeholder:"请输入"})))),L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"行政区域"},t.getFieldDecorator("organCode",{rules:[{required:!0,message:"请选择行政区域！"}]})(L.a.createElement(k.a,{treeData:i,style:{width:"100%"},placeholder:"请选择",onChange:o})))),L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"保障水位(m)"},t.getFieldDecorator("normalHigh",{rules:[{required:!0,message:"请输入正常水位！"}]})(L.a.createElement(C.a,{style:{width:"100%"},placeholder:"请输入"})))),L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"预警水位(m)"},t.getFieldDecorator("warningHigh",{rules:[{required:!0,message:"请输入预警水位高度！"}]})(L.a.createElement(C.a,{style:{width:"100%"},placeholder:"请输入"})))),L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"监控点位"},t.getFieldDecorator("mediaNo",{initialValue:d.minitorPointName,rules:[{required:!0,message:"请选择监控点位！"}]})(L.a.createElement(v.a,{placeholder:"请选择",readOnly:!0,onClick:function(){return s(!0)}})))),L.a.createElement(S.a,{md:24,sm:24},L.a.createElement(z.a,{parentAddress:r})))))}),T=w.a.create()(function(e){var a=e.modalVisible,t=e.form,n=e.handleUpdate,l=e.handleModalVisible,i=e.treeList,r=e.parentAddress,o=e.treeSelectChange,s=e.detail,d=e.lnglat,m=e.handleMonitorVisible,c=e.minitors,u=e.loading,p=function(){t.validateFields(function(e,a){e||n(a,function(){return t.resetFields()})})};return L.a.createElement(N.a,{destroyOnClose:!0,title:"编辑点位",className:O.a.formModal,visible:a,onOk:p,width:700,onCancel:function(){return l()},footer:[L.a.createElement(D.a,{key:"back",onClick:function(){return l()}},"取消"),L.a.createElement(D.a,{key:"submit",type:"primary",loading:u,onClick:p},"确定")]},L.a.createElement("div",{className:O.a.formModalBody},L.a.createElement(M.a,{gutter:40},L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"点位编号"},t.getFieldDecorator("ponitCode",{initialValue:s.ponitCode,rules:[{required:!0,message:"请输入点位编号！"}]})(L.a.createElement(v.a,{placeholder:"请输入"})))),L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"点位名称"},t.getFieldDecorator("ponitName",{initialValue:s.ponitName,rules:[{required:!0,message:"请输入点位名称！"}]})(L.a.createElement(v.a,{placeholder:"请输入"})))),L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"行政区域"},t.getFieldDecorator("organCode",{initialValue:s.organCode,rules:[{required:!0,message:"请选择行政区域！"}]})(L.a.createElement(k.a,{treeData:i,style:{width:"100%"},placeholder:"请选择",onChange:o})))),L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"保障水位(m)"},t.getFieldDecorator("normalHigh",{initialValue:s.normalHigh,rules:[{required:!0,message:"请输入正常水位！"}]})(L.a.createElement(C.a,{style:{width:"100%"},placeholder:"请输入"})))),L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"预警水位(m)"},t.getFieldDecorator("warningHigh",{initialValue:s.warningHigh,rules:[{required:!0,message:"请输入预警水位高度！"}]})(L.a.createElement(C.a,{style:{width:"100%"},placeholder:"请输入"})))),L.a.createElement(S.a,{md:12,sm:24},L.a.createElement(j,{label:"监控点位"},t.getFieldDecorator("mediaNo",{initialValue:c.minitorPointName,rules:[{required:!0,message:"请选择监控点位！"}]})(L.a.createElement(v.a,{placeholder:"请选择",readOnly:!0,onClick:function(){return m(!0)}})))),L.a.createElement(S.a,{md:24,sm:24},L.a.createElement(z.a,{lngLat:{longitude:d[0],latitude:d[1]},address:s.addr,parentAddress:r})))))}),J=Object(P.connect)(function(e){return{system:e.system,MaritimePoint:e.MaritimePoint,loading:e.loading.models.MaritimePoint}})(n=w.a.create()(n=function(e){function a(){var e,t;u()(this,a);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(t=E()(this,(e=b()(a)).call.apply(e,[this].concat(l)))).state={monitorVisible:!1,modalVisible:!1,updateModalVisible:!1,formValues:[],address:"",lnglat:[],organName:"",detail:{},minitors:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"点位编号",dataIndex:"ponitCode"},{title:"点位名称",dataIndex:"ponitName"},{title:"监测地址",dataIndex:"addr"},{title:"保障水位(m)",dataIndex:"normalHigh"},{title:"预警水位(m)",dataIndex:"warningHigh"},{title:"行政区域",dataIndex:"organName"},{title:"操作",width:100,render:function(e,a){return L.a.createElement(F.Fragment,null,L.a.createElement(m.a,{placement:"left",title:"编辑"},L.a.createElement(D.a,{onClick:function(){return t.editData(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),L.a.createElement(d.a,{type:"vertical"}),L.a.createElement(s.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id_)},okText:"确定",cancelText:"取消"},L.a.createElement(m.a,{placement:"left",title:"删除"},L.a.createElement(D.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.getList=function(e){(0,t.props.dispatch)({type:"MaritimePoint/fetch",payload:e})},t.dataDel=function(e){(0,t.props.dispatch)({type:"MaritimePoint/remove",payload:{id:e},callback:function(){o.a.success("删除成功"),t.getList({pageBean:t.state.pageBean})}})},t.editData=function(e){var a=e.mediaNo?e.mediaNo.split("_"):[];t.setState({detail:e,minitors:{minitorPointID:a[1],minitorPointName:a[0]},address:e.addr,organName:e.organName,lnglat:e.longitudeandlatitude?e.longitudeandlatitude.split(","):[0,0]},function(){return t.handleUpdateModalVisible(!0)})},t.parentAddress=function(e,a){t.setState({address:e,lnglat:a})},t.selectData=function(e){t.setState({minitors:{minitorPointID:e.id_,minitorPointName:e.pointName}})},t.handleStandardTableChange=function(e){var a=t.state.formValues,n={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:a};t.getList(n)},t.handleFormReset=function(){t.props.form.resetFields(),t.setState({formValues:[]}),t.getList({pageBean:t.state.pageBean})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var n=t.state.pageBean,l={addr:a.address,organCode:a.code},i=Object.keys(l).map(function(e){return l[e]?{property:e,value:l[e],group:"main",operation:"organCode"===e?"EQUAL":"LIKE",relation:"AND"}:""}).filter(function(e){return e});t.setState({formValues:i}),t.getList({pageBean:n,querys:i})}})},t.handleMonitorVisible=function(e){t.setState({monitorVisible:!!e})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e}),e||t.setState({minitors:{}})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{},minitors:{}})},t.handleAdd=function(e){var a=t.props.dispatch,n=t.state,l=n.address,i=n.lnglat,r=n.pageBean,s=n.organName,d=n.minitors;e.addr=l,e.longitudeandlatitude=i.join(),e.organName=s,e.mediaNo="".concat(d.minitorPointName,"_").concat(d.minitorPointID),a({type:"MaritimePoint/add",payload:e,callback:function(){o.a.success("添加成功"),t.handleModalVisible(),t.getList({pageBean:r})}})},t.treeSelectChange=function(e,a){t.setState({organName:a[0]})},t.handleUpdate=function(e){var a=t.props.dispatch,n=t.state,l=n.address,i=n.lnglat,r=n.pageBean,s=n.organName,d=n.detail,m=n.minitors,c=JSON.parse(JSON.stringify(d));e.addr=l,e.longitudeandlatitude=i.join(),e.organName=s,e.mediaNo="".concat(m.minitorPointName,"_").concat(m.minitorPointID);for(var u=Object.keys(e),p=0;p<u.length;p+=1)c[u[p]]=e[u[p]];t.setState({detail:c}),a({type:"MaritimePoint/update",payload:c,callback:function(){o.a.success("编辑成功"),t.handleUpdateModalVisible(),t.getList({pageBean:r})}})},t}return V()(a,e),g()(a,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props,a=e.form.getFieldDecorator,t=e.system.treeList;return L.a.createElement(w.a,{onSubmit:this.handleSearch,layout:"inline"},L.a.createElement(M.a,{gutter:{md:8,lg:16,xl:16}},L.a.createElement(S.a,{md:6,sm:24},L.a.createElement(j,null,a("address")(L.a.createElement(v.a,{addonBefore:"地址",placeholder:"请输入"})))),L.a.createElement(S.a,{md:6,sm:24},L.a.createElement("div",{className:U.a.inputMain},L.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"区域"),L.a.createElement(j,{style:{flex:1}},a("code")(L.a.createElement(k.a,{className:U.a.inputGroupLeftRadius,treeData:t,style:{width:"100%"},placeholder:"请选择"}))))),L.a.createElement(S.a,{md:6,sm:24},L.a.createElement("span",{className:x.a.submitButtons},L.a.createElement(D.a,{type:"primary",htmlType:"submit"},"查询"),L.a.createElement(D.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.MaritimePoint.data,n=a.system.treeList,l=a.loading,o=this.state,s=o.monitorVisible,d=o.modalVisible,m=o.updateModalVisible,c=o.detail,u=o.address,p=o.lnglat,g=o.minitors,h={treeList:n,minitors:g,loading:l,treeSelectChange:this.treeSelectChange,parentAddress:this.parentAddress,handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible,handleMonitorVisible:this.handleMonitorVisible},E={treeList:n,detail:c,address:u,lnglat:p,minitors:g,loading:l,treeSelectChange:this.treeSelectChange,parentAddress:this.parentAddress,handleModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate,handleMonitorVisible:this.handleMonitorVisible};return L.a.createElement(F.Fragment,null,L.a.createElement(r.a,{bordered:!1},L.a.createElement("div",{className:x.a.tableList},L.a.createElement("div",{className:x.a.tableListForm},this.renderSimpleForm()),L.a.createElement("div",{className:x.a.tableListOperator},L.a.createElement(D.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建")),L.a.createElement(B.a,{rowKey:"id_",size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:l,data:t,columns:this.columns,onChange:this.handleStandardTableChange}))),d?L.a.createElement(R,i()({},h,{modalVisible:d})):null,m&&Object.keys(c).length?L.a.createElement(T,i()({},E,{modalVisible:m})):null,s?L.a.createElement(A.a,{modalVisible:s,selectData:this.selectData,handleModalVisible:this.handleMonitorVisible}):null)}}]),a}(F.PureComponent))||n)||n;a.default=J}}]);