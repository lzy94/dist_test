(window.webpackJsonp=window.webpackJsonp||[]).push([[208],{yUfB:function(e,t,a){"use strict";a.r(t);var n,r,l,o,i,c,s,d=a("pVnL"),m=a.n(d),u=(a("IzEo"),a("bx4M")),p=(a("14J3"),a("BMrR")),g=(a("jCWc"),a("kPKH")),f=(a("5NDa"),a("5rEg")),h=(a("miYZ"),a("tsqr")),y=(a("2qtc"),a("kLXV")),E=(a("P2fV"),a("NJEC")),b=(a("/zsF"),a("PArb")),v=(a("5Dmo"),a("3S7+")),T=(a("+L6B"),a("2/Rp")),D=a("lwsE"),k=a.n(D),S=a("W8MJ"),C=a.n(S),w=a("a1gu"),V=a.n(w),N=a("Nsbk"),M=a.n(N),O=a("7W2i"),F=a.n(O),B=(a("OaEy"),a("2fM7")),J=(a("y8nQ"),a("Vl3Y")),x=a("q1tI"),L=a.n(x),z=a("MuoO"),I=a("CkN6"),R=(a("g9YV"),a("wCAj")),A=a("MVZn"),P=a.n(A),j=a("ZP6J"),q=a.n(j),U=J.a.Item,K=B.a.Option,H=["文本域","上传控件"],W=Object(z.connect)(function(e){return{TransportDangerCategory:e.TransportDangerCategory,TransportDangerTemplate:e.TransportDangerTemplate,loading:e.loading.models.TransportDangerTemplate}})(n=J.a.create()((l=r=function(e){function t(){var e,a;k()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=V()(this,(e=M()(t)).call.apply(e,[this].concat(r)))).state={content:[]},a.columns=[{title:"内容",dataIndex:"content",width:400,render:function(e){return e.length>20?L.a.createElement(v.a,{title:e},e.substring(0,20),"..."):e}},{title:"填写方式",dataIndex:"control",render:function(e){return H[e-1]}},{title:"操作",width:60,render:function(e){return L.a.createElement(T.a,{type:"danger",shape:"circle",icon:"delete",size:"small",onClick:function(){return a.delData(e.order)}})}}],a.delData=function(e){var t=a.state.content,n=JSON.parse(JSON.stringify(t));n.splice(parseInt(e,10)-1,1);var r=n.map(function(e,t){return P()({},e,{order:t+1})});a.setState({content:r})},a.addData=function(){var e=a.props.form.getFieldsValue(["desc","formType"]);if(!e.desc)return h.a.error("请输入内容！");if(!e.formType)return h.a.error("请选择输入格式！");var t=a.state.content,n=JSON.parse(JSON.stringify(t)),r=n.length+1;return n.push({order:r,content:e.desc,control:e.formType}),a.setState({content:n}),null},a.save=function(){var e=a.props,t=e.dispatch,n=e.form,r=e.modalCallback,l=e.handleModalVisible,o=a.state.content;return o.length?(n.validateFields(function(e,a){if(!e){var n=P()({},a,{content:JSON.stringify(o)});delete n.desc,delete n.formType,t({type:"TransportDangerTemplate/UAData",payload:n,callback:function(){h.a.success("添加成功"),l(),setTimeout(function(){return r()},300)}})}}),null):h.a.error("请添加输入格式可内容！")},a}return F()(t,e),C()(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.form,n=t.modalVisible,r=t.handleModalVisible,l=t.loading,o=t.TransportDangerCategory.data,i=this.state.content;return L.a.createElement(y.a,{destroyOnClose:!0,title:"添加模板",className:q.a.formModal,visible:n,width:800,onCancel:function(){return r()},footer:[L.a.createElement(T.a,{key:"back",onClick:function(){return r()}},"取消"),L.a.createElement(T.a,{key:"submit",type:"primary",loading:l,onClick:function(){return e.save()}},"确定")]},L.a.createElement("div",{className:q.a.formModalBody},L.a.createElement(p.a,{gutter:40},L.a.createElement(g.a,{md:12,sm:24},L.a.createElement(U,{label:"模板名称"},a.getFieldDecorator("name",{rules:[{required:!0,message:"请输入模板名称！"}]})(L.a.createElement(f.a,{placeholder:"请输入"}))),L.a.createElement(U,{label:"内容"},a.getFieldDecorator("desc",{})(L.a.createElement(f.a.TextArea,null)))),L.a.createElement(g.a,{md:12,sm:24},L.a.createElement(U,{label:"模板分类"},a.getFieldDecorator("categoryName",{rules:[{required:!0,message:"请选择模板分类！"}]})(L.a.createElement(B.a,{style:{width:"100%"},placeholder:"请选择"},o.list.map(function(e){return L.a.createElement(K,{key:e.id,value:e.name},e.name)})))),L.a.createElement(U,{label:"输入格式"},L.a.createElement(p.a,{gutter:8},L.a.createElement(g.a,{md:17},a.getFieldDecorator("formType",{})(L.a.createElement(B.a,{style:{width:"100%"},placeholder:"请选择"},H.map(function(e,t){return L.a.createElement(K,{value:t+1,key:t},e)})))),L.a.createElement(g.a,{md:7},L.a.createElement(T.a,{type:"primary",icon:"plus",onClick:this.addData},"添加")))))),L.a.createElement("div",{style:{marginBottom:10,background:"#fff"}},L.a.createElement(R.a,{size:"small",pagination:!1,columns:this.columns,rowKey:"order",dataSource:i}))))}}]),t}(x.PureComponent),r.defaultProps={modalVisible:!1,handleModalVisible:function(){}},n=l))||n)||n,Y=J.a.Item,Z=B.a.Option,Q=["文本域","上传控件"],X=Object(z.connect)(function(e){return{TransportDangerCategory:e.TransportDangerCategory,TransportDangerTemplate:e.TransportDangerTemplate,loading:e.loading.models.TransportDangerTemplate}})(o=J.a.create()((c=i=function(e){function t(){var e,a;k()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=V()(this,(e=M()(t)).call.apply(e,[this].concat(r)))).state={content:[],isSet:!1,detail:{}},a.columns=[{title:"内容",dataIndex:"content",width:400,render:function(e){return e.length>20?L.a.createElement(v.a,{title:e},e.substring(0,20),"..."):e}},{title:"填写方式",dataIndex:"control",render:function(e){return Q[e-1]}},{title:"操作",width:60,render:function(e){return L.a.createElement(T.a,{type:"danger",shape:"circle",icon:"delete",size:"small",onClick:function(){return a.delData(e.order)}})}}],a.delData=function(e){var t=a.state.content,n=JSON.parse(JSON.stringify(t));n.splice(parseInt(e,10)-1,1);var r=n.map(function(e,t){return P()({},e,{order:t+1})});a.setState({content:r})},a.addData=function(){var e=a.props.form.getFieldsValue(["desc","formType"]);if(!e.desc)return h.a.error("请输入内容！");if(!e.formType)return h.a.error("请选择输入格式！");var t=a.state.content,n=JSON.parse(JSON.stringify(t)),r=n.length+1;return n.push({order:r,content:e.desc,control:e.formType}),a.setState({content:n}),null},a.save=function(){var e=a.props,t=e.dispatch,n=e.form,r=e.modalCallback,l=e.handleModalVisible,o=a.state,i=o.content,c=o.detail;return i.length?(n.validateFields(function(e,n){if(!e){var o=P()({},n,{content:JSON.stringify(i)});delete o.desc,delete o.formType;for(var s=JSON.parse(JSON.stringify(c)),d=Object.keys(o),m=0;m<d.length;m+=1)s[d[m]]=o[d[m]];a.setState({detail:s}),t({type:"TransportDangerTemplate/UAData",payload:s,callback:function(){h.a.success("编辑成功"),l(),setTimeout(function(){return r()},300)}})}}),null):h.a.error("请添加输入格式可内容！")},a}return F()(t,e),C()(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.form,n=t.modalVisible,r=t.handleModalVisible,l=t.loading,o=t.TransportDangerCategory.data,i=this.state,c=i.content,s=i.detail;return L.a.createElement(y.a,{destroyOnClose:!0,title:"编辑模板",className:q.a.formModal,visible:n,width:800,onCancel:function(){return r()},footer:[L.a.createElement(T.a,{key:"back",onClick:function(){return r()}},"取消"),L.a.createElement(T.a,{key:"submit",type:"primary",loading:l,onClick:function(){return e.save()}},"确定")]},L.a.createElement("div",{className:q.a.formModalBody},L.a.createElement(p.a,{gutter:40},L.a.createElement(g.a,{md:12,sm:24},L.a.createElement(Y,{label:"模板名称"},a.getFieldDecorator("name",{initialValue:s.name,rules:[{required:!0,message:"请输入模板名称！"}]})(L.a.createElement(f.a,{placeholder:"请输入"}))),L.a.createElement(Y,{label:"内容"},a.getFieldDecorator("desc",{})(L.a.createElement(f.a.TextArea,null)))),L.a.createElement(g.a,{md:12,sm:24},L.a.createElement(Y,{label:"模板分类"},a.getFieldDecorator("categoryName",{initialValue:s.categoryName,rules:[{required:!0,message:"请选择模板分类！"}]})(L.a.createElement(B.a,{style:{width:"100%"},placeholder:"请选择"},o.list.map(function(e){return L.a.createElement(Z,{key:e.id,value:e.name},e.name)})))),L.a.createElement(Y,{label:"输入格式"},L.a.createElement(p.a,{gutter:8},L.a.createElement(g.a,{md:17},a.getFieldDecorator("formType",{})(L.a.createElement(B.a,{style:{width:"100%"},placeholder:"请选择"},Q.map(function(e,t){return L.a.createElement(Z,{value:t+1,key:t},e)})))),L.a.createElement(g.a,{md:7},L.a.createElement(T.a,{type:"primary",icon:"plus",onClick:this.addData},"添加")))))),L.a.createElement("div",{style:{marginBottom:10,background:"#fff"}},L.a.createElement(R.a,{size:"small",pagination:!1,columns:this.columns,rowKey:"order",dataSource:c}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.detail,n=t.isSet;return n?null:{detail:a,isSet:!n,content:JSON.parse(a.content)}}}]),t}(x.PureComponent),i.defaultProps={modalVisible:!1,handleModalVisible:function(){}},o=c))||o)||o,G=a("ns75"),$=a.n(G),_=a("9zHi"),ee=a.n(_),te=J.a.Item,ae=B.a.Option,ne=Object(z.connect)(function(e){return{TransportDangerCategory:e.TransportDangerCategory,TransportDangerTemplate:e.TransportDangerTemplate,loading:e.loading.models.TransportDangerTemplate}})(s=J.a.create()(s=function(e){function t(){var e,a;k()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=V()(this,(e=M()(t)).call.apply(e,[this].concat(r)))).state={modalVisible:!1,updateModalVisible:!1,selectedRows:[],formValues:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},a.columns=[{title:"模板名称",dataIndex:"name"},{title:"模板分类",dataIndex:"categoryName"},{title:"操作",width:90,render:function(e,t){return L.a.createElement(x.Fragment,null,L.a.createElement(v.a,{placement:"left",title:"编辑"},L.a.createElement(T.a,{onClick:function(){return a.showDetailModal(t)},type:"primary",shape:"circle",icon:"edit",size:"small"})),L.a.createElement(b.a,{type:"vertical"}),L.a.createElement(E.a,{title:"是否删除数据?",onConfirm:function(){return a.dataDel(t.id)},okText:"确定",cancelText:"取消"},L.a.createElement(v.a,{placement:"left",title:"删除"},L.a.createElement(T.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],a.getList=function(e){(0,a.props.dispatch)({type:"TransportDangerTemplate/fetch",payload:e})},a.getCategory=function(){(0,a.props.dispatch)({type:"TransportDangerCategory/fetch",payload:{page:1,pageSize:100,showTotal:!0}})},a.showDetailModal=function(e){return a.setState({detail:e},function(){return a.handleUpdateModalVisible(!0)})},a.dataDel=function(e){a.delUtil(e)},a.batchDel=function(){var e=a.state.selectedRows;e.length&&y.a.confirm({title:"提示",content:"是否删除数据？",onOk:function(){var t=e.map(function(e){return e.id});a.delUtil(t.join(),function(){a.setState({selectedRows:[]})})}})},a.delUtil=function(e,t){(0,a.props.dispatch)({type:"TransportDangerTemplate/remove",payload:{ids:e},callback:function(){h.a.success("删除成功");var e=a.state.pageBean;a.getList({pageBean:e}),t&&t()}})},a.handleStandardTableChange=function(e){var t=a.state.formValues,n={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:t};a.getList(n)},a.handleFormReset=function(){var e=a.props.form,t=a.state.pageBean;e.resetFields(),a.setState({formValues:[],selectedRows:[]}),a.getList({pageBean:t})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.handleSearch=function(e){e.preventDefault();var t=a.props.form,n=a.state.pageBean;t.validateFields(function(e,t){if(!e){var r={name:t.templateName,categoryName:t.cate},l=Object.keys(r).map(function(e){return r[e]?{property:e,value:r[e],group:"main",operation:"LIKE",relation:"AND"}:""}).filter(function(e){return e});a.setState({formValues:l}),a.getList({pageBean:n,querys:l})}})},a.handleModalVisible=function(e){a.setState({modalVisible:!!e})},a.handleUpdateModalVisible=function(e){a.setState({updateModalVisible:!!e}),e||a.setState({detail:{}})},a.modalCallback=function(){var e=a.state.pageBean;a.getList({pageBean:e})},a}return F()(t,e),C()(t,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e}),this.getCategory()}},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.TransportDangerCategory.data;return L.a.createElement(J.a,{onSubmit:this.handleSearch,layout:"inline"},L.a.createElement(p.a,{gutter:{md:8,lg:16,xl:16}},L.a.createElement(g.a,{md:6,sm:24},L.a.createElement(te,null,t("templateName")(L.a.createElement(f.a,{addonBefore:"模板名称",placeholder:"请输入"})))),L.a.createElement(g.a,{md:6,sm:24},L.a.createElement("div",{className:$.a.inputMain},L.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"模板分类"),L.a.createElement(te,{style:{flex:1,flexShrink:0}},t("cate")(L.a.createElement(B.a,{placeholder:"请选择",style:{width:"100%"}},a.list.map(function(e){return L.a.createElement(ae,{key:e.id,value:e.name},e.name)})))))),L.a.createElement(g.a,{md:6,sm:24},L.a.createElement("span",{className:ee.a.submitButtons},L.a.createElement(T.a,{type:"primary",htmlType:"submit"},"查询"),L.a.createElement(T.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,t=this.props,a=t.TransportDangerTemplate.data,n=t.loading,r=this.state,l=r.selectedRows,o=r.modalVisible,i=r.updateModalVisible,c=r.detail,s={modalCallback:this.modalCallback,handleModalVisible:this.handleModalVisible},d={detail:c,modalCallback:this.modalCallback,handleModalVisible:this.handleUpdateModalVisible};return L.a.createElement(x.Fragment,null,L.a.createElement(u.a,{bordered:!1},L.a.createElement("div",{className:ee.a.tableList},L.a.createElement("div",{className:ee.a.tableListForm},this.renderSimpleForm()),L.a.createElement("div",{className:ee.a.tableListOperator},L.a.createElement(T.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"),l.length>0&&L.a.createElement(T.a,{type:"danger",onClick:this.batchDel},"批量操作")),L.a.createElement(I.a,{size:"middle",tableAlert:!0,selectedRows:l,loading:n,data:a,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),o&&L.a.createElement(W,m()({},s,{modalVisible:o})),i&&Object.keys(c).length&&L.a.createElement(X,m()({},d,{modalVisible:i})))}}]),t}(x.PureComponent))||s)||s;t.default=ne}}]);