(window.webpackJsonp=window.webpackJsonp||[]).push([[148],{"/U+S":function(e,t,a){"use strict";a.r(t);a("IzEo");var n,i=a("bx4M"),r=a("pVnL"),l=a.n(r),s=(a("14J3"),a("BMrR")),o=(a("iQDF"),a("+eQT")),d=(a("5NDa"),a("5rEg")),c=(a("jCWc"),a("kPKH")),m=(a("nRaC"),a("5RzL")),u=(a("miYZ"),a("tsqr")),p=a("lSNA"),h=a.n(p),f=a("MVZn"),E=a.n(f),g=(a("+L6B"),a("2/Rp")),y=(a("+BJd"),a("mr32")),v=(a("5Dmo"),a("3S7+")),w=a("lwsE"),S=a.n(w),x=a("W8MJ"),L=a.n(x),b=a("a1gu"),N=a.n(b),D=a("Nsbk"),R=a.n(D),V=a("7W2i"),M=a.n(V),I=(a("OaEy"),a("2fM7")),C=(a("y8nQ"),a("Vl3Y")),T=a("q1tI"),k=a.n(T),F=a("MuoO"),H=a("wd/R"),B=a.n(H),Y=a("CkN6"),G=(a("riYV"),a("+n12")),A=a("9zHi"),z=a.n(A),O=a("ns75"),P=a.n(O),J=a("0tLQ"),j=C.a.Item,Q=I.a.Option,U=["未审核","初审通过","复审通过","无效数据","免处罚数据","终审办结（归档）",""],W={pageNo:1,pageSize:10},_={isStatus:0,overLoadFlag:1,isEntry:1},q=Object(F.connect)(function(e){var t=e.TrafficApiV2BusData,a=e.loading,n=e.system,i=e.user;return{Site:e.Site,system:n,currentUser:i.currentUser,TrafficApiV2BusData:t,loading:a.models.TrafficApiV2BusData}})(n=C.a.create()(n=function(e){function t(){var e,a;S()(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=N()(this,(e=R()(t)).call.apply(e,[this].concat(i)))).state={modalVisible:!1,formValues:{},detailID:0,siteList:[]},a.columns=[{title:"检测站",dataIndex:"siteName",width:190,render:function(e){return e.length>12?k.a.createElement(v.a,{title:e},"".concat(e.substring(0,12),"...")):e}},{title:"车牌号码",dataIndex:"carNo"},{title:"检测时间",width:170,dataIndex:"previewTime",render:function(e){return B()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"轴数",dataIndex:"axleNumber"},{title:"限重(t)",dataIndex:"weightLimited",render:function(e){return k.a.createElement(y.a,{color:"#87d068"},(e/1e3).toFixed(2)," ")}},{title:"总重(t)",dataIndex:"totalLoad",render:function(e){return(e/1e3).toFixed(2)}},{title:"超限重(t)",dataIndex:"overLoad",render:function(e){return e>0?k.a.createElement(y.a,{color:"#f5222d"},(e/1e3).toFixed(2)):(e/1e3).toFixed(2)}},{title:"超重比(%)",dataIndex:"overLoadRate",render:function(e){return e?(100*e).toFixed(2):e}},{title:"处理次数",dataIndex:"dealNum"},{title:"状态",dataIndex:"isStatus",render:function(e,t){return 1!==t.isRetrial||e?U[parseInt(e,10)]:"被退回"}},{title:"操作",width:70,render:function(e,t){return k.a.createElement(T.Fragment,null,k.a.createElement(v.a,{placement:"left",title:"审核"},k.a.createElement(g.a,{onClick:function(){return a.showDetailModal(t.id)},type:"primary",shape:"circle",icon:"solution",size:"small"})))}}],a.getSiteList=function(e){(0,a.props.dispatch)({type:"system/userSite",payload:{siteType:1},callback:function(t){if(t.length){var a=t.map(function(e){var t=Object.keys(e);return{code:t[0],name:e[t[0]]}});return e(a)}return e([])}})},a.showDetailModal=function(e){a.setState({detailID:e}),a.handleModalVisible(!0)},a.getList=function(e){(0,a.props.dispatch)({type:"TrafficApiV2BusData/busDynamicDataForPage",payload:E()({},e)})},a.getSiteIN=function(){return{siteCodes:a.state.siteList.map(function(e){return e.code})}},a.handleStandardTableChange=function(e){var t=a.state.formValues,n=E()({page:e.current,pageSize:e.pageSize},t);a.getList(n)},a.handleFormReset=function(){a.props.form.resetFields(),a.getSiteList(function(e){var t=e.map(function(e){return e.code});a.getList(E()({},W,_,{siteCodes:t})),a.setState({formValues:{siteCodes:t},siteList:e})})},a.handleSearch=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){var n="YYYY-MM-DDTHH:mm:ss",i=t.previewTime,r=t.status,l=t.siteCodes,s=i?{startPreviewTime:B()(i[0]).format(n),endPreviewTime:B()(i[1]).format(n)}:{},o={};if(r){var d=r.split("_");o=h()({},d[0],d[1])}if(a.getSiteIN().siteCodes.length){var c=l?[l]:a.getSiteIN().siteCodes,m=E()({},t,s,o,{siteCodes:c});delete m.previewTime,delete m.status,a.setState({formValues:m}),a.getList(E()({},W,_,m))}else u.a.error("当前机构暂无站点")}})},a.handleModalVisible=function(e){a.setState({modalVisible:!!e}),e||a.resetDetail()},a.resetDetail=function(){(0,a.props.dispatch)({type:"TrafficApiV2BusData/resetDetail"})},a.treeSelectChange=function(e){a.props.form.setFieldsValue({siteCodes:void 0}),a.getSite(e)},a.getSite=function(e,t){(0,a.props.dispatch)({type:"Site/siteByUserSite",payload:{organId:e,siteIds:a.state.siteList.map(function(e){return e.code})},callback:function(e){var n=e.map(function(e){return"1"===e.siteType?{code:e.siteCode,name:e.siteName}:""});a.setState({siteList:n}),t&&t(n)}})},a.modalSuccess=function(){u.a.success("操作成功");var e=a.state.formValues;a.getList(E()({},W,_,e))},a}return M()(t,e),L()(t,[{key:"componentDidMount",value:function(){var e=this;this.getSiteList(function(t){var a={siteCodes:t.map(function(e){return e.code})};e.getList(E()({},W,_,a)),e.setState({siteList:t,formValues:a})})}},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.system.treeList,a=e.form.getFieldDecorator,n=this.state.siteList,i=Object(G.w)("organId").toString();return k.a.createElement(C.a,{onSubmit:this.handleSearch,layout:"inline"},k.a.createElement(s.a,{gutter:16},k.a.createElement(c.a,{md:5,sm:24},k.a.createElement("div",{className:P.a.inputMain},k.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"所属机构"),k.a.createElement(j,{style:{flex:1}},a("name")(k.a.createElement(m.a,{className:P.a.inputGroupLeftRadius,treeData:t,treeDefaultExpandedKeys:[i],style:{width:"100%"},placeholder:"请选择",onChange:this.treeSelectChange}))))),k.a.createElement(c.a,{md:4,sm:24},k.a.createElement("div",{className:P.a.inputMain},k.a.createElement("span",{style:{width:"65px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"检测点"),k.a.createElement(j,{style:{flex:1}},a("siteCodes")(k.a.createElement(I.a,{dropdownMatchSelectWidth:!1,className:P.a.inputGroupLeftRadius,placeholder:"请选择"},n.map(function(e){return k.a.createElement(Q,{key:e.code,value:e.code},e.name)})))))),k.a.createElement(c.a,{md:5,sm:24},k.a.createElement(d.a.Group,{compact:!0},k.a.createElement(j,{style:{display:"inline-block",width:"60%"}},a("startOverLoadRate")(k.a.createElement(d.a,{className:"".concat(P.a.inputGroupRightRadius," ").concat(P.a.inputGroupRightborder),addonBefore:"超限幅度(%)",placeholder:"请输入",style:{width:"100%",borderRight:0}}))),k.a.createElement(j,{style:{display:"inline-block",width:"40%"}},a("endOverLoadRate")(k.a.createElement(d.a,{className:P.a.inputGroupRadiusAddon,addonBefore:"至",placeholder:"请输入",style:{width:"100%"}}))))),k.a.createElement(c.a,{md:4,sm:24},k.a.createElement("div",{className:P.a.inputMain},k.a.createElement("span",{style:{width:"60px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"轴数"),k.a.createElement(j,{style:{flex:1}},a("axleNumber")(k.a.createElement(I.a,{className:P.a.inputGroupLeftRadius,placeholder:"请选择"},k.a.createElement(Q,{value:""},"全部轴数"),k.a.createElement(Q,{value:2},"2"),k.a.createElement(Q,{value:3},"3"),k.a.createElement(Q,{value:4},"4"),k.a.createElement(Q,{value:5},"5"),k.a.createElement(Q,{value:6},"6"),k.a.createElement(Q,{value:"other"},"其他")))))),k.a.createElement(c.a,{md:6,sm:24},k.a.createElement("div",{className:P.a.inputMain},k.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"检测时间"),k.a.createElement(j,{style:{flex:1}},a("previewTime")(k.a.createElement(o.a.RangePicker,{className:P.a.inputGroupLeftRadius,style:{width:"100%"},showTime:{defaultValue:[B()("00:00:00","HH:mm:ss"),B()(new Date,"HH:mm:ss")]},format:"YYYY-MM-DD HH:mm:ss"})))))),k.a.createElement(s.a,{gutter:16},k.a.createElement(c.a,{md:5,sm:24},k.a.createElement(d.a.Group,{compact:!0},k.a.createElement(j,{style:{display:"inline-block",width:"50%"}},a("startTotalLoad")(k.a.createElement(d.a,{className:"".concat(P.a.inputGroupRightRadius," ").concat(P.a.inputGroupRightborder),addonBefore:"总重(t)",placeholder:"请输入",style:{width:"100%",borderRight:0}}))),k.a.createElement(j,{style:{display:"inline-block",width:"50%"}},a("endTotalLoad")(k.a.createElement(d.a,{className:P.a.inputGroupRadiusAddon,addonBefore:"至",placeholder:"请输入",style:{width:"100%"}}))))),k.a.createElement(c.a,{md:4,sm:24},k.a.createElement(j,null,a("carNo")(k.a.createElement(d.a,{addonBefore:"车牌号",placeholder:"请输入"})))),k.a.createElement(c.a,{md:5,sm:24},k.a.createElement("div",{className:P.a.inputMain},k.a.createElement("span",{style:{width:"80px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"审核状态"),k.a.createElement(j,{style:{flex:1}},a("status")(k.a.createElement(I.a,{className:P.a.inputGroupLeftRadius,placeholder:"请选择"},k.a.createElement(Q,{value:"isStatus_0"},"待审核"),k.a.createElement(Q,{value:"isRetrial_1"},"被退回")))))),k.a.createElement(c.a,{md:10,sm:24},k.a.createElement("div",{style:{overflow:"hidden"}},k.a.createElement("div",{style:{float:"right",marginBottom:24}},k.a.createElement(g.a,{type:"primary",htmlType:"submit"},"查询"),k.a.createElement(g.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置"))))))}},{key:"render",value:function(){var e=this.props,t=e.TrafficApiV2BusData.dyData,a=e.loading,n=this.state,r=n.modalVisible,s=n.detailID,o={handleModalVisible:this.handleModalVisible,detailID:s,modalSuccess:this.modalSuccess};return k.a.createElement(i.a,{bordered:!1},k.a.createElement("div",{className:z.a.tableList},k.a.createElement("div",{className:z.a.tableListForm},this.renderSimpleForm()),k.a.createElement(Y.a,{size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:a,data:t,columns:this.columns,onChange:this.handleStandardTableChange})),r&&s?k.a.createElement(J.a,l()({},o,{modalVisible:r,showSave:!0})):null)}}]),t}(T.PureComponent))||n)||n;t.default=q}}]);