(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{LbSr:function(e,a,t){"use strict";t.r(a);t("IzEo");var n,l,r=t("bx4M"),i=(t("14J3"),t("BMrR")),s=(t("jCWc"),t("kPKH")),o=(t("miYZ"),t("tsqr")),c=t("MVZn"),d=t.n(c),p=(t("P2fV"),t("NJEC")),m=(t("/zsF"),t("PArb")),u=(t("+BJd"),t("mr32")),f=(t("5Dmo"),t("3S7+")),h=t("lwsE"),g=t.n(h),b=t("W8MJ"),E=t.n(b),y=t("a1gu"),C=t.n(y),v=t("Nsbk"),w=t.n(v),V=t("PJYZ"),S=t.n(V),k=t("7W2i"),F=t.n(k),L=(t("2qtc"),t("kLXV")),T=(t("DZo9"),t("8z0m")),I=t("pVnL"),D=t.n(I),M=(t("+L6B"),t("2/Rp")),R=(t("Pwec"),t("CtXQ")),N=(t("5NDa"),t("5rEg")),x=(t("7Kak"),t("9yH6")),O=(t("iQDF"),t("+eQT")),B=(t("y8nQ"),t("Vl3Y")),U=t("q1tI"),z=t.n(U),Y=t("MuoO"),q=t("wd/R"),H=t.n(q),A=t("CkN6"),P=t("mf+E"),J=t("9zHi"),j=t.n(J),K=t("+n12"),_=(t("nRaC"),t("5RzL")),G=t("ns75"),Q=t.n(G),Z=t("ZP6J"),X=t.n(Z),W=B.a.Item,$=Object(Y.connect)(function(e){var a=e.system,t=e.systemUser,n=e.user,l=e.loading;return{system:a,systemUser:t,currentUser:n.currentUser,loading:l.models.systemUser,systemLoading:l.models.system}})(n=B.a.create()(n=function(e){function a(){var e,t;g()(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=C()(this,(e=w()(a)).call.apply(e,[this].concat(l)))).state={formValues:[],treeFormValue:{},defaultFormValue:[{property:"isDelete",value:"0",group:"main",operation:"NOT_EQUAL",relation:"AND"},{property:"lawCard",value:"",group:"main",operation:"NOTNULL",relation:"AND"}],selectedRows:[]},t.columns=[{title:"登录名",dataIndex:"account"},{title:"姓名",dataIndex:"fullname"},{title:"电话",dataIndex:"mobile"},{title:"机构",dataIndex:"organName"}],t.handleStandardTableChange=function(e,a,n){var l=t.props,r=l.dispatch,i=l.currentUser,s=t.state,o=s.formValues,c=s.defaultFormValue,d=s.treeFormValue,p=c;"{}"!=JSON.stringify(d)?p.push(d):p.push({property:"organId",value:i.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),r({type:"systemUser/fetch",payload:{pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:p.concat(o)}})},t.handleFormReset=function(){var e=t.props,a=e.form,n=e.dispatch,l=e.currentUser,r=t.state.defaultFormValue,i=JSON.parse(JSON.stringify(r));a.resetFields(),t.setState({formValues:[],selectedRows:[]}),i.push({property:"organId",value:l.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),n({type:"systemUser/fetch",payload:{pageBean:{page:1,pageSize:10,showTotal:!0},querys:i}})},t.handleSearch=function(e){e.preventDefault();var a=t.props,n=a.dispatch,l=a.form,r=a.currentUser,i=t.state,s=i.treeFormValue,o=i.defaultFormValue;l.validateFields(function(e,a){if(!e){var l=d()({},a),i=Object.keys(l).map(function(e){return l[e]?{property:e,value:l[e],group:"main",operation:"LIKE",relation:"OR"}:""}).filter(function(e){return e}).filter(function(e){return"organId"!==e.property});t.setState({formValues:i}),"{}"!=JSON.stringify(s)?i.push(s):i.push({property:"organId",value:r.organId,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),n({type:"systemUser/fetch",payload:{pageBean:{page:1,pageSize:10,showTotal:!0},querys:o.concat(i)}})}})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.okHandle=function(){var e=t.props,a=e.selectParticipants,n=e.handleModalVisible;a(t.state.selectedRows),n()},t.treeSelectChange=function(e,a){var n={property:"organId",value:e,group:"main",operation:"RIGHT_LIKE",relation:"OR"};t.setState({treeFormValue:n})},t}return F()(a,e),E()(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch,a=this.state.defaultFormValue,t=JSON.parse(JSON.stringify(a)),n=localStorage.getItem("organId");t.push({property:"organId",value:n,group:"main",operation:"RIGHT_LIKE",relation:"AND"}),e({type:"systemUser/fetch",payload:{pageBean:{page:1,pageSize:10,showTotal:!0},querys:t}})}},{key:"renderSimpleForm",value:function(){var e=this.props,a=e.form.getFieldDecorator,t=e.system.treeList;return z.a.createElement(B.a,{onSubmit:this.handleSearch,layout:"inline"},z.a.createElement(i.a,{gutter:{md:8,lg:8,xl:8}},z.a.createElement(s.a,{md:5,sm:24},z.a.createElement("div",{className:Q.a.inputMain},z.a.createElement("span",{style:{width:"60px",lineHeight:"30px",height:"32px"},className:"ant-input-group-addon"},"区域"),z.a.createElement(W,{style:{flex:1}},a("organId")(z.a.createElement(_.a,{treeData:t,style:{width:"100%"},placeholder:"请选择",onChange:this.treeSelectChange}))))),z.a.createElement(s.a,{md:5,sm:24},z.a.createElement(W,null,a("account")(z.a.createElement(N.a,{addonBefore:"登录名",placeholder:"请输入"})))),z.a.createElement(s.a,{md:5,sm:24},z.a.createElement(W,null,a("fullname")(z.a.createElement(N.a,{addonBefore:"姓名",placeholder:"请输入"})))),z.a.createElement(s.a,{md:5,sm:24},z.a.createElement(W,null,a("mobile")(z.a.createElement(N.a,{addonBefore:"电话",placeholder:"请输入"})))),z.a.createElement(s.a,{md:4,sm:24},z.a.createElement("span",{className:j.a.submitButtons,style:{float:"right"}},z.a.createElement(M.a,{type:"primary",htmlType:"submit"},"查询"),z.a.createElement(M.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.systemUser.data,n=a.loading,l=a.modalVisible,r=a.handleModalVisible,i={selectedRows:this.state.selectedRows,size:"middle",loading:n,data:t,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange};return z.a.createElement(L.a,{destroyOnClose:!0,title:"选择人员",visible:l,className:X.a.formModal,onOk:function(){return e.okHandle()},onCancel:function(){return r()},width:1200},z.a.createElement("div",{className:X.a.formModalBody},z.a.createElement("div",{className:j.a.tableList},z.a.createElement("div",{className:j.a.tableListForm},this.renderSimpleForm()),z.a.createElement(A.a,i))))}}]),a}(U.PureComponent))||n)||n,ee=["/datemain/train"],ae=B.a.Item,te=["未开始","已结束"],ne=O.a.RangePicker,le=x.a.Group,re=B.a.create()(function(e){var a=e.modalVisible,t=e.form,n=e.handleAdd,l=e.handleModalVisible,r=e.participantsClick,i=e.fileList,s=e.participants,o=e.uploadChange,c={name:"files",action:"/result/api/file/v1/fileUpload",accept:".doc,.docx,.pdf,.zip",data:{type:8,params:null},headers:{Authorization:"Bearer ".concat(Object(K.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:K.p,onChange:o};return z.a.createElement(L.a,{destroyOnClose:!0,title:"添加",className:X.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||n(a,function(){return t.resetFields()})})},onCancel:function(){return l()}},z.a.createElement("div",{className:X.a.formModalBody},z.a.createElement(ae,{labelCol:{span:5},hasFeedback:!0,wrapperCol:{span:15},label:"培训主题"},t.getFieldDecorator("trainTitle",{rules:[{required:!0,message:"请输入培训主题！"}]})(z.a.createElement(N.a,{placeholder:"请输入"}))),z.a.createElement(ae,{labelCol:{span:5},hasFeedback:!0,wrapperCol:{span:15},label:"培训内容"},t.getFieldDecorator("trainContent",{rules:[{required:!0,message:"请输入培训内容！"}]})(z.a.createElement(N.a.TextArea,{autosize:!0,placeholder:"请输入"}))),z.a.createElement(ae,{labelCol:{span:5},hasFeedback:!0,wrapperCol:{span:15},label:"培训时间"},t.getFieldDecorator("trainTime",{rules:[{required:!0,message:"请选择培训时间！"}]})(z.a.createElement(ne,{style:{width:"100%"},showTime:!0}))),z.a.createElement(ae,{labelCol:{span:5},hasFeedback:!0,wrapperCol:{span:15},label:"培训地点"},t.getFieldDecorator("trainSite",{rules:[{required:!0,message:"请输入培训地点！"}]})(z.a.createElement(N.a.TextArea,{autosize:!0,placeholder:"请输入"}))),z.a.createElement(ae,{labelCol:{span:5},hasFeedback:!0,wrapperCol:{span:15},label:"参与人员"},t.getFieldDecorator("participants",{initialValue:s,rules:[{required:!0,message:"请选择参与人员！"}]})(z.a.createElement(N.a.TextArea,{onClick:function(){return r()},readOnly:!0,placeholder:"请选择",autosize:!0}))),z.a.createElement(ae,{labelCol:{span:5},wrapperCol:{span:15},label:"状态"},t.getFieldDecorator("status",{initialValue:0,rules:[{required:!0,message:"请选择状态！"}]})(z.a.createElement(le,null,te.map(function(e,a){return z.a.createElement(x.a,{key:a,value:a},e)})))),z.a.createElement(ae,{labelCol:{span:5},wrapperCol:{span:15},label:"培训文件"},t.getFieldDecorator("trainImg",{})(z.a.createElement(T.a,D()({},c,{defaultFileList:i}),i.length>0?null:z.a.createElement(M.a,null,z.a.createElement(R.a,{type:"upload"})," 选择培训文件(.doc,.docx,.pdf,.zip)"))))))}),ie=B.a.create()(function(e){var a=e.modalVisible,t=e.form,n=e.handleUpdate,l=e.handleModalVisible,r=e.detail,i=e.participantsClick,s=e.uploadChange,o=e.participants,c=e.fileList,d={name:"files",action:"/result/api/file/v1/fileUpload",accept:".doc,.docx,.pdf,.zip",data:{type:8,xbType:""},headers:{Authorization:"Bearer ".concat(Object(K.w)("token")[0]),"x-requested-with":"XMLHttpRequest"},beforeUpload:K.p,onChange:s};return z.a.createElement(L.a,{destroyOnClose:!0,title:"编辑",className:X.a.formModal,visible:a,onOk:function(){t.validateFields(function(e,a){e||n(a)})},onCancel:function(){return l()}},z.a.createElement("div",{className:X.a.formModalBody},z.a.createElement(ae,{labelCol:{span:5},hasFeedback:!0,wrapperCol:{span:15},label:"培训主题"},t.getFieldDecorator("trainTitle",{initialValue:r.trainTitle,rules:[{required:!0,message:"请输入培训主题！"}]})(z.a.createElement(N.a,{placeholder:"请输入"}))),z.a.createElement(ae,{labelCol:{span:5},hasFeedback:!0,wrapperCol:{span:15},label:"培训内容"},t.getFieldDecorator("trainContent",{initialValue:r.trainContent,rules:[{required:!0,message:"请输入培训内容！"}]})(z.a.createElement(N.a.TextArea,{autosize:!0,placeholder:"请输入"}))),z.a.createElement(ae,{labelCol:{span:5},hasFeedback:!0,wrapperCol:{span:15},label:"培训时间"},t.getFieldDecorator("trainTime",{initialValue:function(e){if(e){var a=e.split(",");return[H()(a[0],"YYYY-MM-DD HH:mm:ss"),H()(a[1],"YYYY-MM-DD HH:mm:ss")]}return[]}(r.trainTime),rules:[{required:!0,message:"请选择培训时间！"}]})(z.a.createElement(ne,{style:{width:"100%"},showTime:!0}))),z.a.createElement(ae,{labelCol:{span:5},hasFeedback:!0,wrapperCol:{span:15},label:"培训地点"},t.getFieldDecorator("trainSite",{initialValue:r.trainSite,rules:[{required:!0,message:"请输入培训地点！"}]})(z.a.createElement(N.a.TextArea,{autosize:!0,placeholder:"请输入"}))),z.a.createElement(ae,{labelCol:{span:5},hasFeedback:!0,wrapperCol:{span:15},label:"参与人员"},t.getFieldDecorator("participants",{initialValue:o,rules:[{required:!0,message:"请选择参与人员！"}]})(z.a.createElement(N.a.TextArea,{readOnly:!0,onClick:function(){return i()},placeholder:"请选择",autosize:!0}))),z.a.createElement(ae,{labelCol:{span:5},wrapperCol:{span:15},label:"状态"},t.getFieldDecorator("status",{initialValue:r.status,rules:[{required:!0,message:"请选择状态！"}]})(z.a.createElement(le,null,te.map(function(e,a){return z.a.createElement(x.a,{key:a,value:a},e)})))),z.a.createElement(ae,{labelCol:{span:5},wrapperCol:{span:15},label:"培训文件"},t.getFieldDecorator("trainImg",{initialValue:r.trainImg})(z.a.createElement(T.a,D()({},d,{defaultFileList:c}),c.length>0?null:z.a.createElement(M.a,null,z.a.createElement(R.a,{type:"upload"})," 选择培训文件(.doc,.docx,.pdf,.zip)"))))))}),se=Object(Y.connect)(function(e){return{system:e.system,LawenforTrain:e.LawenforTrain,loading:e.loading.models.LawenforTrain}})(l=B.a.create()(l=function(e){function a(){var e,t;g()(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=C()(this,(e=w()(a)).call.apply(e,[this].concat(l)))).state={modalVisible:!1,updateModalVisible:!1,participantsVisible:!1,selectedRows:[],fileList:[],participants:"",formValues:[],detail:{},pageBean:{page:1,pageSize:10,showTotal:!0}},t.columns=[{title:"培训主题",dataIndex:"trainTitle"},{title:"培训内容",dataIndex:"trainContent",render:function(e){return z.a.createElement(f.a,{title:e},z.a.createElement("a",null,e.length>30?e.substr(0,30)+"......":e))}},{title:"培训地点",dataIndex:"trainSite",render:function(e){return z.a.createElement(f.a,{title:e},z.a.createElement("a",null,e.length>30?e.substr(0,30)+"......":e))}},{title:"培训时间",dataIndex:"trainTime",width:310,render:function(e){if(e){var a=e.split(",");return a[0]+" ~ "+a[1]}return""}},{title:"参与人员",dataIndex:"participants",render:function(e){return e&&z.a.createElement(f.a,{title:e},z.a.createElement("a",null,e.length>30?e.substr(0,30)+"......":e))}},{title:"培训文件",dataIndex:"trainImg",render:function(e){return z.a.createElement(u.a,{color:"#87d068"},z.a.createElement(R.a,{type:"download"})," ",z.a.createElement("a",{href:K.q+e,target:"_blank"}," ","文件下载"))}},{title:"状态",dataIndex:"status",render:function(e){return te[parseInt(e,10)]}},{title:"操作",width:100,render:function(e,a){return z.a.createElement(U.Fragment,null,z.a.createElement(U.Fragment,null,z.a.createElement(f.a,{placement:"left",title:"编辑"},z.a.createElement(M.a,{onClick:function(){return t.showUpdateModal(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),z.a.createElement(m.a,{type:"vertical"}),z.a.createElement(p.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id)},okText:"确定",cancelText:"取消"},z.a.createElement(f.a,{placement:"left",title:"删除"},z.a.createElement(M.a,{type:"danger",shape:"circle",icon:"delete",size:"small"})))))}}],t.getList=function(e){(0,t.props.dispatch)({type:"LawenforTrain/fetch",payload:e})},t.showUpdateModal=function(e){t.setState({detail:e,participants:e.participants,fileList:e.trainImg?[{uid:"-1",name:"培训文件",status:"done"}]:[]},function(){t.handleUpdateModalVisible(!0)})},t.batchDel=function(){var e=t.state.selectedRows;if(e){var a=S()(t);L.a.confirm({title:"批量删除",content:"您确定要批量删除吗?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){a.delUtil(e.map(function(e){return e.id}).join())}})}},t.dataDel=function(e){t.delUtil(e)},t.delUtil=function(e){var a=t.props.dispatch,n=t.state.pageBean;a({type:"LawenforTrain/remove",payload:{ids:e},callback:function(){t.setState({selectedRows:[]}),t.getList({pageBean:n})}})},t.handleStandardTableChange=function(e){var a=t.state.formValues,n={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:a};t.getList(n)},t.handleFormReset=function(){var e=t.props.form,a=t.state.pageBean;e.resetFields(),t.setState({formValues:[],selectedRows:[]}),t.getList({pageBean:a})},t.handleSelectRows=function(e){t.setState({selectedRows:e})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var n=t.state.pageBean,l=d()({},a),r=Object.keys(l).map(function(e){return l[e]?{property:e,value:l[e],group:"main",operation:"LIKE",relation:"OR"}:""}).filter(function(e){return e});t.setState({formValues:r}),t.getList({pageBean:n,querys:r})}})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e}),e||t.setState({participants:"",fileList:[]})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{},participants:"",fileList:[]})},t.handleParticipantsVisible=function(e){t.setState({participantsVisible:!!e})},t.selectParticipants=function(e){var a=e.map(function(e){return e.fullname}).join();t.setState({participants:a})},t.participantsClick=function(){t.handleParticipantsVisible(!0)},t.handleAdd=function(e,a){var n=t.props.dispatch,l=t.state,r=l.pageBean;if(!l.fileList.length)return o.a.error("请选择文件");var i=e.trainTime,s=H()(i[0]).format("YYYY-MM-DD HH:mm:ss");if(H()()>H()(i[0]))return o.a.error("开始时间应大于当前时间");var c=H()(i[1]).format("YYYY-MM-DD HH:mm:ss");e.trainImg=e.trainImg?e.trainImg.file.response.filePath:"",e.trainTime="".concat(s,",").concat(c),n({type:"LawenforTrain/add",payload:e,callback:function(){o.a.success("添加成功"),a&&a(),setTimeout(function(){t.handleModalVisible(),t.getList({pageBean:r})},500)}})},t.handleUpdate=function(e){var a=t.props.dispatch,n=t.state,l=n.pageBean,r=n.detail;if(!n.fileList.length)return o.a.error("请选择文件");var i=JSON.parse(JSON.stringify(r));e.id=r.id;var s=e.trainTime,c=H()(s[0]).format("YYYY-MM-DD HH:mm:ss");if(H()()>H()(s[0]))return o.a.error("开始时间应大于当前时间");var d=H()(s[1]).format("YYYY-MM-DD HH:mm:ss");if(e.trainTime="".concat(c,",").concat(d),"object"==typeof e.trainImg){var p=e.trainImg.file.response;e.trainImg=p?p.filePath:""}var m=Object.keys(e);for(var u in m)i[m[u]]=e[m[u]];t.setState({detail:i}),a({type:"LawenforTrain/update",payload:e,callback:function(){o.a.success("编辑成功"),setTimeout(function(){t.handleUpdateModalVisible(),t.getList({pageBean:l})},500)}})},t.uploadChange=function(e){"done"===e.file.status?200===e.file.response.code?(o.a.success("上传成功"),t.setState({fileList:e.fileList})):(o.a.error("上传失败"),o.a.error(e.file.response.code.msg)):"error"===e.file.status?o.a.error("上传失败"):"removed"===e.file.status&&t.setState({fileList:e.fileList})},t}return F()(a,e),E()(a,[{key:"componentDidMount",value:function(){if(Object(K.b)(ee[0])){var e=this.state.pageBean;this.getList({pageBean:e})}}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return z.a.createElement(B.a,{onSubmit:this.handleSearch,layout:"inline"},z.a.createElement(i.a,{gutter:{md:8,lg:16,xl:32}},z.a.createElement(s.a,{md:5,sm:24},z.a.createElement(ae,null,e("trainTitle")(z.a.createElement(N.a,{addonBefore:"培训主题",placeholder:"请输入"})))),z.a.createElement(s.a,{md:5,sm:24},z.a.createElement(ae,null,e("trainContent")(z.a.createElement(N.a,{addonBefore:"培训内容",placeholder:"请输入"})))),z.a.createElement(s.a,{md:5,sm:24},z.a.createElement("span",{className:j.a.submitButtons},z.a.createElement(M.a,{type:"primary",htmlType:"submit"},"查询"),z.a.createElement(M.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.LawenforTrain.data,n=a.loading,l=this.state,i=l.selectedRows,s=l.modalVisible,o=l.updateModalVisible,c=l.detail,d=l.participants,p=l.participantsVisible,m=l.fileList,u={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible,participantsClick:this.participantsClick,participants:d,uploadChange:this.uploadChange,fileList:m},f={handleUpdate:this.handleUpdate,detail:c,participants:d,handleModalVisible:this.handleUpdateModalVisible,participantsClick:this.participantsClick,uploadChange:this.uploadChange,fileList:m},h={handleModalVisible:this.handleParticipantsVisible,selectParticipants:this.selectParticipants};return z.a.createElement(U.Fragment,null,Object(K.b)(ee[0])?null:z.a.createElement(P.a,{to:"/exception/403"}),z.a.createElement(r.a,{bordered:!1},z.a.createElement("div",{className:j.a.tableList},z.a.createElement("div",{className:j.a.tableListForm},this.renderSimpleForm()),z.a.createElement("div",{className:j.a.tableListOperator},z.a.createElement(M.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建"),i.length>0&&z.a.createElement("span",null,z.a.createElement(M.a,{type:"danger",onClick:function(){return e.batchDel()}},"批量操作"))),z.a.createElement(A.a,{size:"middle",tableAlert:!0,selectedRows:i,loading:n,data:t,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),s&&z.a.createElement(re,D()({},u,{modalVisible:s})),o&&Object.keys(c).length&&z.a.createElement(ie,D()({},f,{modalVisible:o})),p&&z.a.createElement($,D()({},h,{modalVisible:p})))}}]),a}(U.PureComponent))||l)||l;a.default=se}}]);