(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{fedg:function(e,a,t){"use strict";t.r(a);t("IzEo");var l,r=t("bx4M"),n=(t("miYZ"),t("tsqr")),i=(t("P2fV"),t("NJEC")),s=(t("/zsF"),t("PArb")),o=(t("5Dmo"),t("3S7+")),d=t("lwsE"),c=t.n(d),m=t("W8MJ"),p=t.n(m),u=t("a1gu"),h=t.n(u),E=t("Nsbk"),g=t.n(E),f=t("7W2i"),b=t.n(f),y=(t("2qtc"),t("kLXV")),V=(t("14J3"),t("BMrR")),v=(t("DZo9"),t("8z0m")),L=t("pVnL"),C=t.n(L),F=(t("giR+"),t("fyUT")),M=(t("jCWc"),t("kPKH")),D=(t("5NDa"),t("5rEg")),k=(t("+L6B"),t("2/Rp")),S=(t("Pwec"),t("CtXQ")),w=(t("y8nQ"),t("Vl3Y")),q=t("q1tI"),B=t.n(q),N=t("MuoO"),T=(t("wd/R"),t("CkN6")),x=t("9zHi"),A=t.n(x),P=t("ZP6J"),z=t.n(P),j=t("+n12"),I=w.a.Item,U=w.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleAdd,r=e.handleModalVisible,n=e.loading,i=e.uploadConfig,s=e.fileList,o=B.a.createElement("div",null,B.a.createElement(S.a,{type:"plus"}),B.a.createElement("div",{className:"ant-upload-text"},"请选择图片"));return B.a.createElement(y.a,{destroyOnClose:!0,title:"添加船只",className:z.a.formModal,visible:a,width:800,onCancel:function(){return r()},footer:[B.a.createElement(k.a,{key:"back",onClick:function(){return r()}},"取消"),B.a.createElement(k.a,{key:"submit",type:"primary",loading:n,onClick:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})}},"确定")]},B.a.createElement("div",{className:z.a.formModalBody},B.a.createElement(V.a,{gutter:40},B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"船舶号"},t.getFieldDecorator("shipCode",{rules:[{required:!0,message:"请输入船舶号"}]})(B.a.createElement(D.a,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"船只型号"},t.getFieldDecorator("shipType",{rules:[{required:!0,message:"请输入船只型号"}]})(B.a.createElement(D.a,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"排水量"},t.getFieldDecorator("displacement",{rules:[{required:!0,message:"请输入排水量"}]})(B.a.createElement(F.a,{min:1,style:{width:"100%"},placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"吨位"},t.getFieldDecorator("tonnage",{rules:[{required:!0,message:"请输入吨位"}]})(B.a.createElement(F.a,{min:1,style:{width:"100%"},placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"船只所有人名称"},t.getFieldDecorator("shipLeader",{rules:[{required:!0,message:"请输入船只所有人名称"}]})(B.a.createElement(D.a,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"船只所有人联系方式"},t.getFieldDecorator("shipLeaderTel",{rules:[{required:!0,validator:j.j}]})(B.a.createElement(D.a,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"运输证号"},t.getFieldDecorator("transportCode",{rules:[{required:!0,message:"请输入运输证号"}]})(B.a.createElement(D.a,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"经营范围"},t.getFieldDecorator("businessScope",{rules:[{required:!0,message:"请输入经营范围"}]})(B.a.createElement(D.a.TextArea,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:24,sm:24},B.a.createElement(I,{label:"船只图片"},t.getFieldDecorator("shipPhotos",{rules:[{required:!0,message:"请上传照片！"}]})(B.a.createElement(v.a,C()({},i(),{fileList:s}),s.length>=3?null:o)))))))}),O=w.a.create()(function(e){var a=e.modalVisible,t=e.form,l=e.handleUpdate,r=e.handleModalVisible,n=e.loading,i=e.uploadConfig,s=e.fileList,o=e.detail,d=B.a.createElement("div",null,B.a.createElement(S.a,{type:"plus"}),B.a.createElement("div",{className:"ant-upload-text"},"请选择图片"));return B.a.createElement(y.a,{destroyOnClose:!0,title:"添加船只",className:z.a.formModal,visible:a,width:800,onCancel:function(){return r()},footer:[B.a.createElement(k.a,{key:"back",onClick:function(){return r()}},"取消"),B.a.createElement(k.a,{key:"submit",type:"primary",loading:n,onClick:function(){t.validateFields(function(e,a){e||l(a,function(){return t.resetFields()})})}},"确定")]},B.a.createElement("div",{className:z.a.formModalBody},B.a.createElement(V.a,{gutter:40},B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"船舶号"},t.getFieldDecorator("shipCode",{initialValue:o.shipCode,rules:[{required:!0,message:"请输入船舶号"}]})(B.a.createElement(D.a,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"船只型号"},t.getFieldDecorator("shipType",{initialValue:o.shipType,rules:[{required:!0,message:"请输入船只型号"}]})(B.a.createElement(D.a,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"排水量"},t.getFieldDecorator("displacement",{initialValue:o.displacement,rules:[{required:!0,message:"请输入排水量"}]})(B.a.createElement(F.a,{min:1,style:{width:"100%"},placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"吨位"},t.getFieldDecorator("tonnage",{initialValue:o.tonnage,rules:[{required:!0,message:"请输入吨位"}]})(B.a.createElement(F.a,{min:1,style:{width:"100%"},placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"船只所有人名称"},t.getFieldDecorator("shipLeader",{initialValue:o.shipLeader,rules:[{required:!0,message:"请输入船只所有人名称"}]})(B.a.createElement(D.a,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"船只所有人联系方式"},t.getFieldDecorator("shipLeaderTel",{initialValue:o.shipLeaderTel,rules:[{required:!0,validator:j.j}]})(B.a.createElement(D.a,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"运输证号"},t.getFieldDecorator("transportCode",{initialValue:o.transportCode,rules:[{required:!0,message:"请输入运输证号"}]})(B.a.createElement(D.a,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:12,sm:24},B.a.createElement(I,{label:"经营范围"},t.getFieldDecorator("businessScope",{initialValue:o.businessScope,rules:[{required:!0,message:"请输入经营范围"}]})(B.a.createElement(D.a.TextArea,{placeholder:"请输入"})))),B.a.createElement(M.a,{md:24,sm:24},B.a.createElement(I,{label:"船只图片"},t.getFieldDecorator("shipPhotos",{initialValue:o.shipPhotos,rules:[{required:!0,message:"请上传照片！"}]})(B.a.createElement(v.a,C()({},i(),{fileList:s}),s.length>=3?null:d)))))))}),J=Object(N.connect)(function(e){return{MaritimeVessel:e.MaritimeVessel,loading:e.loading.models.MaritimeVessel}})(l=w.a.create()(l=function(e){function a(){var e,t;c()(this,a);for(var l=arguments.length,r=new Array(l),d=0;d<l;d++)r[d]=arguments[d];return(t=h()(this,(e=g()(a)).call.apply(e,[this].concat(r)))).state={modalVisible:!1,updateModalVisible:!1,formValues:[],detail:{},fileList:[]},t.columns=[{title:"船舶号",dataIndex:"shipCode"},{title:"船只所有人",dataIndex:"shipLeader"},{title:"船只型号",dataIndex:"shipType"},{title:"经营范围",dataIndex:"businessScope"},{title:"运输证号",dataIndex:"transportCode"},{title:"吨位",dataIndex:"tonnage"},{title:"排水量",dataIndex:"displacement"},{title:"操作",width:100,render:function(e,a){return B.a.createElement(q.Fragment,null,B.a.createElement(o.a,{placement:"left",title:"编辑"},B.a.createElement(k.a,{onClick:function(){return t.editData(a)},type:"primary",shape:"circle",icon:"edit",size:"small"})),B.a.createElement(s.a,{type:"vertical"}),B.a.createElement(i.a,{title:"是否删除数据?",onConfirm:function(){return t.dataDel(a.id_)},okText:"确定",cancelText:"取消"},B.a.createElement(o.a,{placement:"left",title:"删除"},B.a.createElement(k.a,{type:"danger",shape:"circle",icon:"delete",size:"small"}))))}}],t.getList=function(e){(0,t.props.dispatch)({type:"MaritimeVessel/fetch",payload:e})},t.dataDel=function(e){(0,t.props.dispatch)({type:"MaritimeVessel/remove",payload:{id:e},callback:function(){n.a.success("删除成功"),t.getList({pageBean:t.state.pageBean})}})},t.editData=function(e){var a=(e.shipPhotos?e.shipPhotos.split(","):[]).map(function(e,a){return{uid:a,name:"image.png",status:"done",url:j.E+e,path:e}});t.setState({detail:e,fileList:a},function(){return t.handleUpdateModalVisible(!0)})},t.handleStandardTableChange=function(e){var a=t.state.formValues,l={pageBean:{page:e.current,pageSize:e.pageSize,showTotal:!0},querys:a};t.getList(l)},t.handleFormReset=function(){t.props.form.resetFields(),t.setState({formValues:[]}),t.getList({pageBean:t.state.pageBean})},t.handleSearch=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){if(!e){var l=[{property:"shipType",value:a.czxh,group:"main",operation:"LIKE",relation:"AND"},{property:"businessScope",value:a.jyfw,group:"main",operation:"LIKE",relation:"AND"},{property:"tonnage",value:a.dw,group:"main",operation:"EQUAL",relation:"AND"},{property:"displacement",value:a.psl,group:"main",operation:"EQUAL",relation:"AND"}].filter(function(e){return e.value});t.setState({formValues:l}),t.getList({pageBean:t.state.pageBean,querys:l})}})},t.handleModalVisible=function(e){t.setState({modalVisible:!!e}),e||t.setState({fileList:[]})},t.handleUpdateModalVisible=function(e){t.setState({updateModalVisible:!!e}),e||t.setState({detail:{}})},t.handleAdd=function(e,a){var l=t.props.dispatch,r=t.state,i=r.pageBean,s=r.fileList;if(!s.length)return n.a.error("请选择文件");var o=s.map(function(e){return e.response.filePath});e.shipPhotos=o.join(),l({type:"MaritimeVessel/add",payload:e,callback:function(){n.a.success("添加成功"),t.handleModalVisible(),t.getList({pageBean:i}),a()}})},t.handleUpdate=function(e,a){var l=t.state,r=l.fileList,i=l.detail,s=l.pageBean;if(!r.length)return n.a.error("请选择文件");var o=JSON.parse(JSON.stringify(i)),d=r.map(function(e){return e.response?e.response.filePath:e.path});for(var c in e.shipPhotos=d.join(),e)o[c]=e[c];t.setState({detail:o}),(0,t.props.dispatch)({type:"MaritimeVessel/update",payload:o,callback:function(){n.a.success("编辑成功"),t.handleUpdateModalVisible(),t.getList({pageBean:s}),a()}})},t.handleChange=function(e){var a=e.fileList;return t.setState({fileList:a})},t.uploadConfig=function(){return{name:"files",action:"/result/api/file/v1/fileUpload",listType:"picture-card",accept:".jpg,.jpeg,.png",data:{type:9},headers:{Authorization:"Bearer ".concat(Object(j.z)("token")[0]),"x-requested-with":"XMLHttpRequest"},onChange:t.handleChange}},t}return b()(a,e),p()(a,[{key:"componentDidMount",value:function(){var e=this.state.pageBean;this.getList({pageBean:e})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return B.a.createElement(w.a,{onSubmit:this.handleSearch,layout:"inline"},B.a.createElement(V.a,{gutter:16},B.a.createElement(M.a,{md:5,sm:24},B.a.createElement(I,null,e("czxh")(B.a.createElement(D.a,{addonBefore:"船只型号",placeholder:"请输入"})))),B.a.createElement(M.a,{md:5,sm:24},B.a.createElement(I,null,e("jyfw")(B.a.createElement(D.a,{addonBefore:"经营范围",placeholder:"请输入"})))),B.a.createElement(M.a,{md:5,sm:24},B.a.createElement(I,null,e("dw")(B.a.createElement(D.a,{addonBefore:"吨位",placeholder:"请输入"})))),B.a.createElement(M.a,{md:5,sm:24},B.a.createElement(I,null,e("psl")(B.a.createElement(D.a,{addonBefore:"排水量",placeholder:"请输入"})))),B.a.createElement(M.a,{md:4,sm:24},B.a.createElement("span",{className:A.a.submitButtons},B.a.createElement(k.a,{type:"primary",htmlType:"submit"},"查询"),B.a.createElement(k.a,{style:{marginLeft:8},onClick:this.handleFormReset},"重置")))))}},{key:"render",value:function(){var e=this,a=this.props,t=a.MaritimeVessel.data,l=a.loading,n=this.state,i=n.modalVisible,s=n.updateModalVisible,o=n.fileList,d=n.detail,c={fileList:o,uploadConfig:this.uploadConfig,handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},m={detail:d,fileList:o,uploadConfig:this.uploadConfig,handleModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate};return B.a.createElement(q.Fragment,null,B.a.createElement(r.a,{bordered:!1},B.a.createElement("div",{className:A.a.tableList},B.a.createElement("div",{className:A.a.tableListForm},this.renderSimpleForm()),B.a.createElement("div",{className:A.a.tableListOperator},B.a.createElement(k.a,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"新建")),B.a.createElement(T.a,{rowKey:"id_",size:"middle",tableAlert:!1,selectedRows:0,rowSelection:null,loading:l,data:t,columns:this.columns,onChange:this.handleStandardTableChange}))),B.a.createElement(U,C()({},c,{modalVisible:i})),s&&Object.keys(d).length?B.a.createElement(O,C()({},m,{modalVisible:s})):null)}}]),a}(q.PureComponent))||l)||l;a.default=J}}]);